(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{XJJU:function(e,t,c){"use strict";c.r(t),c.d(t,"CONTAINERS",(function(){return Oc})),c.d(t,"COMPONENTS",(function(){return jc})),c.d(t,"MarketPlaceModule",(function(){return Cc}));var r={};c.r(r),c.d(r,"reset",(function(){return f})),c.d(r,"uploadImage",(function(){return m})),c.d(r,"uploadImageSuccess",(function(){return g})),c.d(r,"uploadImageFail",(function(){return O})),c.d(r,"downloadImage",(function(){return j})),c.d(r,"downloadImageSuccess",(function(){return C})),c.d(r,"downloadImageError",(function(){return y}));var n={};c.r(n),c.d(n,"createPurchaseContract",(function(){return U})),c.d(n,"createPurchaseContractSuccess",(function(){return $})),c.d(n,"loadProducts",(function(){return B})),c.d(n,"loadProductsSuccess",(function(){return E})),c.d(n,"loadPurchaseContract",(function(){return k})),c.d(n,"loadPurchaseContractSuccess",(function(){return F})),c.d(n,"removePurchaseContract",(function(){return R})),c.d(n,"removePurchaseContractSuccess",(function(){return L})),c.d(n,"abortSelectedPurchaseContract",(function(){return K})),c.d(n,"abortSelectedPurchaseContractSuccess",(function(){return M})),c.d(n,"confirmBuy",(function(){return D})),c.d(n,"confirmBuySuccess",(function(){return N})),c.d(n,"confirmDelivery",(function(){return q})),c.d(n,"confirmDeliverySuccess",(function(){return H})),c.d(n,"releaseEscrow",(function(){return V})),c.d(n,"releaseEscrowSuccess",(function(){return G})),c.d(n,"withdrawByOwner",(function(){return _})),c.d(n,"withdrawByOwnerSuccess",(function(){return Y}));var o=c("ofXK"),s=c("3Pt+"),a=c("M0ag"),i=c("tyNb"),u=c("mrSG"),l=c("0IaG"),b=c("vkgz"),d=c("5+qj"),h=c("kt0X"),p=c("Jt/G");const f=Object(h.o)("[IPFS/Image] Reset"),m=Object(h.o)("[IPFS/Image] Upload",Object(h.t)()),g=Object(h.o)("[IPFS/Image] Upload Success",Object(h.t)()),O=Object(h.o)("[IPFS/Image] Upload Fail"),j=Object(h.o)("[IPFS/Image] Download Image",Object(h.t)()),C=Object(h.o)("[IPFS/Image] Download Image Success",Object(h.t)()),y=Object(h.o)("[IPFS/Image] Download Image Error");var v=function(e){return e.Pending="Pending",e.Success="Success",e.Error="Error",e.Progress="Progress",e}({});const w={status:v.Pending,ipfsHash:null,imageBlob:null},P=Object(h.q)(w,Object(h.s)(f,()=>w),Object(h.s)(m,e=>Object.assign(Object.assign({},e),{status:v.Progress})),Object(h.s)(g,(e,{ipfsHash:t})=>Object.assign(Object.assign({},e),{status:v.Success,ipfsHash:t})),Object(h.s)(O,e=>Object.assign(Object.assign({},e),{status:v.Error,ipfsHash:null})),Object(h.s)(C,(e,{image:t})=>Object.assign(Object.assign({},e),{imageBlob:t})));var I=c("fXoL");const T=function(){var e={EntitiesOnly:0,Both:1,None:2};return e[e.EntitiesOnly]="EntitiesOnly",e[e.Both]="Both",e[e.None]="None",e}();function S(e){return function(t,c){const r={ids:[...c.ids],entities:Object.assign({},c.entities)},n=e(t,r);return n===T.Both?Object.assign({},c,r):n===T.EntitiesOnly?Object.assign(Object.assign({},c),{entities:r.entities}):c}}function x(e,t){const c=t(e);return Object(I.W)()&&void 0===c&&console.warn("@ngrx/entity: The entity passed to the `selectId` implementation returned undefined.","You should probably provide your own `selectId` implementation.","The entity that was passed:",e,"The `selectId` implementation:",t.toString()),c}function A(e){function t(t,c){const r=x(t,e);return r in c.entities?T.None:(c.ids.push(r),c.entities[r]=t,T.Both)}function c(e,c){let r=!1;for(const n of e)r=t(n,c)!==T.None||r;return r?T.Both:T.None}function r(e,t){return t.ids=[],t.entities={},c(e,t),T.Both}function n(e,t){const c=(e instanceof Array?e:t.ids.filter(c=>e(t.entities[c]))).filter(e=>e in t.entities).map(e=>delete t.entities[e]).length>0;return c&&(t.ids=t.ids.filter(e=>e in t.entities)),c?T.Both:T.None}function o(t,c){const r={};return(t=t.filter(e=>e.id in c.entities)).length>0?t.filter(t=>function(t,c,r){const n=Object.assign({},r.entities[c.id],c.changes),o=x(n,e),s=o!==c.id;return s&&(t[c.id]=o,delete r.entities[c.id]),r.entities[o]=n,s}(r,t,c)).length>0?(c.ids=c.ids.map(e=>r[e]||e),T.Both):T.EntitiesOnly:T.None}function s(t,r){const n=[],s=[];for(const c of t){const t=x(c,e);t in r.entities?s.push({id:t,changes:c}):n.push(c)}const a=o(s,r),i=c(n,r);switch(!0){case i===T.None&&a===T.None:return T.None;case i===T.Both||a===T.Both:return T.Both;default:return T.EntitiesOnly}}return{removeAll:function(e){return Object.assign({},e,{ids:[],entities:{}})},addOne:S(t),addMany:S(c),addAll:S(r),setAll:S(r),setOne:S((function(t,c){const r=x(t,e);return r in c.entities?(c.entities[r]=t,T.EntitiesOnly):(c.ids.push(r),c.entities[r]=t,T.Both)})),updateOne:S((function(e,t){return o([e],t)})),updateMany:S(o),upsertOne:S((function(e,t){return s([e],t)})),upsertMany:S(s),removeOne:S((function(e,t){return n([e],t)})),removeMany:S(n),map:S((function(e,t){return o(t.ids.reduce((c,r)=>{const n=e(t.entities[r]);return n!==t.entities[r]&&c.push({id:r,changes:n}),c},[]).filter(({id:e})=>e in t.entities),t)}))}}const U=Object(h.o)("[PurchaseContract/API] Create Purchase Contract",Object(h.t)()),$=Object(h.o)("[PurchaseContract/Command] Create Purchase Contract Success",Object(h.t)()),B=Object(h.o)("[Product/API] Load Products"),E=Object(h.o)("[Product/Command] Load Products Success",Object(h.t)()),k=Object(h.o)("[PurchaseContract/API] Load Purchase Contract",Object(h.t)()),F=Object(h.o)("[PurchaseContract/Command] Load Purchase Contract Success",Object(h.t)()),R=Object(h.o)("[PurchaseContract/API] Remove Purchase Contract",Object(h.t)()),L=Object(h.o)("[PurchaseContract/Command] Remove Purchase Contract Success",Object(h.t)()),K=Object(h.o)("[PurchaseContract/API] Abort Purchase Contract"),M=Object(h.o)("[PurchaseContract/Command] Abort Purchase Contract Success"),D=Object(h.o)("[PurchaseContract/API] Confirm Buy",Object(h.t)()),N=Object(h.o)("[PurchaseContract/Command] Confirm Buy Success"),q=Object(h.o)("[PurchaseContract/API] Confirm Product Delivery"),H=Object(h.o)("[PurchaseContract/Command] Confirm Product Delivery Success"),V=Object(h.o)("[PurchaseContract/API] Withdraw Escrow By Seller"),G=Object(h.o)("[PurchaseContract/Command] Withdraw Escrow By Seller Success",Object(h.t)()),_=Object(h.o)("[PurchaseContract/API] Withdraw By Owner"),Y=Object(h.o)("[PurchaseContract/Command] Withdraw By Owner Success",Object(h.t)()),X=function(e={}){const{selectId:t,sortComparer:c}=Object.assign({sortComparer:!1,selectId:e=>e.id},e),r={getInitialState:function(e={}){return Object.assign({ids:[],entities:{}},e)}},n={getSelectors:function(e){const t=e=>e.ids,c=e=>e.entities,r=Object(h.r)(t,c,(e,t)=>e.map(e=>t[e])),n=Object(h.r)(t,e=>e.length);return e?{selectIds:Object(h.r)(e,t),selectEntities:Object(h.r)(e,c),selectAll:Object(h.r)(e,r),selectTotal:Object(h.r)(e,n)}:{selectIds:t,selectEntities:c,selectAll:r,selectTotal:n}}},o=c?function(e,t){const{removeOne:c,removeMany:r,removeAll:n}=A(e);function o(e,t){return s([e],t)}function s(t,c){const r=t.filter(t=>!(x(t,e)in c.entities));return 0===r.length?T.None:(l(r,c),T.Both)}function a(e,t){return t.entities={},t.ids=[],s(e,t),T.Both}function i(t,c){const r=[],n=t.filter(t=>function(t,c,r){if(!(c.id in r.entities))return!1;const n=Object.assign({},r.entities[c.id],c.changes),o=x(n,e);return delete r.entities[c.id],t.push(n),o!==c.id}(r,t,c)).length>0;if(0===r.length)return T.None;{const e=c.ids,t=[];return c.ids=c.ids.filter((e,r)=>e in c.entities||(t.push(r),!1)),l(r,c),!n&&t.every(t=>c.ids[t]===e[t])?T.EntitiesOnly:T.Both}}function u(t,c){const r=[],n=[];for(const s of t){const t=x(s,e);t in c.entities?n.push({id:t,changes:s}):r.push(s)}const o=i(n,c),a=s(r,c);switch(!0){case a===T.None&&o===T.None:return T.None;case a===T.Both||o===T.Both:return T.Both;default:return T.EntitiesOnly}}function l(c,r){c.sort(t);const n=[];let o=0,s=0;for(;o<c.length&&s<r.ids.length;){const a=c[o],i=x(a,e),u=r.ids[s];t(a,r.entities[u])<=0?(n.push(i),o++):(n.push(u),s++)}r.ids=n.concat(o<c.length?c.slice(o).map(e):r.ids.slice(s)),c.forEach((t,c)=>{r.entities[e(t)]=t})}return{removeOne:c,removeMany:r,removeAll:n,addOne:S(o),updateOne:S((function(e,t){return i([e],t)})),upsertOne:S((function(e,t){return u([e],t)})),addAll:S(a),setAll:S(a),setOne:S((function(t,c){const r=x(t,e);return r in c.entities?(c.ids=c.ids.filter(e=>e!==r),l([t],c),T.Both):o(t,c)})),addMany:S(s),updateMany:S(i),upsertMany:S(u),map:S((function(e,t){return i(t.ids.reduce((c,r)=>{const n=e(t.entities[r]);return n!==t.entities[r]&&c.push({id:r,changes:n}),c},[]),t)}))}}(t,c):A(t);return Object.assign(Object.assign(Object.assign({selectId:t,sortComparer:c},r),n),o)}({selectId:e=>e.productKey,sortComparer:function(e,t){return e.productKey.localeCompare(t.productKey)}}),Q=X.getInitialState({loaded:!1,selectedPurchaseContract:null}),W=Object(h.q)(Q,Object(h.s)(n.loadProductsSuccess,(e,{products:t})=>X.setAll(t,Object.assign(Object.assign({},e),{loaded:!0,selectedPurchaseContract:null}))),Object(h.s)(n.removePurchaseContractSuccess,(e,{key:t})=>X.removeOne(t,Object.assign(Object.assign({},e),{selectedPurchaseContract:null}))),Object(h.s)(n.createPurchaseContractSuccess,(e,{product:t})=>X.addOne(t,e)),Object(h.s)(n.loadPurchaseContractSuccess,(e,{contract:t})=>Object.assign(Object.assign({},e),{selectedPurchaseContract:t})));function J(e,t){return Object(h.m)({ipfs:P,products:W})(e,t)}const z=Object(h.p)("purchaseContract"),Z=Object(h.r)(z,e=>e.ipfs),ee=Object(h.r)(Z,e=>e.status),te=Object(h.r)(Z,e=>e.ipfsHash),ce=Object(h.r)(Z,e=>e.imageBlob),re=Object(h.r)(z,e=>e.products),{selectEntities:ne,selectAll:oe}=X.getSelectors(re),se=Object(h.r)(re,e=>e.loaded),ae=Object(h.r)(re,e=>e.selectedPurchaseContract),ie=Object(h.r)(ne,p.j,(e,t)=>t&&e[t.id]);var ue=c("659L"),le=c("zp1y"),be=c("lJxs"),de=c("pLZG"),he=c("IzEk"),pe=c("bTqV"),fe=c("Xa2L");const me=["ipfsImage"];function ge(e,t){1&e&&I.Pb(0,"div")}function Oe(e,t){1&e&&I.Pb(0,"mat-progress-spinner",7)}let je=(()=>{class e{constructor(e,t,c){this.store$=e,this.dialogRef=t,this.windowRef=c}ngOnInit(){this.image$=this.checkStore().pipe(Object(b.a)(e=>this.imageRef.nativeElement.src=this.windowRef.window.URL.createObjectURL(e)))}checkStore(){return this.store$.pipe(Object(h.u)(ce),Object(le.a)(this.store$.pipe(Object(h.u)(te))),Object(b.a)(([e,t])=>{e||this.store$.dispatch(j({ipfsHash:t}))}),Object(be.a)(([e,t])=>e),Object(de.a)(e=>!!e),Object(he.a)(1))}}return e.\u0275fac=function(t){return new(t||e)(I.Ob(h.h),I.Ob(l.h),I.Ob(ue.c))},e.\u0275cmp=I.Ib({type:e,selectors:[["app-show-ipfs-image"]],viewQuery:function(e,t){var c;1&e&&I.yc(me,!0),2&e&&I.rc(c=I.dc())&&(t.imageRef=c.first)},decls:12,vars:5,consts:[["mat-dialog-title",""],[4,"ngIf","ngIfElse"],[1,"text-center"],["height","300px","width","300px"],["ipfsImage",""],["loading",""],["mat-stroked-button","","color","warn","cdkFocusInitial","",3,"mat-dialog-close"],["color","warn","mode","indeterminate","value","50","diameter","100","strokeWidth","10"]],template:function(e,t){if(1&e&&(I.Ub(0,"h2",0),I.Cc(1,"IPFS Product Image"),I.Tb(),I.Ac(2,ge,1,0,"div",1),I.hc(3,"async"),I.Ub(4,"mat-dialog-content",2),I.Pb(5,"img",3,4),I.Ac(7,Oe,1,0,"ng-template",null,5,I.Bc),I.Tb(),I.Ub(9,"mat-dialog-actions"),I.Ub(10,"button",6),I.Cc(11,"OK"),I.Tb(),I.Tb()),2&e){const e=I.sc(8);I.Cb(2),I.lc("ngIf",I.ic(3,3,t.image$))("ngIfElse",e),I.Cb(8),I.lc("mat-dialog-close",!0)}},directives:[l.i,o.k,l.f,l.c,pe.b,l.d,fe.a],pipes:[o.b],styles:[""],changeDetection:0}),e})();var Ce=c("A5z7"),ye=c("XiUz"),ve=c("Wp6s"),we=c("kmnG"),Pe=c("qFsG"),Ie=c("d3UM"),Te=c("NFeN"),Se=c("FKr1"),xe=c("Qu3c");const Ae=["file"];function Ue(e,t){1&e&&(I.Ub(0,"mat-error"),I.Cc(1,"Value is required"),I.Tb())}function $e(e,t){1&e&&(I.Ub(0,"mat-error"),I.Cc(1," Invalid product key string. Must be less than 32 bytes"),I.Tb())}function Be(e,t){1&e&&(I.Ub(0,"mat-error"),I.Cc(1,"Value is required"),I.Tb())}function Ee(e,t){1&e&&(I.Ub(0,"mat-error"),I.Cc(1,"Value is required"),I.Tb())}function ke(e,t){1&e&&(I.Ub(0,"mat-error"),I.Cc(1,"Invalid ether value format. Has to be (#.###)"),I.Tb())}function Fe(e,t){if(1&e&&(I.Ub(0,"mat-option",23),I.Cc(1),I.Tb()),2&e){const e=t.$implicit;I.lc("value",e),I.Cb(1),I.Ec(" ",e," ")}}function Re(e,t){1&e&&(I.Ub(0,"mat-error"),I.Cc(1,"Value is required"),I.Tb())}function Le(e,t){if(1&e){const e=I.Vb();I.Ub(0,"button",24),I.cc("click",(function(){return I.uc(e),I.gc().uploadFile()})),I.Cc(1," Upload To IPFS "),I.Ub(2,"mat-icon"),I.Cc(3,"offline_bolt"),I.Tb(),I.Tb()}if(2&e){const e=I.gc();I.lc("disabled",e.formControl("fileArg").invalid)}}function Ke(e,t){1&e&&I.Qb(0)}function Me(e,t){1&e&&(I.Ub(0,"mat-error",34),I.Cc(1,"You must choose a file"),I.Tb())}function De(e,t){1&e&&(I.Ub(0,"mat-error",34),I.Cc(1,"Invalid file image extension"),I.Tb())}function Ne(e,t){if(1&e&&(I.Ub(0,"div",25),I.Ac(1,Me,2,0,"mat-error",33),I.Ac(2,De,2,0,"mat-error",33),I.Tb()),2&e){const e=I.gc(2);I.Cb(1),I.lc("ngIf",e.requiredFile("fileArg")),I.Cb(1),I.lc("ngIf",e.invalidPatternFile("fileArg"))}}function qe(e,t){if(1&e&&(I.Ub(0,"div",25),I.Pb(1,"img",35),I.Ub(2,"p"),I.Cc(3),I.Tb(),I.Tb()),2&e){const e=I.gc(2);I.Cb(1),I.lc("src",e.fileContent,I.vc),I.Cb(2),I.Ec(" ",e.fileBlob.name," ")}}function He(e,t){if(1&e){const e=I.Vb();I.Ub(0,"div",36),I.Ub(1,"button",37),I.cc("click",(function(){return I.uc(e),I.gc(2).loadImage()})),I.Cc(2),I.Ub(3,"mat-icon"),I.Cc(4,"visibility"),I.Tb(),I.Tb(),I.Tb()}if(2&e){const e=t.ngIf;I.Cb(2),I.Ec(" ",e," ")}}function Ve(e,t){1&e&&(I.Ub(0,"div"),I.Pb(1,"mat-progress-spinner",40),I.Tb())}function Ge(e,t){if(1&e&&(I.Ub(0,"mat-chip"),I.Cc(1),I.Tb()),2&e){const e=I.gc(2).ngIf;I.Cb(1),I.Dc(e)}}function _e(e,t){if(1&e&&(I.Ub(0,"mat-chip",43),I.Cc(1),I.Tb()),2&e){const e=I.gc(2).ngIf;I.Cb(1),I.Ec(" ",e," ")}}function Ye(e,t){if(1&e&&(I.Ub(0,"mat-chip",44),I.Cc(1),I.Tb()),2&e){const e=I.gc(2).ngIf;I.Cb(1),I.Ec(" ",e," ")}}function Xe(e,t){if(1&e&&(I.Ac(0,Ge,2,1,"mat-chip",9),I.Ac(1,_e,2,1,"mat-chip",41),I.Ac(2,Ye,2,1,"mat-chip",42)),2&e){const e=I.gc().ngIf,t=I.gc(2);I.lc("ngIf",t.isPending(e)),I.Cb(1),I.lc("ngIf",t.isSuccess(e)),I.Cb(1),I.lc("ngIf",t.isError(e))}}function Qe(e,t){if(1&e&&(I.Ub(0,"div"),I.Ac(1,Ve,2,0,"div",38),I.Ac(2,Xe,3,3,"ng-template",null,39,I.Bc),I.Tb()),2&e){const e=t.ngIf,c=I.sc(3),r=I.gc(2);I.Cb(1),I.lc("ngIf",r.inProgress(e))("ngIfElse",c)}}function We(e,t){if(1&e&&(I.Ub(0,"mat-card-content"),I.Ub(1,"div",6),I.Ub(2,"div",25),I.Cc(3,"Image"),I.Tb(),I.Ub(4,"div",26),I.Cc(5,"IPFS Hash"),I.Tb(),I.Ub(6,"div",27),I.Cc(7,"Upload Status"),I.Tb(),I.Tb(),I.Pb(8,"p"),I.Ub(9,"div",6),I.Ac(10,Ke,1,0,"ng-container",28),I.Ac(11,Ne,3,2,"ng-template",null,29,I.Bc),I.Ac(13,qe,4,2,"ng-template",null,30,I.Bc),I.Ub(15,"div",31),I.Ac(16,He,5,1,"div",32),I.hc(17,"async"),I.Tb(),I.Ub(18,"div",27),I.Ac(19,Qe,4,2,"div",9),I.hc(20,"async"),I.Tb(),I.Tb(),I.Tb()),2&e){const e=I.sc(12),t=I.sc(14),c=I.gc();I.Cb(10),I.lc("ngIf",c.formControl("fileArg").invalid)("ngIfThen",e)("ngIfElse",t),I.Cb(6),I.lc("ngIf",I.ic(17,5,c.ipfsHash$)),I.Cb(3),I.lc("ngIf",I.ic(20,7,c.uploadStatus$))}}function Je(e){let t=!1;try{d.utils.formatBytes32String(e.value),t=!0}catch(c){}return t?null:{forbiddenKey:{value:e.value}}}let ze=(()=>{class e{constructor(e,t,c){this.store$=e,this.formBuilder=t,this.dialog=c,this.IMAGE_PATTERN=/^.+\.(png|jpg|jpeg|gif|png)$/,this.commissions=["1.0","2.0","3.0","4.0","5.0"],this.frmGroup=this.formBuilder.group({productKey:["",[s.p.required,Je]],description:["",s.p.required],etherValue:["",[s.p.required,s.p.pattern(/^\d+(\.\d{1,3})?$/)]],commission:["",s.p.required],fileArg:["",[s.p.required,s.p.pattern(this.IMAGE_PATTERN)]],ipfsHash:["",s.p.required]}),this.formControl=e=>this.frmGroup.get(""+e),this.required=e=>this.formControl(e).hasError("required")&&this.formControl(e).touched,this.invalidPattern=e=>this.formControl(e).hasError("pattern")&&this.formControl(e).dirty,this.invalid32BytesKey=e=>this.formControl(e).hasError("forbiddenKey")&&this.formControl(e).dirty,this.requiredFile=e=>this.formControl(e).hasError("required"),this.invalidPatternFile=e=>this.formControl(e).hasError("pattern"),this.isPending=e=>e===v.Pending,this.isSuccess=e=>e===v.Success,this.isError=e=>e===v.Error,this.inProgress=e=>e===v.Progress}ngOnInit(){this.uploadStatus$=this.store$.pipe(Object(h.u)(ee)),this.ipfsHash$=this.store$.pipe(Object(h.u)(te),Object(b.a)(e=>this.frmGroup.get("ipfsHash").patchValue(e)))}selectFile(){this.fileControl.nativeElement.click()}onFileChange(e){if(e.target.files&&e.target.files.length){this.fileBlob=e.target.files[0],this.frmGroup.get("fileArg").patchValue(this.fileBlob.name);const t=new FileReader;t.readAsDataURL(this.fileBlob),t.onload=e=>{this.fileContent=t.result,this.store$.dispatch(r.reset())}}}uploadFile(){this.store$.dispatch(r.uploadImage({file:this.fileBlob}))}loadImage(){const e=new l.e;e.width="460px",e.disableClose=!0,e.autoFocus=!0,this.dialog.open(je,e)}onCreate(){const{valid:e}=this.frmGroup;if(e){const e=this.frmGroup.value,t=Object(u.c)(e,["fileArg"]);this.store$.dispatch(n.createPurchaseContract({payload:t}))}}ngOnDestroy(){this.store$.dispatch(r.reset())}}return e.\u0275fac=function(t){return new(t||e)(I.Ob(h.h),I.Ob(s.c),I.Ob(l.b))},e.\u0275cmp=I.Ib({type:e,selectors:[["app-new-purchase-contract"]],viewQuery:function(e,t){var c;1&e&&I.Gc(Ae,!0),2&e&&I.rc(c=I.dc())&&(t.fileControl=c.first)},decls:45,vars:15,consts:[["fxLayout","row","fxLayoutAlign","center start"],["fxFlex","60"],["novalidate","",3,"formGroup"],["fxLayout","row","fxLayoutGap","6px"],[1,"red-color"],[1,"mat-caption","text-muted"],["fxLayout","row","fxLayoutAlign","start center"],["fxFlex","",3,"color"],["matInput","","placeholder","Unique Product Key *","formControlName","productKey"],[4,"ngIf"],["matInput","","placeholder","Description *","formControlName","description"],["fxFlex","45",3,"color"],["matInput","","placeholder","Value in ether. Has to include 2x price *","formControlName","etherValue"],["matSuffix",""],["fxFlex","45","fxFlexOffset","40px",3,"color"],["placeholder","Quantity *","formControlName","commission"],[3,"value",4,"ngFor","ngForOf"],["type","file",2,"display","none",3,"change"],["file",""],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","","color","accent",3,"disabled","click",4,"ngIf"],["fxLayout","row","fxLayoutAlign","end center"],["mat-flat-button","","color","warn",1,"margin-right--10",3,"disabled","click"],[3,"value"],["mat-raised-button","","color","accent",3,"disabled","click"],["fxFlex","25",1,"text-center"],["fxFlex","",1,"text-center"],["fxFlex","15",1,"text-center"],[4,"ngIf","ngIfThen","ngIfElse"],["showError",""],["showImage",""],["fxFlex",""],["class","text-center",4,"ngIf"],["mat-line","",4,"ngIf"],["mat-line",""],["height","200","width","200",3,"src"],[1,"text-center"],["mat-stroked-button","","color","warn","matTooltip","Click to show image from IPFS",3,"click"],[4,"ngIf","ngIfElse"],["idle",""],["color","warn","mode","indeterminate","value","50","diameter","50","strokeWidth","5"],["selected","true","color","accent",4,"ngIf"],["selected","true","color","warn",4,"ngIf"],["selected","true","color","accent"],["selected","true","color","warn"]],template:function(e,t){1&e&&(I.Pb(0,"mat-chip-list"),I.Ub(1,"div",0),I.Ub(2,"mat-card",1),I.Ub(3,"mat-card-subtitle"),I.Cc(4," Add Inventory "),I.Tb(),I.Ub(5,"form",2),I.Ub(6,"mat-card-content"),I.Ub(7,"div",3),I.Ub(8,"span",4),I.Cc(9,"*"),I.Tb(),I.Ub(10,"div",5),I.Cc(11,"required fields"),I.Tb(),I.Tb(),I.Ub(12,"div",6),I.Ub(13,"mat-form-field",7),I.Pb(14,"input",8),I.Ac(15,Ue,2,0,"mat-error",9),I.Ac(16,$e,2,0,"mat-error",9),I.Tb(),I.Tb(),I.Ub(17,"div",6),I.Ub(18,"mat-form-field",7),I.Pb(19,"input",10),I.Ac(20,Be,2,0,"mat-error",9),I.Tb(),I.Tb(),I.Ub(21,"div",6),I.Ub(22,"mat-form-field",11),I.Pb(23,"input",12),I.Ub(24,"span",13),I.Cc(25,"$ETH"),I.Tb(),I.Ac(26,Ee,2,0,"mat-error",9),I.Ac(27,ke,2,0,"mat-error",9),I.Tb(),I.Ub(28,"mat-form-field",14),I.Ub(29,"mat-select",15),I.Ac(30,Fe,2,2,"mat-option",16),I.Tb(),I.Pb(31,"span",13),I.Ac(32,Re,2,0,"mat-error",9),I.Tb(),I.Tb(),I.Tb(),I.Ub(33,"input",17,18),I.cc("change",(function(e){return t.onFileChange(e)})),I.Tb(),I.Ub(35,"mat-card-actions"),I.Ub(36,"button",19),I.cc("click",(function(){return t.selectFile()})),I.Cc(37," Product Image "),I.Ub(38,"mat-icon"),I.Cc(39,"category"),I.Tb(),I.Tb(),I.Ac(40,Le,4,1,"button",20),I.Tb(),I.Ac(41,We,21,9,"mat-card-content",9),I.Ub(42,"mat-card-actions",21),I.Ub(43,"button",22),I.cc("click",(function(){return t.onCreate()})),I.Cc(44,"Add Product"),I.Tb(),I.Tb(),I.Tb(),I.Tb(),I.Tb()),2&e&&(I.Cb(5),I.lc("formGroup",t.frmGroup),I.Cb(8),I.lc("color","accent"),I.Cb(2),I.lc("ngIf",t.required("productKey")),I.Cb(1),I.lc("ngIf",t.invalid32BytesKey("productKey")),I.Cb(2),I.lc("color","accent"),I.Cb(2),I.lc("ngIf",t.required("description")),I.Cb(2),I.lc("color","accent"),I.Cb(4),I.lc("ngIf",t.required("etherValue")),I.Cb(1),I.lc("ngIf",t.invalidPattern("etherValue")),I.Cb(1),I.lc("color","accent"),I.Cb(2),I.lc("ngForOf",t.commissions),I.Cb(2),I.lc("ngIf",t.required("description")),I.Cb(8),I.lc("ngIf",t.fileBlob),I.Cb(1),I.lc("ngIf",t.fileBlob),I.Cb(2),I.lc("disabled",t.frmGroup.pristine||t.frmGroup.invalid))},directives:[Ce.b,ye.d,ye.c,ve.a,ye.a,ve.f,s.q,s.l,s.g,ve.c,ye.e,we.c,Pe.b,s.b,s.k,s.f,o.k,we.h,ye.b,Ie.a,o.j,ve.b,pe.b,Te.a,we.b,Se.n,Se.j,xe.a,fe.a,Ce.a],pipes:[o.b],styles:[".spiner-section-200[_ngcontent-%COMP%]{width:200px}.margin-right--10[_ngcontent-%COMP%]{margin-right:10px!important}"]}),e})();var Ze=c("xgIS"),et=c("itXk"),tt=c("JX91"),ct=c("Kj3r"),rt=c("/uUt"),nt=c("MutI"),ot=c("f0Cb");function st(e,t){if(1&e){const e=I.Vb();I.Ub(0,"mat-list-item",1),I.cc("click",(function(){I.uc(e);const c=t.$implicit;return I.gc().selectMe.emit(c)})),I.Pb(1,"img",2),I.Ub(2,"h3",3),I.Cc(3),I.Tb(),I.Pb(4,"mat-divider"),I.Tb()}if(2&e){const e=t.$implicit;I.Cb(3),I.Dc(e.productKey)}}let at=(()=>{class e{constructor(){this.selectMe=new I.o}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=I.Ib({type:e,selectors:[["app-purchase-contract-list"]],inputs:{products:"products"},outputs:{selectMe:"selectMe"},decls:2,vars:1,consts:[[3,"click",4,"ngFor","ngForOf"],[3,"click"],["matListAvatar","","src","../../../../assets/img/purchase-contract.png"],["mat-line","",1,"mat-h3"]],template:function(e,t){1&e&&(I.Ub(0,"mat-list"),I.Ac(1,st,5,1,"mat-list-item",0),I.Tb()),2&e&&(I.Cb(1),I.lc("ngForOf",t.products))},directives:[nt.a,o.j,nt.c,nt.b,Se.j,ot.a],styles:["mat-list[_ngcontent-%COMP%] {\n      position: relative;\n      max-height: 420px;\n      overflow: auto;\n      }","mat-list-item[_ngcontent-%COMP%] {\n      cursor: pointer;\n      }\n\n    mat-list-item[_ngcontent-%COMP%]:hover {\n      box-shadow: 3px 3px 12px -2px rgba(0, 0, 0, 0.5);\n    }"]}),e})();const it=["contractKey"];function ut(e,t){1&e&&(I.Ub(0,"p"),I.Cc(1," No Products to Show "),I.Tb())}let lt=(()=>{class e{constructor(e,t){this.store$=e,this.router=t}ngAfterViewInit(){const e=this.store$.pipe(Object(h.u)(oe)),t=Object(Ze.a)(this.contractKey.nativeElement,"keyup").pipe(Object(be.a)(e=>this.contractKey.nativeElement.value),Object(tt.a)(""),Object(ct.a)(150),Object(rt.a)());this.filteredProducts$=Object(et.a)([e,t]).pipe(Object(be.a)(([e,t])=>e.filter(e=>-1!==e.productKey.indexOf(t)))),setTimeout(()=>{this.contractKey.nativeElement.focus()},150)}selectPurchaseContract(e){this.router.navigate(["market-place/products",e.productKey])}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)(I.Ob(h.h),I.Ob(i.e))},e.\u0275cmp=I.Ib({type:e,selectors:[["app-view-product-collection"]],viewQuery:function(e,t){var c;1&e&&I.Gc(it,!0),2&e&&I.rc(c=I.dc())&&(t.contractKey=c.first)},decls:21,vars:6,consts:[["fxLayout","row","fxLayoutAlign","center stretch","fxLayoutGap","16px"],["fxFlex","50"],["fxLayout","row","fxLayoutAlign","space-between center"],["color","accent","fxFlex","40"],["matInput","","placeholder","Search for contact by key"],["contractKey",""],["mat-mini-fab","","color","warn","routerLink","./make/new","matTooltip","create new contract","matTooltipPosition","left",2,"margin-right","20px"],[3,"products","selectMe"],[4,"ngIf"]],template:function(e,t){if(1&e&&(I.Ub(0,"div",0),I.Ub(1,"mat-card",1),I.Ub(2,"mat-card-subtitle"),I.Cc(3,"Inventory List"),I.Tb(),I.Ub(4,"mat-card-content",2),I.Ub(5,"mat-form-field",3),I.Pb(6,"input",4,5),I.Tb(),I.Ub(8,"div"),I.Ub(9,"a",6),I.Ub(10,"mat-icon"),I.Cc(11,"Add"),I.Tb(),I.Tb(),I.Tb(),I.Tb(),I.Ub(12,"mat-card-content"),I.Ub(13,"app-purchase-contract-list",7),I.cc("selectMe",(function(e){return t.selectPurchaseContract(e)})),I.hc(14,"async"),I.Tb(),I.Ac(15,ut,2,0,"p",8),I.hc(16,"async"),I.Tb(),I.Tb(),I.Ub(17,"mat-card",1),I.Ub(18,"mat-card-subtitle"),I.Cc(19,"Product Details"),I.Tb(),I.Pb(20,"router-outlet"),I.Tb(),I.Tb()),2&e){var c;const e=0===(null==(c=I.ic(16,4,t.filteredProducts$))?null:c.length);I.Cb(13),I.lc("products",I.ic(14,2,t.filteredProducts$)),I.Cb(2),I.lc("ngIf",e)}},directives:[ye.d,ye.c,ye.e,ve.a,ye.a,ve.f,ve.c,we.c,Pe.b,pe.a,i.h,xe.a,Te.a,at,o.k,i.j],pipes:[o.b],encapsulation:2,changeDetection:0}),e})();var bt=c("eIep"),dt=c("XNiG"),ht=function(e){return e[e.Created=0]="Created",e[e.Locked=1]="Locked",e[e.Canceled=2]="Canceled",e[e.ItemReceived=3]="ItemReceived",e[e.SellerPaid=4]="SellerPaid",e[e.OwnerPaid=5]="OwnerPaid",e[e.Completed=6]="Completed",e}({});const pt=["ipfsImage"];function ft(e,t){1&e&&I.Qb(0)}function mt(e,t){if(1&e&&(I.Ub(0,"mat-list-item"),I.Ub(1,"h3",10),I.Cc(2,"Buyer Address"),I.Tb(),I.Ub(3,"span"),I.Cc(4),I.Tb(),I.Tb()),2&e){const e=I.gc(2);I.Cb(4),I.Dc(e.contract.buyerAddress)}}function gt(e,t){if(1&e&&(I.Ub(0,"mat-list-item"),I.Ub(1,"h3",10),I.Cc(2,"Quantity"),I.Tb(),I.Ub(3,"span"),I.Cc(4),I.Tb(),I.Tb()),2&e){const e=I.gc(2);I.Cb(4),I.Dc(e.contract.commission/100)}}function Ot(e,t){if(1&e&&(I.Ub(0,"mat-error"),I.Cc(1),I.Tb()),2&e){const e=I.gc(3);I.Cb(1),I.Dc(e.validatorError)}}function jt(e,t){if(1&e&&(I.Ub(0,"mat-form-field",21),I.Ub(1,"mat-label"),I.Cc(2,"Value in ETH. (2X price)"),I.Tb(),I.Pb(3,"input",22),I.Ac(4,Ot,2,1,"mat-error",11),I.Ub(5,"mat-icon",23),I.Cc(6,"sentiment_very_satisfied"),I.Tb(),I.Ub(7,"mat-hint"),I.Cc(8,"Producer Confirm Purchase"),I.Tb(),I.Tb()),2&e){const e=I.gc(2);I.Cb(3),I.lc("formControl",e.buyerConfirmPrice),I.Cb(1),I.lc("ngIf",e.buyerConfirmPrice.invalid&&e.buyerConfirmPrice.touched)}}function Ct(e,t){if(1&e){const e=I.Vb();I.Ub(0,"button",24),I.cc("click",(function(){I.uc(e);const t=I.gc(2);return t.buy.emit(t.buyerConfirmPrice.value)})),I.Cc(1," Producer Execute Purchase"),I.Tb()}if(2&e){const e=I.gc(2);I.lc("disabled",!(e.buyerConfirmPrice.valid&&e.buyerConfirmPrice.dirty))}}function yt(e,t){if(1&e){const e=I.Vb();I.Ub(0,"button",25),I.cc("click",(function(){return I.uc(e),I.gc(2).delivery.emit()})),I.Cc(1," Supplier Confirm Delivery"),I.Tb()}}function vt(e,t){if(1&e){const e=I.Vb();I.Ub(0,"button",26),I.cc("click",(function(){return I.uc(e),I.gc(2).releaseEscrow.emit()})),I.Cc(1," Supplier Receive Escrow "),I.Ub(2,"mat-icon"),I.Cc(3,"local_bar"),I.Tb(),I.Tb()}}function wt(e,t){if(1&e){const e=I.Vb();I.Ub(0,"mat-card-content"),I.Ub(1,"section",3),I.Ub(2,"h3",4),I.Cc(3,"Contract Status:"),I.Tb(),I.Ub(4,"mat-chip",5),I.Cc(5),I.Tb(),I.Ub(6,"span",6),I.Ub(7,"button",7),I.cc("click",(function(){return I.uc(e),I.gc().abortMe.emit()})),I.Ub(8,"mat-icon"),I.Cc(9,"flash_on"),I.Tb(),I.Tb(),I.Ub(10,"button",8),I.cc("click",(function(){I.uc(e);const t=I.gc();return t.remove.emit(t.contract.productKey)})),I.Ub(11,"mat-icon"),I.Cc(12,"delete_forever"),I.Tb(),I.Tb(),I.Tb(),I.Tb(),I.Ub(13,"section"),I.Ub(14,"mat-list",9),I.Ub(15,"mat-list-item"),I.Ub(16,"h3",10),I.Cc(17,"Product Key:"),I.Tb(),I.Ub(18,"span"),I.Cc(19),I.Tb(),I.Tb(),I.Ub(20,"mat-list-item"),I.Ub(21,"h3",10),I.Cc(22,"Product Description"),I.Tb(),I.Ub(23,"span"),I.Cc(24),I.Tb(),I.Tb(),I.Ub(25,"mat-list-item"),I.Ub(26,"h3",10),I.Cc(27,"Price"),I.Tb(),I.Ub(28,"span"),I.Cc(29),I.Tb(),I.Tb(),I.Ub(30,"mat-list-item"),I.Ub(31,"h3",10),I.Cc(32,"Balance"),I.Tb(),I.Ub(33,"span"),I.Cc(34),I.Tb(),I.Tb(),I.Ub(35,"mat-list-item"),I.Ub(36,"h3",10),I.Cc(37,"Seller Address"),I.Tb(),I.Ub(38,"span"),I.Cc(39),I.Tb(),I.Tb(),I.Ac(40,mt,5,1,"mat-list-item",11),I.Ac(41,gt,5,1,"mat-list-item",11),I.Tb(),I.Tb(),I.Pb(42,"mat-divider"),I.Ub(43,"section",12),I.Ub(44,"h3",13),I.Cc(45,"Product Image"),I.Tb(),I.Pb(46,"img",14,15),I.Tb(),I.Pb(48,"mat-divider"),I.Ub(49,"section",16),I.Ac(50,jt,9,2,"mat-form-field",17),I.Ac(51,Ct,2,1,"button",18),I.Ac(52,yt,2,0,"button",19),I.Ac(53,vt,4,0,"button",20),I.Tb(),I.Pb(54,"mat-card-footer"),I.Tb()}if(2&e){const e=I.gc();I.Cb(4),I.lc("selected",!0)("color",e.statusColors[e.contract.state].color),I.Cb(1),I.Dc(e.enumToString(e.statusColors[e.contract.state].state)),I.Cb(2),I.lc("disabled",!e.canAbort),I.Cb(3),I.lc("disabled",!e.removeFromListing),I.Cb(9),I.Dc(e.contract.productKey),I.Cb(5),I.Dc(e.contract.description),I.Cb(5),I.Ec("",e.contract.price," ETH"),I.Cb(5),I.Ec("",e.contract.balance," ETH"),I.Cb(5),I.Dc(e.contract.sellerAddress),I.Cb(1),I.lc("ngIf",e.contract.buyerAddress),I.Cb(1),I.lc("ngIf",e.showCommission),I.Cb(9),I.lc("ngIf",e.canBuy),I.Cb(1),I.lc("ngIf",e.canBuy),I.Cb(1),I.lc("ngIf",e.canDelivery),I.Cb(1),I.lc("ngIf",e.canReleaseEscrow)}}function Pt(e,t){1&e&&I.Cc(0," ...Please wait for the contract to load.\n")}let It=(()=>{class e{constructor(e){this.windowRef=e,this.remove=new I.o,this.abortMe=new I.o,this.buy=new I.o,this.delivery=new I.o,this.releaseEscrow=new I.o,this.receiveCommission=new I.o,this.statusColors=[{state:ht.Created,color:"accent"},{state:ht.Locked,color:"primary"},{state:ht.Canceled,color:void 0},{state:ht.ItemReceived,color:"accent"},{state:ht.SellerPaid,color:"primary"},{state:ht.OwnerPaid,color:"primary"},{state:ht.Completed,color:"warn"}],this.buyerConfirmPrice=new s.d("",[s.p.required,,s.p.pattern(/^\d+(\.\d{1,4})?$/)]),this.enumToString=e=>ht[e]}ngOnChanges(e){this.imageRef&&(this.imageRef.nativeElement.src=this.windowRef.window.URL.createObjectURL(this.image)),this.buyerConfirmPrice.reset()}get validatorError(){return this.buyerConfirmPrice.hasError("required")?"You must enter a value":this.buyerConfirmPrice.hasError("pattern")?"Not a valid format":""}get removeFromListing(){return this.contract.state===ht.Canceled&&this.contract.ownerAddress===this.account}get canAbort(){return this.contract.state===ht.Created&&this.contract.sellerAddress===this.account}get canBuy(){return this.contract.state===ht.Created&&!this.contract.buyerAddress&&this.contract.sellerAddress!==this.account}get canDelivery(){return this.contract.state===ht.Locked&&this.contract.buyerAddress===this.account}get showCommission(){return this.contract.ownerAddress===this.account||this.contract.sellerAddress===this.account}get canReleaseEscrow(){return(this.contract.state===ht.ItemReceived||this.contract.state===ht.OwnerPaid)&&this.contract.sellerAddress===this.account}get canReceiveCommission(){return(this.contract.state===ht.ItemReceived||this.contract.state===ht.SellerPaid)&&this.contract.ownerAddress===this.account}}return e.\u0275fac=function(t){return new(t||e)(I.Ob(ue.c))},e.\u0275cmp=I.Ib({type:e,selectors:[["app-purchase-contract-detail"]],viewQuery:function(e,t){var c;1&e&&I.Gc(pt,!0),2&e&&I.rc(c=I.dc())&&(t.imageRef=c.first)},inputs:{contract:"contract",image:"image",account:"account"},outputs:{remove:"remove",abortMe:"abortMe",buy:"buy",delivery:"delivery",releaseEscrow:"releaseEscrow",receiveCommission:"receiveCommission"},features:[I.Ab],decls:5,vars:3,consts:[[4,"ngIf","ngIfThen","ngIfElse"],["selectedTmpl",""],["noSelectedTmpl",""],["fxLayout","row","fxLayoutAlign","start center"],["fxFlex","38","fxFlexOffset","2",1,"mat-h3"],["fxFlex","",3,"selected","color"],["fxFlex","20","fxFlexOffset","23"],["mat-icon-button","","color","warn","matTooltip","Abort contract by seller","matTooltipPosition","above",3,"disabled","click"],["mat-icon-button","","color","warn","matTooltip","Remove contract by owner","matTooltipPosition","above",3,"disabled","click"],["dense",""],[1,"mat-h3"],[4,"ngIf"],["fxLayout","row","fxLayoutAlign","start center",2,"padding","15px 0px"],["fxFlex","36","fxFlexOffset","2",1,"mat-h3"],["height","120px","width","120px"],["ipfsImage",""],["fxLayout","row wrap","fxLayoutAlign","space-between center",2,"margin-top","10px"],["appearance","outline",4,"ngIf"],["mat-raised-button","","color","warn",3,"disabled","click",4,"ngIf"],["mat-raised-button","","color","accent",3,"click",4,"ngIf"],["mat-raised-button","","color","primary","matTooltip","Seller click to receive escrow","matTooltipPosition","above",3,"click",4,"ngIf"],["appearance","outline"],["matInput","","required","",3,"formControl"],["matSuffix",""],["mat-raised-button","","color","warn",3,"disabled","click"],["mat-raised-button","","color","accent",3,"click"],["mat-raised-button","","color","primary","matTooltip","Seller click to receive escrow","matTooltipPosition","above",3,"click"]],template:function(e,t){if(1&e&&(I.Ac(0,ft,1,0,"ng-container",0),I.Ac(1,wt,55,16,"ng-template",null,1,I.Bc),I.Ac(3,Pt,1,0,"ng-template",null,2,I.Bc)),2&e){const e=I.sc(2),c=I.sc(4);I.lc("ngIf",t.contract)("ngIfThen",e)("ngIfElse",c)}},directives:[o.k,ve.c,ye.d,ye.c,ye.a,ye.b,Ce.a,pe.b,xe.a,Te.a,nt.a,nt.c,ot.a,ve.d,we.c,we.g,Pe.b,s.b,s.o,s.k,s.e,we.h,we.f,we.b],styles:["mat-list-item[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%] {\n        width: 240px;\n      }"]}),e})();function Tt(e,t){if(1&e){const e=I.Vb();I.Ub(0,"app-purchase-contract-detail",1),I.cc("remove",(function(t){return I.uc(e),I.gc().removePurchaseContract(t)}))("abortMe",(function(){return I.uc(e),I.gc().abortPurchaseContract()}))("buy",(function(t){return I.uc(e),I.gc().confirmBuy(t)}))("delivery",(function(){return I.uc(e),I.gc().confirmDelivery()}))("releaseEscrow",(function(){return I.uc(e),I.gc().withdrawBySeller()}))("receiveCommission",(function(){return I.uc(e),I.gc().withdrawByOwner()})),I.Tb()}if(2&e){const e=t.ngIf;I.lc("contract",e.purchaseContract)("image",e.image)("account",e.account)}}const St=function(e,t,c){return{purchaseContract:e,image:t,account:c}};let xt=(()=>{class e{constructor(e){this.store$=e,this.unsubscribe$=new dt.a}ngOnInit(){this.selectedPurchaseContract$=this.store$.pipe(Object(h.u)(ie),Object(de.a)(e=>!!e),Object(b.a)(e=>this.store$.dispatch(n.loadPurchaseContract({address:e.contractAddress}))),Object(bt.a)(()=>this.store$.select(ae)),Object(de.a)(e=>!!e)),this.image$=this.store$.pipe(Object(h.u)(ae),Object(de.a)(e=>!!e),Object(b.a)(e=>this.store$.dispatch(r.downloadImage({ipfsHash:e.ipfsHash}))),Object(bt.a)(()=>this.store$.select(ce)),Object(de.a)(e=>!!e)),this.account$=this.store$.pipe(Object(h.u)(p.b))}removePurchaseContract(e){this.store$.dispatch(n.removePurchaseContract({key:e}))}abortPurchaseContract(){this.store$.dispatch(n.abortSelectedPurchaseContract())}confirmBuy(e){this.store$.dispatch(n.confirmBuy({eth:e}))}confirmDelivery(){this.store$.dispatch(n.confirmDelivery())}withdrawBySeller(){this.store$.dispatch(n.releaseEscrow())}withdrawByOwner(){this.store$.dispatch(n.withdrawByOwner())}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}}return e.\u0275fac=function(t){return new(t||e)(I.Ob(h.h))},e.\u0275cmp=I.Ib({type:e,selectors:[["app-view-purchase-contract"]],decls:4,vars:11,consts:[[3,"contract","image","account","remove","abortMe","buy","delivery","releaseEscrow","receiveCommission",4,"ngIf"],[3,"contract","image","account","remove","abortMe","buy","delivery","releaseEscrow","receiveCommission"]],template:function(e,t){1&e&&(I.Ac(0,Tt,1,3,"app-purchase-contract-detail",0),I.hc(1,"async"),I.hc(2,"async"),I.hc(3,"async")),2&e&&I.lc("ngIf",I.qc(7,St,I.ic(1,1,t.selectedPurchaseContract$),I.ic(2,3,t.image$),I.ic(3,5,t.account$)))},directives:[o.k,It],pipes:[o.b],encapsulation:2,changeDetection:0}),e})(),At=(()=>{class e{}return e.\u0275mod=I.Mb({type:e}),e.\u0275inj=I.Lb({factory:function(t){return new(t||e)},imports:[[o.c]]}),e})();var Ut=c("Cfvw"),$t=c("LRne"),Bt=c("cp0P"),Et=c("5+tZ"),kt=c("AytR");let Ft=(()=>{class e extends d.providers.Web3Provider{constructor(e){super(e)}}return e.\u0275fac=function(t){return new(t||e)(I.Yb(ue.a))},e.\u0275prov=I.Kb({token:e,factory:e.\u0275fac,providedIn:At}),e})();const Rt=kt.a.fleaMarketContractAddress,Lt=["event LogCreatePurchaseContract(address sender, bytes32 key, address contractAddress)","event LogRemovePurchaseContract(address sender, bytes32 key)","function createPurchaseContract(bytes32 key, string description, string ipfsImageHash, uint256 commissionRate) payable returns(bool createResult)","function getContractCount() view returns(uint contractCount)","function getContractKeyAtIndex(uint index) view returns(bytes32 key)","function getContractByKey(bytes32 key) view returns(address contractAddress)","function contractName() view returns(string contractName)","function removeContractByKey(bytes32 key) returns(bool result)"];let Kt=(()=>{class e extends d.Contract{constructor(e){super(Rt,Lt,e.getSigner())}}return e.\u0275fac=function(t){return new(t||e)(I.Yb(Ft))},e.\u0275prov=I.Kb({token:e,factory:e.\u0275fac,providedIn:At}),e})(),Mt=(()=>{class e{constructor(e){this.contractToken=e,this.widgetObservable=e=>Object(Ut.a)(this.contractToken.getContractKeyAtIndex(e)).pipe(Object(bt.a)(e=>Object(Ut.a)(this.contractToken.getContractByKey(e)).pipe(Object(be.a)(t=>({productKey:d.utils.parseBytes32String(e),contractAddress:t})))))}createPurchaseContract(e){const t=Math.floor(100*parseFloat(e.commission)),c=d.utils.formatBytes32String(e.productKey),r=d.utils.parseEther(e.etherValue),n=this.contractToken.createPurchaseContract(c,e.description,e.ipfsHash,t,{value:r});return Object(Ut.a)(n).pipe(Object(bt.a)(e=>(console.log("Transaction",e),Object(Ut.a)(e.wait()).pipe(Object(b.a)(e=>console.log("TransactionReceipt: ",e)),Object(be.a)(e=>e.events.pop()),Object(be.a)(e=>e.args.contractAddress),Object(b.a)(e=>console.log("address: ",e))))))}getPurchaseContractList(){return Object(Ut.a)(this.contractToken.getContractCount()).pipe(Object(be.a)(e=>e.toNumber()),Object(b.a)(e=>console.log("contractCount: ",e)),Object(bt.a)(e=>{if(0===e)return Object($t.a)([]);{const t=Array.from(Array(e)).map((e,t)=>t);return Object($t.a)(t).pipe(Object(Et.a)(e=>Object(Bt.a)(e.map(this.widgetObservable))))}}))}getName(){return Object(Ut.a)(this.contractToken.contractName()).pipe(Object(be.a)(e=>e))}removePurchaseContract(e){const t=d.utils.formatBytes32String(e),c=this.contractToken.removeContractByKey(t);return Object(Ut.a)(c).pipe(Object(bt.a)(e=>(console.log("removeContractByKey Transaction",e),Object(Ut.a)(e.wait()).pipe(Object(b.a)(e=>console.log("TransactionReceipt: ",e)),Object(be.a)(e=>e.events.pop()),Object(b.a)(e=>console.log("txEvent: ",e)),Object(be.a)(e=>d.utils.parseBytes32String(e.args.key))))))}}return e.\u0275fac=function(t){return new(t||e)(I.Yb(Kt))},e.\u0275prov=I.Kb({token:e,factory:e.\u0275fac,providedIn:At}),e})(),Dt=(()=>{class e{constructor(e){this.fleaSrv=e}ngOnInit(){this.name$=this.fleaSrv.getName()}}return e.\u0275fac=function(t){return new(t||e)(I.Ob(Mt))},e.\u0275cmp=I.Ib({type:e,selectors:[["app-marketplace-home"]],decls:3,vars:0,consts:[[1,"mat-headline","text-center"]],template:function(e,t){1&e&&(I.Ub(0,"h1",0),I.Cc(1,"Inventory Management System"),I.Tb(),I.Pb(2,"router-outlet"))},directives:[i.j],encapsulation:2}),e})(),Nt=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=I.Ib({type:e,selectors:[["app-product-detail-home"]],decls:2,vars:0,consts:[[1,"mat-subheading-2"]],template:function(e,t){1&e&&(I.Ub(0,"h3",0),I.Cc(1," To load a purchase contract details please select the corresponding item from the left panel"),I.Tb())},encapsulation:2}),e})();var qt=c("JIr8");const Ht=[{path:"",redirectTo:"products",pathMatch:"full"},{path:"products",component:Dt,children:[{path:"",component:lt,canActivate:[(()=>{class e{constructor(e){this.store=e}canActivate(){return this.waitForProductsToLoad().pipe(Object(bt.a)(()=>Object($t.a)(!0)),Object(qt.a)(()=>Object($t.a)(!1)))}waitForProductsToLoad(){return this.store.pipe(Object(h.u)(se),Object(b.a)(e=>{e||this.store.dispatch(n.loadProducts())}),Object(de.a)(e=>e),Object(he.a)(1))}}return e.\u0275fac=function(t){return new(t||e)(I.Yb(h.h))},e.\u0275prov=I.Kb({token:e,factory:e.\u0275fac,providedIn:At}),e})()],children:[{path:":id",component:xt},{path:"",component:Nt}]},{path:"make/new",component:ze,pathMatch:"full"}]}];let Vt=(()=>{class e{}return e.\u0275mod=I.Mb({type:e}),e.\u0275inj=I.Lb({factory:function(t){return new(t||e)},imports:[[i.i.forChild(Ht)],i.i]}),e})();var Gt=c("snw9"),_t=c("jJ/W"),Yt=c("XqQ8"),Xt=c("CO7z"),Qt=c("JQUw"),Wt=c("tk/3");let Jt=(()=>{class e{constructor(e,t,c){this.ipfsSrv=e,this.actions$=t,this.httpClient=c,this.uploadImage$=Object(Gt.d)(()=>this.actions$.pipe(Object(Gt.e)(r.uploadImage),Object(be.a)(e=>e.file),Object(Yt.a)(e=>this.ipfsSrv.addFile(e).pipe(Object(b.a)(e=>console.log("IPFS file hash: "+e)),Object(be.a)(e=>r.uploadImageSuccess({ipfsHash:e})),Object(qt.a)(e=>Object($t.a)(this.handleError(e),r.uploadImageFail())))))),this.downloadImage$=Object(Gt.d)(()=>this.actions$.pipe(Object(Gt.e)(r.downloadImage),Object(be.a)(e=>e.ipfsHash),Object(bt.a)(e=>this.ipfsSrv.getFile(e).pipe(Object(be.a)(e=>r.downloadImageSuccess({image:e})),Object(qt.a)(e=>Object($t.a)(this.handleError(e),r.downloadImageError())))))),this.downloadImageError$=Object(Gt.d)(()=>this.actions$.pipe(Object(Gt.e)(r.downloadImageError),Object(bt.a)(()=>this.httpClient.get("./assets/img/error-human.png",{responseType:"blob"}).pipe(Object(be.a)(e=>r.downloadImageSuccess({image:e})),Object(qt.a)(e=>Object($t.a)(this.handleError(e)))))))}handleError(e){const t=Object(_t.serializeError)(e).message;return Xt.a.errorMessage({errorMsg:t})}}return e.\u0275fac=function(t){return new(t||e)(I.Yb(Qt.a),I.Yb(Gt.a),I.Yb(Wt.b))},e.\u0275prov=I.Kb({token:e,factory:e.\u0275fac}),e})();var zt=c("bOdf");function Zt(e,t){return Object(zt.a)(()=>e,t)}var ec=c("7o/Q");function tc(e){return t=>t.lift(new cc(e))}class cc{constructor(e){this.value=e}call(e,t){return t.subscribe(new rc(e,this.value))}}class rc extends ec.a{constructor(e,t){super(e),this.value=t}_next(e){this.destination.next(this.value)}}var nc=c("GyhO"),oc=c("sKXY"),sc=c("Zc21"),ac=c("yCtX"),ic=c("DH7j"),uc=c("Lhse"),lc=c("zx2A");class bc{constructor(e){this.resultSelector=e}call(e,t){return t.subscribe(new dc(e,this.resultSelector))}}class dc extends ec.a{constructor(e,t,c=Object.create(null)){super(e),this.resultSelector=t,this.iterators=[],this.active=0,this.resultSelector="function"==typeof t?t:void 0}_next(e){const t=this.iterators;Object(ic.a)(e)?t.push(new pc(e)):t.push("function"==typeof e[uc.a]?new hc(e[uc.a]()):new fc(this.destination,this,e))}_complete(){const e=this.iterators,t=e.length;if(this.unsubscribe(),0!==t){this.active=t;for(let c=0;c<t;c++){let t=e[c];t.stillUnsubscribed?this.destination.add(t.subscribe()):this.active--}}else this.destination.complete()}notifyInactive(){this.active--,0===this.active&&this.destination.complete()}checkIterators(){const e=this.iterators,t=e.length,c=this.destination;for(let o=0;o<t;o++){let t=e[o];if("function"==typeof t.hasValue&&!t.hasValue())return}let r=!1;const n=[];for(let o=0;o<t;o++){let t=e[o],s=t.next();if(t.hasCompleted()&&(r=!0),s.done)return void c.complete();n.push(s.value)}this.resultSelector?this._tryresultSelector(n):c.next(n),r&&c.complete()}_tryresultSelector(e){let t;try{t=this.resultSelector.apply(this,e)}catch(c){return void this.destination.error(c)}this.destination.next(t)}}class hc{constructor(e){this.iterator=e,this.nextResult=e.next()}hasValue(){return!0}next(){const e=this.nextResult;return this.nextResult=this.iterator.next(),e}hasCompleted(){const e=this.nextResult;return Boolean(e&&e.done)}}class pc{constructor(e){this.array=e,this.index=0,this.length=0,this.length=e.length}[uc.a](){return this}next(e){const t=this.index++;return t<this.length?{value:this.array[t],done:!1}:{value:null,done:!0}}hasValue(){return this.array.length>this.index}hasCompleted(){return this.array.length===this.index}}class fc extends lc.b{constructor(e,t,c){super(e),this.parent=t,this.observable=c,this.stillUnsubscribed=!0,this.buffer=[],this.isComplete=!1}[uc.a](){return this}next(){const e=this.buffer;return 0===e.length&&this.isComplete?{value:null,done:!0}:{value:e.shift(),done:!1}}hasValue(){return this.buffer.length>0}hasCompleted(){return 0===this.buffer.length&&this.isComplete}notifyComplete(){this.buffer.length>0?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()}notifyNext(e){this.buffer.push(e),this.parent.checkIterators()}subscribe(){return Object(lc.c)(this.observable,new lc.a(this))}}let mc=(()=>{class e{constructor(e){this.provider=e,this.abi=["function key() view returns(bytes32 key)","function description() view returns(string description)","function seller() view returns(address sellerAddress)","function buyer() view returns(address buyerAddress)","function owner() view returns(address ownerAddress)","function price()  view returns(uint weiPrice)","function balanceOf() view returns(uint weiBalance)","function ipfsImageHash() view returns(string ipfsHash)","function state() view returns(uint8 state)","function commissionRate() view returns (uint commission)","event LogCanceledBySeller(address indexed sender, uint256 amount, bytes32 key)","function abortBySeller() returns (bool result)","event LogPurchaseConfirmed(address indexed sender, uint256 amount, bytes32 key)","function buyerPurchase() payable returns (bool result)","event LogReceivedByBuyer(address indexed sender, uint256 amount, bytes32 key)","function buyerConfirmReceived() returns (bool result)","event LogWithdrawBySeller(address indexed sender, uint256 amount, bytes32 key)","function withdrawBySeller() returns (bool result)","event LogWithdrawByOwner(address indexed sender, uint256 amount, bytes32 key)","function withdrawByOwner() returns (bool result)"]}loadPurchaseContract(e){const t=new d.ethers.Contract(e,this.abi,this.provider.getSigner()),c=Object(Ut.a)(t.commissionRate()).pipe(Object(be.a)(e=>e.toNumber()),Object(qt.a)(e=>Object($t.a)(null)));return function(...e){const t=e[e.length-1];return"function"==typeof t&&e.pop(),Object(ac.a)(e,void 0).lift(new bc(t))}(Object(Ut.a)(t.key()),Object(Ut.a)(t.seller()),Object(Ut.a)(t.buyer()),Object(Ut.a)(t.owner()),Object(Ut.a)(t.price()),Object(Ut.a)(t.balanceOf()),Object(Ut.a)(t.description()),Object(Ut.a)(t.ipfsImageHash()),Object(Ut.a)(t.state()),Object(Ut.a)(c)).pipe(Object(be.a)(([t,c,r,n,o,s,a,i,u,l])=>(console.log(`key: ${t}, weiPrice: ${o}, state: ${u}, commission: ${l}`),{productKey:d.utils.parseBytes32String(t),contractAddress:e,sellerAddress:c,buyerAddress:r===d.ethers.constants.AddressZero?null:r,ownerAddress:n,price:d.utils.formatEther(o),balance:d.utils.formatEther(s),description:a,ipfsHash:i,state:u,commission:l||null})))}abortPurchaseContract(e){const t=new d.ethers.Contract(e,this.abi,this.provider.getSigner()).abortBySeller();return Object(Ut.a)(t).pipe(Object(bt.a)(t=>(console.log("abortBySeller Tx:",t),Object(Ut.a)(t.wait()).pipe(Object(b.a)(e=>console.log("txReceipt: ",e)),Object(be.a)(e=>e.events.pop()),Object(b.a)(e=>console.log("event: ",e.event)),tc(e)))))}confirmPurchase(e,t){const c=new d.ethers.Contract(e,this.abi,this.provider.getSigner()),r=d.utils.parseEther(t),n=c.buyerPurchase({value:r});return Object(Ut.a)(n).pipe(Object(bt.a)(t=>(console.log("buyerConfirmPurchase Tx:",t),Object(Ut.a)(t.wait()).pipe(Object(b.a)(e=>console.log("txReceipt: ",e)),Object(be.a)(e=>e.events.pop()),Object(b.a)(e=>console.log("event: ",e.event)),tc(e)))))}confirmDelivery(e){const t=new d.ethers.Contract(e,this.abi,this.provider.getSigner()).buyerConfirmReceived();return Object(Ut.a)(t).pipe(Object(bt.a)(t=>(console.log("buyerConfirmReceived Tx:",t),Object(Ut.a)(t.wait()).pipe(Object(b.a)(e=>console.log("txReceipt: ",e)),Object(be.a)(e=>e.events.pop()),Object(b.a)(e=>console.log("event: ",e.event)),tc(e)))))}withdrawBySeller(e){const t=new d.ethers.Contract(e,this.abi,this.provider.getSigner()).withdrawBySeller();return Object(Ut.a)(t).pipe(Object(bt.a)(e=>(console.log("withdrawBySeller Tx:",e),Object(Ut.a)(e.wait()).pipe(Object(b.a)(e=>console.log("txReceipt: ",e)),Object(be.a)(e=>e.events.pop()),Object(b.a)(e=>console.log(`event: ${e.event}, sent by: ${e.args.sender}, withdrawal amount: ${e.args.amount}`)),Object(be.a)(e=>d.ethers.utils.formatEther(e.args.amount))))))}withdrawByOwner(e){const t=new d.ethers.Contract(e,this.abi,this.provider.getSigner()).withdrawByOwner();return Object(Ut.a)(t).pipe(Object(bt.a)(e=>(console.log("withdrawByOwner Tx:",e),Object(Ut.a)(e.wait()).pipe(Object(b.a)(e=>console.log("txReceipt: ",e)),Object(be.a)(e=>e.events.pop()),Object(b.a)(e=>console.log(`event: ${e.event}, sent by: ${e.args.sender}, withdrawal amount: ${e.args.amount}`)),Object(be.a)(e=>d.ethers.utils.formatEther(e.args.amount))))))}}return e.\u0275fac=function(t){return new(t||e)(I.Yb(Ft))},e.\u0275prov=I.Kb({token:e,factory:e.\u0275fac,providedIn:At}),e})(),gc=(()=>{class e{constructor(e,t,c,r,o,s){this.store$=e,this.fleaSrv=t,this.purchaseSrv=c,this.actions$=r,this.router=o,this.dialog=s,this.createProduct$=Object(Gt.d)(()=>this.actions$.pipe(Object(Gt.e)(n.createPurchaseContract),Object(be.a)(e=>e.payload),Object(Yt.a)(e=>this.fleaSrv.createPurchaseContract(e).pipe(Object(b.a)(e=>console.log("Contract address: ",e)),Object(bt.a)(t=>[n.createPurchaseContractSuccess({product:{productKey:e.productKey,contractAddress:t}}),Xt.e.getBalance()]),Object(qt.a)(e=>Object($t.a)(this.handleError(e),Xt.d.hide(),Xt.e.getBalance())))))),this.loadPurchaseContract$=Object(Gt.d)(()=>this.actions$.pipe(Object(Gt.e)(n.loadPurchaseContract),Object(be.a)(e=>e.address),Object(bt.a)(e=>this.purchaseSrv.loadPurchaseContract(e).pipe(Object(be.a)(e=>n.loadPurchaseContractSuccess({contract:e})),Object(qt.a)(e=>Object($t.a)(this.handleError(e),Xt.d.hide())))))),this.loadProducts$=Object(Gt.d)(()=>this.actions$.pipe(Object(Gt.e)(n.loadProducts),Object(bt.a)(()=>this.fleaSrv.getPurchaseContractList().pipe(Object(b.a)(e=>console.log("purchase contracts:",e)),Object(be.a)(e=>n.loadProductsSuccess({products:e})),Object(qt.a)(e=>Object($t.a)(this.handleError(e),Xt.d.hide())))))),this.removeProduct$=Object(Gt.d)(()=>this.actions$.pipe(Object(Gt.e)(n.removePurchaseContract),Object(be.a)(e=>e.key),Object(bt.a)(e=>{const t=new l.e;return t.width="420px",t.disableClose=!0,t.autoFocus=!0,t.data={title:"Confirm Remove",content:`Are you sure to remove contract ${e} from market?`,output:e},this.dialog.open(sc.a,t).afterClosed()}),Object(de.a)(e=>!!e),Object(Yt.a)(e=>Object(nc.a)(Object($t.a)(Xt.d.show()),this.fleaSrv.removePurchaseContract(e).pipe(Object(b.a)(e=>console.log("Contract has been removed: "+e)),Object(zt.a)(e=>[n.removePurchaseContractSuccess({key:e}),Xt.e.getBalance()]),Object(qt.a)(e=>Object($t.a)(this.handleError(e),Xt.d.hide(),Xt.e.getBalance()))),Object($t.a)(Xt.d.hide()))))),this.abortContract$=Object(Gt.d)(()=>this.actions$.pipe(Object(Gt.e)(n.abortSelectedPurchaseContract),Object(le.a)(this.store$.pipe(Object(h.u)(ae))),Object(bt.a)(([e,t])=>{const c=new l.e;return c.width="420px",c.disableClose=!0,c.autoFocus=!0,c.data={title:"Confirm Abort",content:`Are you sure you want to deactivate contract: ${t.productKey}?`,output:t.contractAddress},this.dialog.open(sc.a,c).afterClosed()}),Object(de.a)(e=>!!e),Object(Yt.a)(e=>Object(nc.a)(Object($t.a)(Xt.d.show()),this.purchaseSrv.abortPurchaseContract(e).pipe(Object(b.a)(e=>console.log(`Successfully canceled contract: ${e} `)),Zt([n.abortSelectedPurchaseContractSuccess(),Xt.e.getBalance()]),Object(qt.a)(e=>Object($t.a)(this.handleError(e),Xt.d.hide(),Xt.e.getBalance()))),Object($t.a)(Xt.d.hide()))))),this.confirmBuy$=Object(Gt.d)(()=>this.actions$.pipe(Object(Gt.e)(n.confirmBuy),Object(le.a)(this.store$.pipe(Object(h.u)(ae))),Object(bt.a)(([e,t])=>{const c=new l.e;return c.width="420px",c.disableClose=!0,c.autoFocus=!0,c.data={title:"Confirm Purchase",content:`Please confirm to deposit ${e.eth} ETH into the contract: ${t.productKey}`,output:{address:t.contractAddress,eth:e.eth}},this.dialog.open(sc.a,c).afterClosed()}),Object(de.a)(e=>!!e),Object(Yt.a)(e=>Object(nc.a)(Object($t.a)(Xt.d.show()),this.purchaseSrv.confirmPurchase(e.address,e.eth).pipe(Object(b.a)(e=>console.log(`Purchase confirmed successfully for the contract: ${e} `)),Zt([n.confirmBuySuccess(),Xt.e.getBalance()]),Object(qt.a)(e=>Object($t.a)(this.handleError(e),Xt.e.getBalance()))),Object($t.a)(Xt.d.hide()))))),this.confirmDelivery$=Object(Gt.d)(()=>this.actions$.pipe(Object(Gt.e)(n.confirmDelivery),Object(le.a)(this.store$.pipe(Object(h.u)(ae))),Object(bt.a)(([e,t])=>{const c=new l.e;return c.width="420px",c.disableClose=!0,c.autoFocus=!0,c.data={title:"Confirm Delivery",content:"Are you sure you want to confirm that you received the purchase item "+t.description,output:t.contractAddress},this.dialog.open(sc.a,c).afterClosed()}),Object(de.a)(e=>!!e),Object(Yt.a)(e=>Object(nc.a)(Object($t.a)(Xt.d.show()),this.purchaseSrv.confirmDelivery(e).pipe(Object(b.a)(e=>console.log(`Delivery confirmed successfully for the contract: ${e} `)),Zt([n.confirmDeliverySuccess(),Xt.e.getBalance()]),Object(qt.a)(e=>Object($t.a)(this.handleError(e),Xt.e.getBalance()))),Object($t.a)(Xt.d.hide()))))),this.withdrawBySeller$=Object(Gt.d)(()=>this.actions$.pipe(Object(Gt.e)(n.releaseEscrow),Object(le.a)(this.store$.pipe(Object(h.u)(ae))),Object(be.a)(([e,t])=>t.contractAddress),Object(Yt.a)(e=>this.purchaseSrv.withdrawBySeller(e).pipe(Object(zt.a)(e=>[n.releaseEscrowSuccess({amount:e}),Xt.e.getBalance()]),Object(qt.a)(e=>Object($t.a)(this.handleError(e),Xt.d.hide(),Xt.e.getBalance())))))),this.withdrawByOwner$=Object(Gt.d)(()=>this.actions$.pipe(Object(Gt.e)(n.withdrawByOwner),Object(le.a)(this.store$.pipe(Object(h.u)(ae))),Object(be.a)(([e,t])=>t.contractAddress),Object(Yt.a)(e=>this.purchaseSrv.withdrawByOwner(e).pipe(Object(zt.a)(e=>[n.withdrawByOwnerSuccess({amount:e}),Xt.e.getBalance()]),Object(qt.a)(e=>Object($t.a)(this.handleError(e),Xt.d.hide(),Xt.e.getBalance())))))),this.removeProductRedirect$=Object(Gt.d)(()=>this.actions$.pipe(Object(Gt.e)(n.removePurchaseContractSuccess),Object(b.a)(e=>{this.router.navigate(["/market-place"])})),{dispatch:!1}),this.reload$=Object(Gt.d)(()=>this.actions$.pipe(Object(Gt.e)(n.abortSelectedPurchaseContractSuccess,n.confirmBuySuccess,n.confirmDeliverySuccess,n.releaseEscrowSuccess,n.withdrawByOwnerSuccess),Object(le.a)(this.store$.pipe(Object(h.u)(ae))),Object(b.a)(([e,t])=>Object(u.b)(this,void 0,void 0,(function*(){this.router.routeReuseStrategy.shouldReuseRoute=()=>!1,this.router.navigate(["/market-place/products",t.productKey])})))),{dispatch:!1}),this.showSpinner$=Object(Gt.d)(()=>this.actions$.pipe(Object(Gt.e)(n.createPurchaseContract,n.loadProducts,n.loadPurchaseContract,n.releaseEscrow,n.withdrawByOwner),tc(Xt.d.show()))),this.hideSpinner$=Object(Gt.d)(()=>this.actions$.pipe(Object(Gt.e)(n.createPurchaseContractSuccess,n.loadProductsSuccess,n.loadPurchaseContractSuccess,n.releaseEscrowSuccess,n.withdrawByOwnerSuccess),tc(Xt.d.hide()))),this.showSnackbarOnCreateContract$=Object(Gt.d)(()=>this.actions$.pipe(Object(Gt.e)(n.createPurchaseContractSuccess),Object(be.a)(e=>Xt.c.open({payload:{message:"New smart product contract has been created successfully: Address: "+e.product.contractAddress,color:oc.a.Success}})))),this.showSnackbarOnReleaseEscrow$=Object(Gt.d)(()=>this.actions$.pipe(Object(Gt.e)(n.releaseEscrowSuccess),Object(be.a)(e=>Xt.c.open({payload:{message:`Fund in amount: ${e.amount} ETH has been successfully release back to Seller`,color:oc.a.Success}})))),this.showSnackbarOnReceiveCommission$=Object(Gt.d)(()=>this.actions$.pipe(Object(Gt.e)(n.withdrawByOwnerSuccess),Object(be.a)(e=>Xt.c.open({payload:{message:`Commission in amount: ${e.amount} ETH has been successfully transferred to Owner`,color:oc.a.Success}})))),this.showSnackbarOnSuccess$=Object(Gt.d)(()=>this.actions$.pipe(Object(Gt.e)(n.abortSelectedPurchaseContractSuccess,n.confirmBuySuccess,n.confirmDeliverySuccess),Object(le.a)(this.store$.pipe(Object(h.u)(ae))),Object(be.a)(([e,t])=>{let c="";return"[PurchaseContract/Command] Abort Purchase Contract Success"===e.type?c=`The request made by the seller to abort the contract '${t.description}' has been confirmed!`:"[PurchaseContract/Command] Confirm Buy Success"===e.type?c=`Deposit fund made by the buyer for item '${t.description}' has been confirmed!`:"[PurchaseContract/Command] Confirm Product Delivery Success"===e.type&&(c=`Receiving item '${t.description}' by the buyer has been confirmed!`),Xt.c.open({payload:{message:c,color:oc.a.Success}})})))}handleError(e){const t=Object(_t.serializeError)(e).message;return Xt.a.errorMessage({errorMsg:t})}}return e.\u0275fac=function(t){return new(t||e)(I.Yb(h.h),I.Yb(Mt),I.Yb(mc),I.Yb(Gt.a),I.Yb(i.e),I.Yb(l.b))},e.\u0275prov=I.Kb({token:e,factory:e.\u0275fac}),e})();const Oc=[ze,lt,xt],jc=[Dt,je,at,Nt,It];let Cc=(()=>{class e{}return e.\u0275mod=I.Mb({type:e}),e.\u0275inj=I.Lb({factory:function(t){return new(t||e)},imports:[[o.c,a.c,a.b,s.n,At,Vt,h.j.forFeature("purchaseContract",J),Gt.b.forFeature([Jt,gc])]]}),e})()}}]);