{"version":3,"sources":["webpack:///node_modules/@ngrx/entity/__ivy_ngcc__/fesm2015/entity.js","webpack:///src/app/market-place/components/market-place-home/market-place-home.component.html","webpack:///src/app/market-place/components/purchase-contract-detail/purchase-contract-detail.component.html","webpack:///src/app/market-place/components/purchase-contract-list/purchase-contract-list.component.html","webpack:///src/app/market-place/components/show-ipfs-image/show-ipfs-image.component.html","webpack:///src/app/market-place/containers/new-purchase-contract/new-purchase-contract.component.html","webpack:///src/app/market-place/containers/view-product-collection/view-product-collection.component.html","webpack:///src/app/market-place/components/index.ts","webpack:///src/app/market-place/components/market-place-home/market-place-home.component.ts","webpack:///src/app/market-place/components/product-detail-home/product-detail-home.component.ts","webpack:///src/app/market-place/components/purchase-contract-detail/purchase-contract-detail.component.ts","webpack:///src/app/market-place/components/purchase-contract-list/purchase-contract-list.component.ts","webpack:///src/app/market-place/components/show-ipfs-image/show-ipfs-image.component.css","webpack:///src/app/market-place/components/show-ipfs-image/show-ipfs-image.component.ts","webpack:///src/app/market-place/containers/index.ts","webpack:///src/app/market-place/containers/new-purchase-contract/new-purchase-contract.component.css","webpack:///src/app/market-place/containers/new-purchase-contract/new-purchase-contract.component.ts","webpack:///src/app/market-place/containers/view-product-collection/view-product-collection.component.ts","webpack:///src/app/market-place/containers/view-purchase-contract/view-purchase-contract.component.ts","webpack:///src/app/market-place/guards/index.ts","webpack:///src/app/market-place/guards/products-loaded.guard.ts","webpack:///src/app/market-place/market-place-anchor.module.ts","webpack:///src/app/market-place/market-place-routing.module.ts","webpack:///src/app/market-place/market-place.module.ts","webpack:///src/app/market-place/models/index.ts","webpack:///src/app/market-place/models/purchase-contract.model.ts","webpack:///src/app/market-place/services/flea-market-contract-service.ts","webpack:///src/app/market-place/services/purchase-contract-service.ts","webpack:///src/app/market-place/services/tokens/ethers-web3-token.ts","webpack:///src/app/market-place/services/tokens/flea-market-contract-token.ts","webpack:///src/app/market-place/store/actions/index.ts","webpack:///src/app/market-place/store/actions/ipfs-product-image.actions.ts","webpack:///src/app/market-place/store/actions/purchase-contract.actions.ts","webpack:///src/app/market-place/store/effects/ipfs-product-image.effects.ts","webpack:///src/app/market-place/store/effects/purchase-contract.effects.ts","webpack:///src/app/market-place/store/reducers/index.ts","webpack:///src/app/market-place/store/reducers/ipfs-product-image.reducer.ts","webpack:///src/app/market-place/store/reducers/purchase-contract.reducer.ts"],"names":["getInitialEntityState","ids","entities","createInitialStateFactory","getInitialState","additionalState","Object","assign","createSelectorsFactory","getSelectors","selectState","selectIds","state","selectEntities","selectAll","map","id","selectTotal","length","DidMutate","EntitiesOnly","Both","None","createStateOperator","mutator","operation","arg","clonedEntityState","didMutate","selectIdValue","entity","selectId","key","undefined","console","warn","toString","createUnsortedStateAdapter","addOneMutably","push","addManyMutably","setAllMutably","setOneMutably","removeOneMutably","removeManyMutably","keysOrPredicate","keys","Array","filter","removeAll","takeNewKey","update","original","updated","changes","newKey","hasNewKey","updateOneMutably","updateManyMutably","updates","newKeys","didMutateEntities","didMutateIds","mapMutably","reduce","change","upsertOneMutably","upsertManyMutably","added","didMutateByUpdated","didMutateByAdded","addOne","addMany","addAll","setAll","setOne","updateOne","updateMany","upsertOne","upsertMany","removeOne","removeMany","createSortedStateAdapter","sort","newModels","models","model","merge","val","takeUpdatedModel","originalIds","updatedIndexes","index","every","i","updatesOrMap","j","modelId","entityId","concat","slice","forEach","createEntityAdapter","options","sortComparer","instance","stateFactory","selectorsFactory","stateAdapter","DictionaryNum","Dictionary","UpdateStr","UpdateNum","EntityState","EntityDefinition","EntityStateAdapter","EntitySelectors","EntityAdapter","MarketPlaceHomeComponent","fleaSrv","name$","getName","selector","template","ProductDetailHomeComponent","PurchaseContractDetailComponent","windowRef","remove","abortMe","buy","delivery","releaseEscrow","receiveCommission","statusColors","Created","color","Locked","Canceled","ItemReceived","SellerPaid","OwnerPaid","Completed","buyerConfirmPrice","required","pattern","enumToString","imageRef","nativeElement","src","window","URL","createObjectURL","image","reset","hasError","contract","ownerAddress","account","sellerAddress","buyerAddress","Window","PurchaseContractListComponent","selectMe","ShowIpfsImageComponent","store$","dialogRef","image$","checkStore","pipe","blob","ipfsHash","dispatch","changeDetection","OnPush","bites32StringValidator","control","pathTest","formatBytes32String","value","error","forbiddenKey","NewPurchaseContractComponent","formBuilder","dialog","IMAGE_PATTERN","commissions","frmGroup","group","productKey","description","etherValue","commission","fileArg","formControl","name","get","touched","invalidPattern","dirty","invalid32BytesKey","requiredFile","invalidPatternFile","isPending","status","Pending","isSuccess","Success","isError","Error","inProgress","Progress","uploadStatus$","ipfsHash$","patchValue","fileControl","click","event","target","files","fileBlob","reader","FileReader","readAsDataURL","onload","_","fileContent","result","uploadImage","file","dialogConfig","width","disableClose","autoFocus","open","valid","createPurchaseContract","payload","ViewProductCollectionComponent","router","products$","filter$","contractKey","filteredProducts$","products","filterString","product","indexOf","setTimeout","focus","navigate","ViewPurchaseContractComponent","unsubscribe$","selectedPurchaseContract$","loadPurchaseContract","address","contractAddress","select","downloadImage","account$","removePurchaseContract","abortSelectedPurchaseContract","eth","confirmBuy","confirmDelivery","withdrawByOwner","next","complete","ProductsLoadedGuard","store","waitForProductsToLoad","loaded","loadProducts","providedIn","MarketPlaceAnchorModule","declarations","imports","routes","path","redirectTo","pathMatch","component","children","canActivate","MarketPlaceRoutingModule","forChild","exports","CONTAINERS","COMPONENTS","MarketPlaceModule","entryComponents","forFeature","ContractState","FleaMarketContractService","contractToken","widgetObservable","getContractKeyAtIndex","getContractByKey","widget","parseBytes32String","Math","floor","parseFloat","bytes32Key","wei","parseEther","token","tx","log","wait","txReceipt","events","pop","txEvent","args","getContractCount","bigNumber","toNumber","contractCount","countArr","from","e","source","contractName","removeContractByKey","PurchaseContractService","provider","abi","Contract","getSigner","crObservable","commissionRate","err","seller","buyer","owner","price","balanceOf","ipfsImageHash","weiPrice","weiBalance","constants","AddressZero","formatEther","balance","abortBySeller","buyerPurchase","buyerConfirmReceived","withdrawBySeller","sender","amount","utils","EthersWeb3Token","web3Provider","Web3Provider","FLEA_MARKET_CONTRACT_ADDRESS","fleaMarketContractAddress","FleaMarketContractToken","uploadImageSuccess","uploadImageFail","downloadImageSuccess","downloadImageError","createPurchaseContractSuccess","loadProductsSuccess","loadPurchaseContractSuccess","removePurchaseContractSuccess","abortSelectedPurchaseContractSuccess","confirmBuySuccess","confirmDeliverySuccess","releaseEscrowSuccess","withdrawByOwnerSuccess","IpfsUploadEffects","ipfsSrv","actions$","httpClient","uploadImage$","action","addFile","handleError","downloadImage$","getFile","downloadImageError$","responseType","friendlyErrorMessage","message","errorMessage","errorMsg","PurchaseContractEffects","purchaseSrv","createProduct$","getBalance","hide","loadPurchaseContract$","loadProducts$","getPurchaseContractList","removeProduct$","data","title","content","output","afterClosed","show","abortContract$","abortPurchaseContract","confirmBuy$","confirmPurchase","confirmDelivery$","withdrawBySeller$","withdrawByOwner$","removeProductRedirect$","reload$","routeReuseStrategy","shouldReuseRoute","showSpinner$","hideSpinner$","showSnackbarOnCreateContract$","msg","showSnackbarOnReleaseEscrow$","showSnackbarOnReceiveCommission$","showSnackbarOnSuccess$","type","reducers","ipfs","selectPurchaseContractState","selectIpfsState","getIpfsUploadStatus","getIpfsHash","getImageBlob","getProductEntitiesState","getProductKeys","getProductEntities","getAllProducts","getTotalProducts","isProductsLoaded","getSelectedPurchaseContract","selectedPurchaseContract","getSelectedProductWidget","params","FileUploadStatus","initialState","imageBlob","reducer","sortByKey","a","b","localeCompare","adapter"],"mappings":"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","file":"market-place-market-place-module-es5.js","sourcesContent":["/**\n * @license NgRx 9.2.1\n * (c) 2015-2018 Brandon Roberts, Mike Ryan, Rob Wormald, Victor Savkin\n * License: MIT\n */\nimport { createSelector } from '@ngrx/store';\nimport { isDevMode } from '@angular/core';\n\n/**\n * @fileoverview added by tsickle\n * Generated from: modules/entity/src/entity_state.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n/**\n * @template V\n * @return {?}\n */\nfunction getInitialEntityState() {\n    return {\n        ids: [],\n        entities: {},\n    };\n}\n/**\n * @template V\n * @return {?}\n */\nfunction createInitialStateFactory() {\n    /**\n     * @param {?=} additionalState\n     * @return {?}\n     */\n    function getInitialState(additionalState = {}) {\n        return Object.assign(getInitialEntityState(), additionalState);\n    }\n    return { getInitialState };\n}\n\n/**\n * @fileoverview added by tsickle\n * Generated from: modules/entity/src/state_selectors.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n/**\n * @template T\n * @return {?}\n */\nfunction createSelectorsFactory() {\n    /**\n     * @param {?=} selectState\n     * @return {?}\n     */\n    function getSelectors(selectState) {\n        /** @type {?} */\n        const selectIds = (/**\n         * @param {?} state\n         * @return {?}\n         */\n        (state) => state.ids);\n        /** @type {?} */\n        const selectEntities = (/**\n         * @param {?} state\n         * @return {?}\n         */\n        (state) => state.entities);\n        /** @type {?} */\n        const selectAll = createSelector(selectIds, selectEntities, (/**\n         * @param {?} ids\n         * @param {?} entities\n         * @return {?}\n         */\n        (ids, entities) => ids.map((/**\n         * @param {?} id\n         * @return {?}\n         */\n        (id) => ((/** @type {?} */ (entities)))[id]))));\n        /** @type {?} */\n        const selectTotal = createSelector(selectIds, (/**\n         * @param {?} ids\n         * @return {?}\n         */\n        ids => ids.length));\n        if (!selectState) {\n            return {\n                selectIds,\n                selectEntities,\n                selectAll,\n                selectTotal,\n            };\n        }\n        return {\n            selectIds: createSelector(selectState, selectIds),\n            selectEntities: createSelector(selectState, selectEntities),\n            selectAll: createSelector(selectState, selectAll),\n            selectTotal: createSelector(selectState, selectTotal),\n        };\n    }\n    return { getSelectors };\n}\n\n/**\n * @fileoverview added by tsickle\n * Generated from: modules/entity/src/state_adapter.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n/** @enum {number} */\nconst DidMutate = {\n    EntitiesOnly: 0,\n    Both: 1,\n    None: 2,\n};\nDidMutate[DidMutate.EntitiesOnly] = 'EntitiesOnly';\nDidMutate[DidMutate.Both] = 'Both';\nDidMutate[DidMutate.None] = 'None';\n/**\n * @template V, R\n * @param {?} mutator\n * @return {?}\n */\nfunction createStateOperator(mutator) {\n    return (/**\n     * @template S\n     * @param {?} arg\n     * @param {?} state\n     * @return {?}\n     */\n    function operation(arg, state) {\n        /** @type {?} */\n        const clonedEntityState = {\n            ids: [...state.ids],\n            entities: Object.assign({}, state.entities),\n        };\n        /** @type {?} */\n        const didMutate = mutator(arg, clonedEntityState);\n        if (didMutate === DidMutate.Both) {\n            return Object.assign({}, state, clonedEntityState);\n        }\n        if (didMutate === DidMutate.EntitiesOnly) {\n            return Object.assign(Object.assign({}, state), { entities: clonedEntityState.entities });\n        }\n        return state;\n    });\n}\n\n/**\n * @fileoverview added by tsickle\n * Generated from: modules/entity/src/utils.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n/**\n * @template T\n * @param {?} entity\n * @param {?} selectId\n * @return {?}\n */\nfunction selectIdValue(entity, selectId) {\n    /** @type {?} */\n    const key = selectId(entity);\n    if (isDevMode() && key === undefined) {\n        console.warn('@ngrx/entity: The entity passed to the `selectId` implementation returned undefined.', 'You should probably provide your own `selectId` implementation.', 'The entity that was passed:', entity, 'The `selectId` implementation:', selectId.toString());\n    }\n    return key;\n}\n\n/**\n * @fileoverview added by tsickle\n * Generated from: modules/entity/src/unsorted_state_adapter.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n/**\n * @template T\n * @param {?} selectId\n * @return {?}\n */\nfunction createUnsortedStateAdapter(selectId) {\n    /**\n     * @param {?} entity\n     * @param {?} state\n     * @return {?}\n     */\n    function addOneMutably(entity, state) {\n        /** @type {?} */\n        const key = selectIdValue(entity, selectId);\n        if (key in state.entities) {\n            return DidMutate.None;\n        }\n        state.ids.push(key);\n        state.entities[key] = entity;\n        return DidMutate.Both;\n    }\n    /**\n     * @param {?} entities\n     * @param {?} state\n     * @return {?}\n     */\n    function addManyMutably(entities, state) {\n        /** @type {?} */\n        let didMutate = false;\n        for (const entity of entities) {\n            didMutate = addOneMutably(entity, state) !== DidMutate.None || didMutate;\n        }\n        return didMutate ? DidMutate.Both : DidMutate.None;\n    }\n    /**\n     * @param {?} entities\n     * @param {?} state\n     * @return {?}\n     */\n    function setAllMutably(entities, state) {\n        state.ids = [];\n        state.entities = {};\n        addManyMutably(entities, state);\n        return DidMutate.Both;\n    }\n    /**\n     * @param {?} entity\n     * @param {?} state\n     * @return {?}\n     */\n    function setOneMutably(entity, state) {\n        /** @type {?} */\n        const key = selectIdValue(entity, selectId);\n        if (key in state.entities) {\n            state.entities[key] = entity;\n            return DidMutate.EntitiesOnly;\n        }\n        state.ids.push(key);\n        state.entities[key] = entity;\n        return DidMutate.Both;\n    }\n    /**\n     * @param {?} key\n     * @param {?} state\n     * @return {?}\n     */\n    function removeOneMutably(key, state) {\n        return removeManyMutably([key], state);\n    }\n    /**\n     * @param {?} keysOrPredicate\n     * @param {?} state\n     * @return {?}\n     */\n    function removeManyMutably(keysOrPredicate, state) {\n        /** @type {?} */\n        const keys = keysOrPredicate instanceof Array\n            ? keysOrPredicate\n            : state.ids.filter((/**\n             * @param {?} key\n             * @return {?}\n             */\n            (key) => keysOrPredicate(state.entities[key])));\n        /** @type {?} */\n        const didMutate = keys\n            .filter((/**\n         * @param {?} key\n         * @return {?}\n         */\n        (key) => key in state.entities))\n            .map((/**\n         * @param {?} key\n         * @return {?}\n         */\n        (key) => delete state.entities[key])).length > 0;\n        if (didMutate) {\n            state.ids = state.ids.filter((/**\n             * @param {?} id\n             * @return {?}\n             */\n            (id) => id in state.entities));\n        }\n        return didMutate ? DidMutate.Both : DidMutate.None;\n    }\n    /**\n     * @template S\n     * @param {?} state\n     * @return {?}\n     */\n    function removeAll(state) {\n        return Object.assign({}, state, {\n            ids: [],\n            entities: {},\n        });\n    }\n    /**\n     * @param {?} keys\n     * @param {?} update\n     * @param {?} state\n     * @return {?}\n     */\n    function takeNewKey(keys, update, state) {\n        /** @type {?} */\n        const original = state.entities[update.id];\n        /** @type {?} */\n        const updated = Object.assign({}, original, update.changes);\n        /** @type {?} */\n        const newKey = selectIdValue(updated, selectId);\n        /** @type {?} */\n        const hasNewKey = newKey !== update.id;\n        if (hasNewKey) {\n            keys[update.id] = newKey;\n            delete state.entities[update.id];\n        }\n        state.entities[newKey] = updated;\n        return hasNewKey;\n    }\n    /**\n     * @param {?} update\n     * @param {?} state\n     * @return {?}\n     */\n    function updateOneMutably(update, state) {\n        return updateManyMutably([update], state);\n    }\n    /**\n     * @param {?} updates\n     * @param {?} state\n     * @return {?}\n     */\n    function updateManyMutably(updates, state) {\n        /** @type {?} */\n        const newKeys = {};\n        updates = updates.filter((/**\n         * @param {?} update\n         * @return {?}\n         */\n        update => update.id in state.entities));\n        /** @type {?} */\n        const didMutateEntities = updates.length > 0;\n        if (didMutateEntities) {\n            /** @type {?} */\n            const didMutateIds = updates.filter((/**\n             * @param {?} update\n             * @return {?}\n             */\n            update => takeNewKey(newKeys, update, state))).length > 0;\n            if (didMutateIds) {\n                state.ids = state.ids.map((/**\n                 * @param {?} id\n                 * @return {?}\n                 */\n                (id) => newKeys[id] || id));\n                return DidMutate.Both;\n            }\n            else {\n                return DidMutate.EntitiesOnly;\n            }\n        }\n        return DidMutate.None;\n    }\n    /**\n     * @param {?} map\n     * @param {?} state\n     * @return {?}\n     */\n    function mapMutably(map, state) {\n        /** @type {?} */\n        const changes = state.ids.reduce((/**\n         * @param {?} changes\n         * @param {?} id\n         * @return {?}\n         */\n        (changes, id) => {\n            /** @type {?} */\n            const change = map(state.entities[id]);\n            if (change !== state.entities[id]) {\n                changes.push({ id, changes: change });\n            }\n            return changes;\n        }), []);\n        /** @type {?} */\n        const updates = changes.filter((/**\n         * @param {?} __0\n         * @return {?}\n         */\n        ({ id }) => id in state.entities));\n        return updateManyMutably(updates, state);\n    }\n    /**\n     * @param {?} entity\n     * @param {?} state\n     * @return {?}\n     */\n    function upsertOneMutably(entity, state) {\n        return upsertManyMutably([entity], state);\n    }\n    /**\n     * @param {?} entities\n     * @param {?} state\n     * @return {?}\n     */\n    function upsertManyMutably(entities, state) {\n        /** @type {?} */\n        const added = [];\n        /** @type {?} */\n        const updated = [];\n        for (const entity of entities) {\n            /** @type {?} */\n            const id = selectIdValue(entity, selectId);\n            if (id in state.entities) {\n                updated.push({ id, changes: entity });\n            }\n            else {\n                added.push(entity);\n            }\n        }\n        /** @type {?} */\n        const didMutateByUpdated = updateManyMutably(updated, state);\n        /** @type {?} */\n        const didMutateByAdded = addManyMutably(added, state);\n        switch (true) {\n            case didMutateByAdded === DidMutate.None &&\n                didMutateByUpdated === DidMutate.None:\n                return DidMutate.None;\n            case didMutateByAdded === DidMutate.Both ||\n                didMutateByUpdated === DidMutate.Both:\n                return DidMutate.Both;\n            default:\n                return DidMutate.EntitiesOnly;\n        }\n    }\n    return {\n        removeAll,\n        addOne: createStateOperator(addOneMutably),\n        addMany: createStateOperator(addManyMutably),\n        addAll: createStateOperator(setAllMutably),\n        setAll: createStateOperator(setAllMutably),\n        setOne: createStateOperator(setOneMutably),\n        updateOne: createStateOperator(updateOneMutably),\n        updateMany: createStateOperator(updateManyMutably),\n        upsertOne: createStateOperator(upsertOneMutably),\n        upsertMany: createStateOperator(upsertManyMutably),\n        removeOne: createStateOperator(removeOneMutably),\n        removeMany: createStateOperator(removeManyMutably),\n        map: createStateOperator(mapMutably),\n    };\n}\n\n/**\n * @fileoverview added by tsickle\n * Generated from: modules/entity/src/sorted_state_adapter.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n/**\n * @template T\n * @param {?} selectId\n * @param {?} sort\n * @return {?}\n */\nfunction createSortedStateAdapter(selectId, sort) {\n    const { removeOne, removeMany, removeAll } = createUnsortedStateAdapter(selectId);\n    /**\n     * @param {?} entity\n     * @param {?} state\n     * @return {?}\n     */\n    function addOneMutably(entity, state) {\n        return addManyMutably([entity], state);\n    }\n    /**\n     * @param {?} newModels\n     * @param {?} state\n     * @return {?}\n     */\n    function addManyMutably(newModels, state) {\n        /** @type {?} */\n        const models = newModels.filter((/**\n         * @param {?} model\n         * @return {?}\n         */\n        model => !(selectIdValue(model, selectId) in state.entities)));\n        if (models.length === 0) {\n            return DidMutate.None;\n        }\n        else {\n            merge(models, state);\n            return DidMutate.Both;\n        }\n    }\n    /**\n     * @param {?} models\n     * @param {?} state\n     * @return {?}\n     */\n    function setAllMutably(models, state) {\n        state.entities = {};\n        state.ids = [];\n        addManyMutably(models, state);\n        return DidMutate.Both;\n    }\n    /**\n     * @param {?} entity\n     * @param {?} state\n     * @return {?}\n     */\n    function setOneMutably(entity, state) {\n        /** @type {?} */\n        const id = selectIdValue(entity, selectId);\n        if (id in state.entities) {\n            state.ids = state.ids.filter((/**\n             * @param {?} val\n             * @return {?}\n             */\n            (val) => val !== id));\n            merge([entity], state);\n            return DidMutate.Both;\n        }\n        else {\n            return addOneMutably(entity, state);\n        }\n    }\n    /**\n     * @param {?} update\n     * @param {?} state\n     * @return {?}\n     */\n    function updateOneMutably(update, state) {\n        return updateManyMutably([update], state);\n    }\n    /**\n     * @param {?} models\n     * @param {?} update\n     * @param {?} state\n     * @return {?}\n     */\n    function takeUpdatedModel(models, update, state) {\n        if (!(update.id in state.entities)) {\n            return false;\n        }\n        /** @type {?} */\n        const original = state.entities[update.id];\n        /** @type {?} */\n        const updated = Object.assign({}, original, update.changes);\n        /** @type {?} */\n        const newKey = selectIdValue(updated, selectId);\n        delete state.entities[update.id];\n        models.push(updated);\n        return newKey !== update.id;\n    }\n    /**\n     * @param {?} updates\n     * @param {?} state\n     * @return {?}\n     */\n    function updateManyMutably(updates, state) {\n        /** @type {?} */\n        const models = [];\n        /** @type {?} */\n        const didMutateIds = updates.filter((/**\n         * @param {?} update\n         * @return {?}\n         */\n        update => takeUpdatedModel(models, update, state))).length >\n            0;\n        if (models.length === 0) {\n            return DidMutate.None;\n        }\n        else {\n            /** @type {?} */\n            const originalIds = state.ids;\n            /** @type {?} */\n            const updatedIndexes = [];\n            state.ids = state.ids.filter((/**\n             * @param {?} id\n             * @param {?} index\n             * @return {?}\n             */\n            (id, index) => {\n                if (id in state.entities) {\n                    return true;\n                }\n                else {\n                    updatedIndexes.push(index);\n                    return false;\n                }\n            }));\n            merge(models, state);\n            if (!didMutateIds &&\n                updatedIndexes.every((/**\n                 * @param {?} i\n                 * @return {?}\n                 */\n                (i) => state.ids[i] === originalIds[i]))) {\n                return DidMutate.EntitiesOnly;\n            }\n            else {\n                return DidMutate.Both;\n            }\n        }\n    }\n    /**\n     * @param {?} updatesOrMap\n     * @param {?} state\n     * @return {?}\n     */\n    function mapMutably(updatesOrMap, state) {\n        /** @type {?} */\n        const updates = state.ids.reduce((/**\n         * @param {?} changes\n         * @param {?} id\n         * @return {?}\n         */\n        (changes, id) => {\n            /** @type {?} */\n            const change = updatesOrMap(state.entities[id]);\n            if (change !== state.entities[id]) {\n                changes.push({ id, changes: change });\n            }\n            return changes;\n        }), []);\n        return updateManyMutably(updates, state);\n    }\n    /**\n     * @param {?} entity\n     * @param {?} state\n     * @return {?}\n     */\n    function upsertOneMutably(entity, state) {\n        return upsertManyMutably([entity], state);\n    }\n    /**\n     * @param {?} entities\n     * @param {?} state\n     * @return {?}\n     */\n    function upsertManyMutably(entities, state) {\n        /** @type {?} */\n        const added = [];\n        /** @type {?} */\n        const updated = [];\n        for (const entity of entities) {\n            /** @type {?} */\n            const id = selectIdValue(entity, selectId);\n            if (id in state.entities) {\n                updated.push({ id, changes: entity });\n            }\n            else {\n                added.push(entity);\n            }\n        }\n        /** @type {?} */\n        const didMutateByUpdated = updateManyMutably(updated, state);\n        /** @type {?} */\n        const didMutateByAdded = addManyMutably(added, state);\n        switch (true) {\n            case didMutateByAdded === DidMutate.None &&\n                didMutateByUpdated === DidMutate.None:\n                return DidMutate.None;\n            case didMutateByAdded === DidMutate.Both ||\n                didMutateByUpdated === DidMutate.Both:\n                return DidMutate.Both;\n            default:\n                return DidMutate.EntitiesOnly;\n        }\n    }\n    /**\n     * @param {?} models\n     * @param {?} state\n     * @return {?}\n     */\n    function merge(models, state) {\n        models.sort(sort);\n        /** @type {?} */\n        const ids = [];\n        /** @type {?} */\n        let i = 0;\n        /** @type {?} */\n        let j = 0;\n        while (i < models.length && j < state.ids.length) {\n            /** @type {?} */\n            const model = models[i];\n            /** @type {?} */\n            const modelId = selectIdValue(model, selectId);\n            /** @type {?} */\n            const entityId = state.ids[j];\n            /** @type {?} */\n            const entity = state.entities[entityId];\n            if (sort(model, entity) <= 0) {\n                ids.push(modelId);\n                i++;\n            }\n            else {\n                ids.push(entityId);\n                j++;\n            }\n        }\n        if (i < models.length) {\n            state.ids = ids.concat(models.slice(i).map(selectId));\n        }\n        else {\n            state.ids = ids.concat(state.ids.slice(j));\n        }\n        models.forEach((/**\n         * @param {?} model\n         * @param {?} i\n         * @return {?}\n         */\n        (model, i) => {\n            state.entities[selectId(model)] = model;\n        }));\n    }\n    return {\n        removeOne,\n        removeMany,\n        removeAll,\n        addOne: createStateOperator(addOneMutably),\n        updateOne: createStateOperator(updateOneMutably),\n        upsertOne: createStateOperator(upsertOneMutably),\n        addAll: createStateOperator(setAllMutably),\n        setAll: createStateOperator(setAllMutably),\n        setOne: createStateOperator(setOneMutably),\n        addMany: createStateOperator(addManyMutably),\n        updateMany: createStateOperator(updateManyMutably),\n        upsertMany: createStateOperator(upsertManyMutably),\n        map: createStateOperator(mapMutably),\n    };\n}\n\n/**\n * @fileoverview added by tsickle\n * Generated from: modules/entity/src/create_adapter.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n/**\n * @template T\n * @param {?=} options\n * @return {?}\n */\nfunction createEntityAdapter(options = {}) {\n    const { selectId, sortComparer } = Object.assign({ sortComparer: false, selectId: (/**\n         * @param {?} instance\n         * @return {?}\n         */\n        (instance) => instance.id) }, options);\n    /** @type {?} */\n    const stateFactory = createInitialStateFactory();\n    /** @type {?} */\n    const selectorsFactory = createSelectorsFactory();\n    /** @type {?} */\n    const stateAdapter = sortComparer\n        ? createSortedStateAdapter(selectId, sortComparer)\n        : createUnsortedStateAdapter(selectId);\n    return Object.assign(Object.assign(Object.assign({ selectId,\n        sortComparer }, stateFactory), selectorsFactory), stateAdapter);\n}\n\n/**\n * @fileoverview added by tsickle\n * Generated from: modules/entity/src/models.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n/**\n * @record\n * @template T\n */\nfunction DictionaryNum() { }\n/**\n * @abstract\n * @template T\n */\nclass Dictionary {\n}\n/**\n * @record\n * @template T\n */\nfunction UpdateStr() { }\nif (false) {\n    /** @type {?} */\n    UpdateStr.prototype.id;\n    /** @type {?} */\n    UpdateStr.prototype.changes;\n}\n/**\n * @record\n * @template T\n */\nfunction UpdateNum() { }\nif (false) {\n    /** @type {?} */\n    UpdateNum.prototype.id;\n    /** @type {?} */\n    UpdateNum.prototype.changes;\n}\n/**\n * @record\n * @template T\n */\nfunction EntityState() { }\nif (false) {\n    /** @type {?} */\n    EntityState.prototype.ids;\n    /** @type {?} */\n    EntityState.prototype.entities;\n}\n/**\n * @record\n * @template T\n */\nfunction EntityDefinition() { }\nif (false) {\n    /** @type {?} */\n    EntityDefinition.prototype.selectId;\n    /** @type {?} */\n    EntityDefinition.prototype.sortComparer;\n}\n/**\n * @record\n * @template T\n */\nfunction EntityStateAdapter() { }\nif (false) {\n    /**\n     * @template S\n     * @param {?} entity\n     * @param {?} state\n     * @return {?}\n     */\n    EntityStateAdapter.prototype.addOne = function (entity, state) { };\n    /**\n     * @template S\n     * @param {?} entities\n     * @param {?} state\n     * @return {?}\n     */\n    EntityStateAdapter.prototype.addMany = function (entities, state) { };\n    /**\n     * @deprecated addAll has been renamed. Use setAll instead.\n     * @template S\n     * @param {?} entities\n     * @param {?} state\n     * @return {?}\n     */\n    EntityStateAdapter.prototype.addAll = function (entities, state) { };\n    /**\n     * @template S\n     * @param {?} entities\n     * @param {?} state\n     * @return {?}\n     */\n    EntityStateAdapter.prototype.setAll = function (entities, state) { };\n    /**\n     * @template S\n     * @param {?} entity\n     * @param {?} state\n     * @return {?}\n     */\n    EntityStateAdapter.prototype.setOne = function (entity, state) { };\n    /**\n     * @template S\n     * @param {?} key\n     * @param {?} state\n     * @return {?}\n     */\n    EntityStateAdapter.prototype.removeOne = function (key, state) { };\n    /**\n     * @template S\n     * @param {?} key\n     * @param {?} state\n     * @return {?}\n     */\n    EntityStateAdapter.prototype.removeOne = function (key, state) { };\n    /**\n     * @template S\n     * @param {?} keys\n     * @param {?} state\n     * @return {?}\n     */\n    EntityStateAdapter.prototype.removeMany = function (keys, state) { };\n    /**\n     * @template S\n     * @param {?} keys\n     * @param {?} state\n     * @return {?}\n     */\n    EntityStateAdapter.prototype.removeMany = function (keys, state) { };\n    /**\n     * @template S\n     * @param {?} predicate\n     * @param {?} state\n     * @return {?}\n     */\n    EntityStateAdapter.prototype.removeMany = function (predicate, state) { };\n    /**\n     * @template S\n     * @param {?} state\n     * @return {?}\n     */\n    EntityStateAdapter.prototype.removeAll = function (state) { };\n    /**\n     * @template S\n     * @param {?} update\n     * @param {?} state\n     * @return {?}\n     */\n    EntityStateAdapter.prototype.updateOne = function (update, state) { };\n    /**\n     * @template S\n     * @param {?} updates\n     * @param {?} state\n     * @return {?}\n     */\n    EntityStateAdapter.prototype.updateMany = function (updates, state) { };\n    /**\n     * @template S\n     * @param {?} entity\n     * @param {?} state\n     * @return {?}\n     */\n    EntityStateAdapter.prototype.upsertOne = function (entity, state) { };\n    /**\n     * @template S\n     * @param {?} entities\n     * @param {?} state\n     * @return {?}\n     */\n    EntityStateAdapter.prototype.upsertMany = function (entities, state) { };\n    /**\n     * @template S\n     * @param {?} map\n     * @param {?} state\n     * @return {?}\n     */\n    EntityStateAdapter.prototype.map = function (map, state) { };\n}\n/**\n * @record\n * @template T, V\n */\nfunction EntitySelectors() { }\nif (false) {\n    /** @type {?} */\n    EntitySelectors.prototype.selectIds;\n    /** @type {?} */\n    EntitySelectors.prototype.selectEntities;\n    /** @type {?} */\n    EntitySelectors.prototype.selectAll;\n    /** @type {?} */\n    EntitySelectors.prototype.selectTotal;\n}\n/**\n * @record\n * @template T\n */\nfunction EntityAdapter() { }\nif (false) {\n    /** @type {?} */\n    EntityAdapter.prototype.selectId;\n    /** @type {?} */\n    EntityAdapter.prototype.sortComparer;\n    /**\n     * @return {?}\n     */\n    EntityAdapter.prototype.getInitialState = function () { };\n    /**\n     * @template S\n     * @param {?} state\n     * @return {?}\n     */\n    EntityAdapter.prototype.getInitialState = function (state) { };\n    /**\n     * @return {?}\n     */\n    EntityAdapter.prototype.getSelectors = function () { };\n    /**\n     * @template V\n     * @param {?} selectState\n     * @return {?}\n     */\n    EntityAdapter.prototype.getSelectors = function (selectState) { };\n}\n\n/**\n * @fileoverview added by tsickle\n * Generated from: modules/entity/src/index.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n\n/**\n * @fileoverview added by tsickle\n * Generated from: modules/entity/public_api.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n\n/**\n * @fileoverview added by tsickle\n * Generated from: modules/entity/index.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n\n/**\n * Generated bundle index. Do not edit.\n */\n\nexport { Dictionary, createEntityAdapter };\n\n//# sourceMappingURL=entity.js.map","export default \"<h1 class=\\\"mat-headline text-center\\\">Inventory Management System</h1>\\n\\n<router-outlet></router-outlet>\";","export default \"<ng-container *ngIf=\\\"contract; then selectedTmpl; else noSelectedTmpl\\\">\\n</ng-container>\\n\\n<ng-template #selectedTmpl>\\n\\n  <mat-card-content>\\n    <section fxLayout=\\\"row\\\" fxLayoutAlign=\\\"start center\\\">\\n     \\n      <h3 class=\\\"mat-h3\\\" fxFlex=\\\"38\\\" fxFlexOffset=\\\"2\\\">Contract Status:</h3>\\n      <mat-chip fxFlex [selected]=\\\"true\\\" [color]=\\\"statusColors[contract.state].color\\\">{{\\n        enumToString(statusColors[contract.state].state)\\n                  }}</mat-chip>\\n\\n      <span fxFlex=\\\"20\\\" fxFlexOffset=\\\"23\\\">\\n        <button mat-icon-button color=\\\"warn\\\" matTooltip=\\\"Abort contract by seller\\\" matTooltipPosition=\\\"above\\\"\\n          (click)=\\\"abortMe.emit()\\\" [disabled]=\\\"!canAbort\\\">\\n          <mat-icon>flash_on</mat-icon>\\n        </button>\\n\\n        <button mat-icon-button color=\\\"warn\\\" matTooltip=\\\"Remove contract by owner\\\" matTooltipPosition=\\\"above\\\"\\n          (click)=\\\"remove.emit(contract.productKey)\\\" [disabled]=\\\"!removeFromListing\\\">\\n          <mat-icon>delete_forever</mat-icon>\\n        </button>\\n      </span>\\n\\n    </section>\\n\\n\\n    <section>\\n      <mat-list dense>\\n        <mat-list-item>\\n          <h3 class=\\\"mat-h3\\\">Product Key:</h3>\\n          <span>{{ contract.productKey }}</span>\\n        </mat-list-item>\\n\\n        <mat-list-item>\\n          <h3 class=\\\"mat-h3\\\">Product Description</h3>\\n          <span>{{ contract.description }}</span>\\n        </mat-list-item>\\n\\n        <!-- \\n        <mat-list-item>\\n          <h3 class=\\\"mat-h3\\\">Contract Address</h3>\\n          <span>{{ contract.contractAddress }}</span>\\n        </mat-list-item>\\n        -->\\n\\n        <mat-list-item>\\n          <h3 class=\\\"mat-h3\\\">Price</h3>\\n          <span>{{ contract.price }} ETH</span>\\n        </mat-list-item>\\n\\n        <mat-list-item>\\n          <h3 class=\\\"mat-h3\\\">Balance</h3>\\n          <span>{{ contract.balance }} ETH</span>\\n        </mat-list-item>\\n\\n        <mat-list-item>\\n          <h3 class=\\\"mat-h3\\\">Seller Address</h3>\\n          <span>{{ contract.sellerAddress }}</span>\\n        </mat-list-item>\\n\\n        <mat-list-item *ngIf=\\\"contract.buyerAddress\\\">\\n          <h3 class=\\\"mat-h3\\\">Buyer Address</h3>\\n          <span>{{ contract.buyerAddress }}</span>\\n        </mat-list-item>\\n\\n        <mat-list-item *ngIf=\\\"showCommission\\\">\\n          <h3 class=\\\"mat-h3\\\">Quantity</h3>\\n          <span>{{ contract.commission/100}}</span>\\n        </mat-list-item>\\n\\n\\n      </mat-list>\\n    </section>\\n\\n    <mat-divider></mat-divider>\\n\\n    <section fxLayout=\\\"row\\\" fxLayoutAlign=\\\"start center\\\" style=\\\"padding: 15px 0px\\\">\\n\\n      <h3 class=\\\"mat-h3\\\" fxFlex=\\\"36\\\" fxFlexOffset=\\\"2\\\">Product Image</h3>\\n      <img #ipfsImage height=\\\"120px\\\" width=\\\"120px\\\">\\n\\n    </section>\\n\\n    <mat-divider></mat-divider>\\n\\n    <section fxLayout=\\\"row wrap\\\" fxLayoutAlign=\\\"space-between center\\\" style=\\\"margin-top: 10px\\\">\\n\\n      <mat-form-field appearance=\\\"outline\\\" *ngIf=\\\"canBuy\\\">\\n        <mat-label>Value in ETH. (2X price)</mat-label>\\n        <input matInput [formControl]=\\\"buyerConfirmPrice\\\" required>\\n        <mat-error *ngIf=\\\"buyerConfirmPrice.invalid && buyerConfirmPrice.touched\\\">{{validatorError}}</mat-error>\\n        <mat-icon matSuffix>sentiment_very_satisfied</mat-icon>\\n        <mat-hint>Producer Confirm Purchase</mat-hint>\\n      </mat-form-field>\\n\\n      <button mat-raised-button color=\\\"warn\\\" *ngIf=\\\"canBuy\\\" [disabled]=\\\"!(buyerConfirmPrice.valid && buyerConfirmPrice.dirty)\\\" (click)=\\\"buy.emit(buyerConfirmPrice.value)\\\">\\n        Producer Execute Purchase</button>\\n      <button mat-raised-button color=\\\"accent\\\" *ngIf=\\\"canDelivery\\\" (click)=\\\"delivery.emit()\\\">\\n        Supplier Confirm Delivery</button> \\n      <button mat-raised-button color=\\\"primary\\\" matTooltip=\\\"Seller click to receive escrow\\\" matTooltipPosition=\\\"above\\\" *ngIf=\\\"canReleaseEscrow\\\" (click)=\\\"releaseEscrow.emit()\\\">\\n        Supplier Receive Escrow <mat-icon>local_bar</mat-icon>\\n      </button>\\n     \\n\\n    </section>\\n    <mat-card-footer>\\n\\n    </mat-card-footer>\\n\\n  </mat-card-content>\\n\\n\\n</ng-template>\\n\\n\\n\\n<ng-template #noSelectedTmpl>\\n  ...Please wait for the contract to load.\\n</ng-template>\\n\\n\\n\\n<!-- \\n  <p>Debug purchase contract details: {{ contract | json }}</p>\\n  <p>IPFS image: {{ image }}</p>\\n  -->\";","export default \"\\n\\n\\n<mat-list>\\n\\n    <mat-list-item *ngFor=\\\"let product of products\\\" (click)=\\\"selectMe.emit(product)\\\">\\n        <img matListAvatar src=\\\"../../../../assets/img/purchase-contract.png\\\">\\n        <h3 class=\\\"mat-h3\\\" mat-line>{{product.productKey}}</h3>\\n        <small class=\\\"mat-caption gray-color\\\" mat-line> {{product.contractAddress}} </small>\\n        <mat-divider></mat-divider>\\n    </mat-list-item>\\n\\n</mat-list>\\n   \\n\\n\\n   \\n\\n\\n\\n\";","export default \"\\n<h2 mat-dialog-title>IPFS Product Image</h2>\\n\\n<div *ngIf=\\\"(image$ | async) as image else loading\\\">\\n</div>\\n\\n <mat-dialog-content class=\\\"text-center\\\">\\n    \\n    <img #ipfsImage height=\\\"300px\\\" width=\\\"300px\\\">\\n    \\n    <ng-template #loading>\\n        <mat-progress-spinner \\n            color=\\\"warn\\\"\\n            mode=\\\"indeterminate\\\"\\n            value=\\\"50\\\"\\n            diameter=\\\"100\\\"\\n            strokeWidth=\\\"10\\\">\\n        </mat-progress-spinner>\\n    </ng-template>\\n    \\n </mat-dialog-content>\\n\\n <mat-dialog-actions>\\n    <button mat-stroked-button color=\\\"warn\\\" [mat-dialog-close]=\\\"true\\\"  cdkFocusInitial>OK</button>\\n </mat-dialog-actions>\\n\\n\\n\";","export default \"<mat-chip-list> </mat-chip-list>\\n<div fxLayout=\\\"row\\\" fxLayoutAlign=\\\"center start\\\">\\n\\n  <mat-card fxFlex=\\\"60\\\">\\n    <mat-card-subtitle>\\n      New Inventory Contract\\n    </mat-card-subtitle>\\n\\n    <form [formGroup]=\\\"frmGroup\\\" novalidate>\\n\\n      <mat-card-content>\\n        <div fxLayout=\\\"row\\\" fxLayoutGap=\\\"6px\\\">\\n          <span class=\\\"red-color\\\">*</span>\\n          <div class=\\\"mat-caption text-muted\\\">required fields</div>\\n        </div>\\n\\n        <div fxLayout=\\\"row\\\" fxLayoutAlign=\\\"start center\\\">\\n          <mat-form-field [color]=\\\"'accent'\\\" fxFlex>\\n            <input matInput placeholder=\\\"Unique Product Key *\\\" formControlName=\\\"productKey\\\" />\\n            <mat-error *ngIf=\\\"required('productKey')\\\">Value is required</mat-error>\\n            <mat-error *ngIf=\\\"invalid32BytesKey('productKey')\\\">\\n              Invalid product key string. Must be less than 32 bytes</mat-error>\\n          </mat-form-field>\\n        </div>\\n\\n\\n        <div fxLayout=\\\"row\\\" fxLayoutAlign=\\\"start center\\\">\\n          <mat-form-field [color]=\\\"'accent'\\\" fxFlex>\\n            <input matInput placeholder=\\\"Description *\\\" formControlName=\\\"description\\\" />\\n            <mat-error *ngIf=\\\"required('description')\\\">Value is required</mat-error>\\n          </mat-form-field>\\n        </div>\\n\\n        <div fxLayout=\\\"row\\\" fxLayoutAlign=\\\"start center\\\">\\n          <mat-form-field [color]=\\\"'accent'\\\" fxFlex=\\\"45\\\">\\n            <input matInput placeholder=\\\"Value in ether. Has to include 2x price *\\\" formControlName=\\\"etherValue\\\" />\\n            <span matSuffix>$ETH</span>\\n            <mat-error *ngIf=\\\"required('etherValue')\\\">Value is required</mat-error>\\n            <mat-error *ngIf=\\\"invalidPattern('etherValue')\\\">Invalid ether value format. Has to be (#.###)</mat-error>\\n          </mat-form-field>\\n\\n\\n          <mat-form-field [color]=\\\"'accent'\\\" fxFlex=\\\"45\\\" fxFlexOffset=\\\"40px\\\">\\n            <mat-select placeholder=\\\"Quantity *\\\" formControlName=\\\"commission\\\">\\n              <mat-option *ngFor=\\\"let item of commissions\\\" [value]=\\\"item\\\">\\n                {{item}}\\n              </mat-option>\\n            </mat-select>\\n            <span matSuffix></span>\\n            <mat-error *ngIf=\\\"required('description')\\\">Value is required</mat-error>\\n          </mat-form-field>\\n\\n        </div>\\n\\n\\n      </mat-card-content>\\n\\n      <input type=\\\"file\\\" #file style=\\\"display: none\\\" (change)=\\\"onFileChange($event)\\\" />\\n\\n      <mat-card-actions>\\n        <button mat-raised-button color=\\\"primary\\\" (click)=\\\"selectFile()\\\">\\n           Product Image \\n          <mat-icon>category</mat-icon>\\n        </button>\\n\\n        <button mat-raised-button color=\\\"accent\\\" *ngIf=\\\"fileBlob\\\" (click)=\\\"uploadFile()\\\"\\n          [disabled]=\\\"formControl('fileArg').invalid\\\">\\n          Upload To IPFS\\n          <mat-icon>offline_bolt</mat-icon>\\n        </button>\\n\\n      </mat-card-actions>\\n\\n      <mat-card-content *ngIf=\\\"fileBlob\\\">\\n\\n        <div fxLayout=\\\"row\\\" fxLayoutAlign=\\\"start center\\\">\\n          <div fxFlex=\\\"25\\\" class=\\\"text-center\\\">Image</div>\\n          <div fxFlex class=\\\"text-center\\\">IPFS Hash</div>\\n          <div fxFlex=\\\"15\\\" class=\\\"text-center\\\">Upload Status</div>\\n        </div>\\n        <p></p>\\n\\n        <div fxLayout=\\\"row\\\" fxLayoutAlign=\\\"start center\\\">\\n\\n          <ng-container *ngIf=\\\"formControl('fileArg').invalid; then showError; else showImage\\\">\\n          </ng-container>\\n\\n          <ng-template #showError>\\n            <div fxFlex=\\\"25\\\" class=\\\"text-center\\\">\\n\\n              <mat-error mat-line *ngIf=\\\"requiredFile('fileArg')\\\">You must choose a file</mat-error>\\n              <mat-error mat-line *ngIf=\\\"invalidPatternFile('fileArg')\\\">Invalid file image extension</mat-error>\\n\\n            </div>\\n          </ng-template>\\n\\n          <ng-template #showImage>\\n            <div fxFlex=\\\"25\\\" class=\\\"text-center\\\">\\n              <img [src]=\\\"fileContent\\\" height=\\\"200\\\" width=\\\"200\\\" />\\n              <p> {{fileBlob.name }} </p>\\n            </div>\\n          </ng-template>\\n\\n\\n          <div fxFlex>\\n            <div *ngIf=\\\"(ipfsHash$ | async) as ipfsHash;\\\" class=\\\"text-center\\\">\\n\\n              <button mat-stroked-button color=\\\"warn\\\" matTooltip=\\\"Click to show image from IPFS\\\" (click)=\\\"loadImage()\\\">\\n                {{ipfsHash}}\\n                <mat-icon>visibility</mat-icon>\\n              </button>\\n            </div>\\n\\n          </div>\\n\\n          <div fxFlex=\\\"15\\\" class=\\\"text-center\\\">\\n\\n            <div *ngIf=\\\"(uploadStatus$ | async) as status;\\\">\\n\\n              <div *ngIf=\\\"inProgress(status); else idle\\\">\\n                <mat-progress-spinner color=\\\"warn\\\" mode=\\\"indeterminate\\\" value=\\\"50\\\" diameter=\\\"50\\\" strokeWidth=\\\"5\\\">\\n                </mat-progress-spinner>\\n              </div>\\n\\n              <ng-template #idle>\\n                <mat-chip *ngIf=\\\"isPending(status)\\\">{{ status }}</mat-chip>\\n                <mat-chip *ngIf=\\\"isSuccess(status)\\\" selected=\\\"true\\\" color=\\\"accent\\\">\\n                  {{ status }}\\n                </mat-chip>\\n                <mat-chip *ngIf=\\\"isError(status)\\\" selected=\\\"true\\\" color=\\\"warn\\\">\\n                  {{status}}\\n                </mat-chip>\\n              </ng-template>\\n\\n            </div>\\n\\n          </div>\\n\\n        </div>\\n\\n      </mat-card-content>\\n\\n      <mat-card-actions fxLayout=\\\"row\\\" fxLayoutAlign=\\\"end center\\\">\\n        <button mat-flat-button color=\\\"warn\\\" [disabled]=\\\"frmGroup.pristine || frmGroup.invalid\\\" (click)=\\\"onCreate()\\\"\\n          class='margin-right--10'>Create Contract</button>\\n      </mat-card-actions>\\n\\n      <!--\\n\\n          <mat-card-content>\\n\\n              Control invalid: {{ formControl('fileArg').invalid | json}}\\n              <br>\\n              Control pristine: {{ formControl('fileArg').pristine | json}}\\n\\n          </mat-card-content>\\n\\n            -->\\n\\n    </form>\\n  </mat-card>\\n</div>\";","export default \"<div fxLayout=\\\"row\\\" fxLayoutAlign=\\\"center stretch\\\" fxLayoutGap=\\\"16px\\\">\\n\\n\\n    <mat-card fxFlex=\\\"50\\\">\\n\\n        <mat-card-subtitle>Inventory  List</mat-card-subtitle>\\n\\n        <mat-card-content fxLayout=\\\"row\\\" fxLayoutAlign=\\\"space-between center\\\">\\n            <mat-form-field color=\\\"accent\\\" fxFlex=\\\"40\\\">\\n                <input matInput placeholder=\\\"Search for contact by key\\\" #contractKey>\\n            </mat-form-field>\\n            <div>\\n                <a mat-mini-fab color=\\\"warn\\\" style=\\\"margin-right: 20px\\\"\\n                routerLink='./make/new'\\n                 matTooltip=\\\"create new contract\\\" matTooltipPosition=\\\"left\\\">\\n                    <mat-icon>Add</mat-icon>\\n                </a>\\n            </div>\\n        </mat-card-content>\\n\\n        <mat-card-content>\\n            <app-purchase-contract-list [products]=\\\"filteredProducts$ | async\\\"\\n                (selectMe)=\\\"selectPurchaseContract($event)\\\">\\n            </app-purchase-contract-list>\\n\\n            <p *ngIf=\\\"(filteredProducts$ | async)?.length === 0\\\">\\n                    No Products to Show \\n            </p>\\n        </mat-card-content>\\n    </mat-card>\\n\\n\\n    <mat-card fxFlex=\\\"50\\\">\\n        <mat-card-subtitle>Purchase Contract Details</mat-card-subtitle>\\n\\n        <router-outlet></router-outlet>\\n\\n    </mat-card>\\n\\n\\n\\n\\n\\n\\n\\n</div>\";","\nexport * from './market-place-home/market-place-home.component';\nexport * from './purchase-contract-list/purchase-contract-list.component';\nexport * from './show-ipfs-image/show-ipfs-image.component';\nexport * from './product-detail-home/product-detail-home.component';\nexport * from './purchase-contract-detail/purchase-contract-detail.component';\n","import { Component, OnInit } from '@angular/core';\nimport { FleaMarketContractService } from '../../services/flea-market-contract-service';\nimport { Observable } from 'rxjs';\n\n@Component({\n  selector: 'app-marketplace-home',\n  templateUrl: './market-place-home.component.html',\n})\nexport class MarketPlaceHomeComponent implements OnInit  {\n\n  name$: Observable<string>;\n\n  constructor(\n    private fleaSrv: FleaMarketContractService,\n\n  ) { }\n\n  ngOnInit() {\n\n    this.name$ = this.fleaSrv.getName();\n  }\n\n}\n","\nimport { Component, } from '@angular/core';\n\n@Component({\n    selector: 'app-product-detail-home',\n    template: `\n       <h3 class='mat-subheading-2'> To load a purchase contract details please select the corresponding item from the left panel</h3>\n    `,\n  })\n  export class ProductDetailHomeComponent {\n\n  }\n\n","\nimport { Component, EventEmitter, Input, Output, OnChanges, SimpleChanges, Inject, ViewChild, ElementRef } from '@angular/core';\nimport { FormControl, Validators } from '@angular/forms';\nimport { windowRefToken } from '../../../core/services/tokens';\nimport { PurchaseContractModel, ContractState } from '../../models';\nimport {ThemePalette} from '@angular/material/core';\n\n\ninterface StatusColor {\n  state: ContractState;\n  color: ThemePalette;\n}\n\n@Component({\n  selector: 'app-purchase-contract-detail',\n  templateUrl: './purchase-contract-detail.component.html',\n  styles: [\n    `\n    mat-list-item h3 {\n        width: 240px;\n      }\n\n    `\n  ]\n})\nexport class PurchaseContractDetailComponent implements OnChanges {\n\n  @ViewChild('ipfsImage') imageRef: ElementRef;\n  @Input() contract: PurchaseContractModel;\n  @Input() image: Blob;\n  @Input() account: string;\n  @Output() remove = new EventEmitter<string>();\n  @Output() abortMe = new EventEmitter();\n  @Output() buy = new EventEmitter<string>();\n  @Output() delivery = new EventEmitter();\n  @Output() releaseEscrow = new EventEmitter();\n  @Output() receiveCommission = new EventEmitter();\n\n  statusColors: StatusColor[] = [\n    {state: ContractState.Created, color: 'accent'},\n    {state: ContractState.Locked, color: 'primary'},\n    {state: ContractState.Canceled, color: undefined},\n    {state: ContractState.ItemReceived, color: 'accent'},\n    {state: ContractState.SellerPaid, color: 'primary'},\n    {state: ContractState.OwnerPaid, color: 'primary'},\n    {state: ContractState.Completed, color: 'warn'},\n  ];\n\n  buyerConfirmPrice = new FormControl('', [Validators.required, , Validators.pattern(/^\\d+(\\.\\d{1,4})?$/)]);\n\n  constructor(\n    @Inject(windowRefToken) private windowRef: Window\n  ) { }\n\n  ngOnChanges(changes: SimpleChanges) {\n\n    if (this.imageRef) {\n      this.imageRef.nativeElement.src = this.windowRef.window.URL.createObjectURL(this.image);\n    }\n\n    this.buyerConfirmPrice.reset();\n  }\n\n  // based on http://geekswithblogs.net/PhubarBaz/archive/2013/11/25/typescript-enums-to-string.aspx\n  enumToString = (state: ContractState): string => ContractState[state];\n\n  get validatorError() {\n    return this.buyerConfirmPrice.hasError('required') ? 'You must enter a value' :\n      this.buyerConfirmPrice.hasError('pattern') ? 'Not a valid format' :\n        '';\n  }\n\n\n  // only the deployer can remove contract and the state is Canceled\n  get removeFromListing() {\n    return (this.contract.state === ContractState.Canceled) &&\n    (this.contract.ownerAddress === this.account);\n  }\n\n\n  // only the seller can abort contract and the state is Created\n  get canAbort() {\n    return (this.contract.state === ContractState.Created) &&\n    (this.contract.sellerAddress === this.account);\n\n  }\n  /* criteria to buy action\n   - contract in state Created\n   - Buyer address is null\n   - And it is should be not the Seller\n\n  */\n  get canBuy() {\n    return (this.contract.state === ContractState.Created)\n    && (!this.contract.buyerAddress)\n    && (this.contract.sellerAddress !== this.account);\n\n  }\n  // only the buyer can perform this action and the state is Locked\n  get canDelivery() {\n    return (this.contract.state === ContractState.Locked) &&\n    (this.contract.buyerAddress === this.account);\n  }\n\n  // only the seller and the deployer can see commission field\n  get showCommission() {\n    return (this.contract.ownerAddress === this.account) ||\n    (this.contract.sellerAddress === this.account);\n  }\n\n  get canReleaseEscrow() {\n    return (this.contract.state === ContractState.ItemReceived || this.contract.state === ContractState.OwnerPaid ) &&\n    (this.contract.sellerAddress === this.account);\n  }\n\n  get canReceiveCommission() {\n    return (this.contract.state === ContractState.ItemReceived || this.contract.state === ContractState.SellerPaid ) &&\n    (this.contract.ownerAddress === this.account);\n  }\n\n}\n\n","import { Component, Input, Output, EventEmitter } from '@angular/core';\n\nimport { PurchaseWidgetModel } from '../../models';\n\n\n@Component({\n  selector: 'app-purchase-contract-list',\n  templateUrl: './purchase-contract-list.component.html',\n  styles: [\n    `\n    mat-list {\n      position: relative;\n      max-height: 420px;\n      overflow: auto;\n      }\n\n    `,\n    `\n    mat-list-item {\n      cursor: pointer;\n      }\n\n    mat-list-item:hover {\n      box-shadow: 3px 3px 12px -2px rgba(0, 0, 0, 0.5);\n    }\n\n    `,\n  ],\n\n})\nexport class PurchaseContractListComponent {\n\n  @Input() products: PurchaseWidgetModel[];\n  @Output() selectMe = new EventEmitter<PurchaseWidgetModel>();\n}\n","export default \"\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL21hcmtldC1wbGFjZS9jb21wb25lbnRzL3Nob3ctaXBmcy1pbWFnZS9zaG93LWlwZnMtaW1hZ2UuY29tcG9uZW50LmNzcyJ9 */\";","\nimport { ChangeDetectionStrategy, Component, Inject, OnInit, ViewChild, ElementRef } from '@angular/core';\nimport { MatDialogRef } from '@angular/material/dialog';\nimport { windowRefToken } from '../../../core/services/tokens';\nimport { Observable } from 'rxjs';\nimport { withLatestFrom, map, tap, filter, take } from 'rxjs/operators';\n\nimport { Store, select } from '@ngrx/store';\nimport * as fromPurchaseContract from '../../store/reducers';\nimport * as IpfsActions from '../../store/actions/ipfs-product-image.actions';\n\n@Component({\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  selector: 'app-show-ipfs-image',\n  templateUrl: 'show-ipfs-image.component.html',\n  styleUrls: ['show-ipfs-image.component.css']\n})\nexport class ShowIpfsImageComponent implements OnInit {\n\n  @ViewChild('ipfsImage', { static: true }) imageRef: ElementRef;\n  image$: Observable<Blob>;\n\n  constructor(\n    private store$: Store<fromPurchaseContract.AppState>,\n    public dialogRef: MatDialogRef<ShowIpfsImageComponent>,\n    @Inject(windowRefToken) private windowRef: Window\n  ) { }\n\n\n  ngOnInit() {\n    this.image$ = this.checkStore().pipe(\n      tap((blob) =>\n        this.imageRef.nativeElement.src = this.windowRef.window.URL.createObjectURL(blob)\n      )\n    );\n  }\n\n  checkStore(): Observable<Blob> {\n    return this.store$.pipe(\n      select(fromPurchaseContract.getImageBlob),\n      withLatestFrom(this.store$.pipe(select(fromPurchaseContract.getIpfsHash))),\n\n      tap(([image, ipfsHash]) => {\n        if (!image) {\n          this.store$.dispatch(IpfsActions.downloadImage({ ipfsHash }));\n        }\n      }),\n      map(([image, ipfsHash]) => image),\n      // Notice that the filter() returns the observable sequence that contains elements\n      // from the input sequence that satisfy the condition.\n      // so in this case, if the image blob is null, the steam will not continue, but\n      // when the image blob is not empty, we grab this value.\n      // Which means we are waiting for the\n      // image blob value has become not null and then we continue the stream and take this one value .\n      // after that the whole stream will be completed.\n      filter(image => !!image),\n      take(1)\n    );\n  }\n\n\n\n}\n","\nexport * from './new-purchase-contract/new-purchase-contract.component';\nexport * from './view-product-collection/view-product-collection.component';\nexport * from './view-purchase-contract/view-purchase-contract.component';\n","export default \"\\n.spiner-section-200 {\\n    width: 200px;\\n}\\n\\n.margin-right--10 {\\n    margin-right: 10px !important\\n }\\n\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvbWFya2V0LXBsYWNlL2NvbnRhaW5lcnMvbmV3LXB1cmNoYXNlLWNvbnRyYWN0L25ldy1wdXJjaGFzZS1jb250cmFjdC5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFDQTtJQUNJLFlBQVk7QUFDaEI7O0FBRUE7SUFDSTtDQUNIIiwiZmlsZSI6InNyYy9hcHAvbWFya2V0LXBsYWNlL2NvbnRhaW5lcnMvbmV3LXB1cmNoYXNlLWNvbnRyYWN0L25ldy1wdXJjaGFzZS1jb250cmFjdC5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiXG4uc3BpbmVyLXNlY3Rpb24tMjAwIHtcbiAgICB3aWR0aDogMjAwcHg7XG59XG5cbi5tYXJnaW4tcmlnaHQtLTEwIHtcbiAgICBtYXJnaW4tcmlnaHQ6IDEwcHggIWltcG9ydGFudFxuIH1cblxuIl19 */\";","import { Component, ViewChild, ElementRef, OnInit, OnDestroy } from '@angular/core';\nimport { FormBuilder, FormGroup, Validators, AbstractControl } from '@angular/forms';\nimport { MatDialog, MatDialogConfig } from '@angular/material/dialog';\nimport { Observable } from 'rxjs';\nimport { tap } from 'rxjs/operators';\nimport { utils } from 'ethers';\n\nimport { Store, select } from '@ngrx/store';\nimport * as fromPurchaseContract from '../../store/reducers';\nimport { IpfsImageActions, PurchaseContractActions } from '../../store/actions';\nimport { FileUploadStatus } from '../../store/reducers/ipfs-product-image.reducer';\n\nimport { ShowIpfsImageComponent } from '../../components/show-ipfs-image/show-ipfs-image.component';\n\n/* based on\n      https://docs.ethers.io/ethers.js/html/api-utils.html#bytes32-strings\n\n      check if string is less then 32 bytes. Needed to pass into the smart contract\n  */\nfunction bites32StringValidator(control: AbstractControl): { [key: string]: any } | null {\n\n  let pathTest = false;\n\n  try {\n    utils.formatBytes32String(control.value);\n    pathTest = true;\n\n  } catch (error) {\n    // console.log('bites32StringValidator', error)\n  }\n  /*\n  If our validation fails, we return an object with a key for the error name and a value of true.\n  Otherwise, if the validation passes, we simply return null.\n  */\n\n  return !pathTest ? {\n    forbiddenKey: {\n      value: control.value\n    }\n  } : null;\n}\n\n@Component({\n  selector: 'app-new-purchase-contract',\n  templateUrl: './new-purchase-contract.component.html',\n  styleUrls: ['./new-purchase-contract.component.css']\n})\nexport class NewPurchaseContractComponent implements OnInit, OnDestroy {\n\n  @ViewChild('file') fileControl: ElementRef;\n  fileBlob: File;\n  fileContent: ArrayBuffer;\n\n  ipfsHash$: Observable<string>;\n  uploadStatus$: Observable<FileUploadStatus>;\n  private readonly IMAGE_PATTERN: RegExp = /^.+\\.(png|jpg|jpeg|gif|png)$/;\n  commissions: string[] = ['2.0', '2.5', '3.0', '3.5', '4.0'];\n\n  constructor(\n    private store$: Store<fromPurchaseContract.AppState>,\n    private formBuilder: FormBuilder,\n    public dialog: MatDialog\n  ) { }\n\n  frmGroup: FormGroup = this.formBuilder.group({\n    productKey: ['', [Validators.required, bites32StringValidator]],\n    description: ['', Validators.required],\n    etherValue: ['', [Validators.required, Validators.pattern(/^\\d+(\\.\\d{1,3})?$/)]],\n    commission: ['', Validators.required],\n    fileArg: [\n      '', [Validators.required, Validators.pattern(this.IMAGE_PATTERN)]\n    ],\n    ipfsHash: ['', Validators.required] // to hold ipfsHash value\n  });\n\n\n  ngOnInit() {\n\n    this.uploadStatus$ = this.store$.pipe(select(fromPurchaseContract.getIpfsUploadStatus));\n    this.ipfsHash$ = this.store$.pipe(\n      select(fromPurchaseContract.getIpfsHash),\n      tap(value => this.frmGroup.get('ipfsHash').patchValue(value))\n    );\n  }\n\n  formControl = (name: string) => this.frmGroup.get(`${name}`);\n\n  /*\n     A controls is said to be touched if the the user focused on the control\n     and then focused on something else.\n     For example by clicking into the control and then pressing tab or clicking on another control in the form.\n\n      The difference between touched and dirty is that with touched the user doesn’t need to actually change\n      the value of the input control.\n    */\n  required = (name: string) =>\n    this.formControl(name).hasError('required') && this.formControl(name).touched\n\n  invalidPattern = (name: string) =>\n    // 'dirty' means that the user is actually interacted with the control\n    // making attempt of typing vs just focusing or blaring\n    this.formControl(name).hasError('pattern') && this.formControl(name).dirty\n\n  invalid32BytesKey = (name: string) =>\n    this.formControl(name).hasError('forbiddenKey') && this.formControl(name).dirty\n\n  requiredFile = (name: string) => this.formControl(name).hasError('required');\n  invalidPatternFile = (name: string) => this.formControl(name).hasError('pattern');\n\n\n  // here is the way to emulate the click on the file input control\n  selectFile() {\n    this.fileControl.nativeElement.click();\n  }\n\n  onFileChange(event) {\n    if (event.target.files && event.target.files.length) {\n      this.fileBlob = event.target.files[0];\n\n      this.frmGroup.get('fileArg').patchValue(this.fileBlob.name);\n\n      const reader = new FileReader();\n      reader.readAsDataURL(this.fileBlob);\n      reader.onload = _ => {\n        this.fileContent = reader.result as ArrayBuffer;\n        this.store$.dispatch(IpfsImageActions.reset());\n      };\n    }\n  }\n\n  uploadFile() {\n    this.store$.dispatch(IpfsImageActions.uploadImage({ file: this.fileBlob }));\n  }\n\n\n  isPending = (status: FileUploadStatus) => status === FileUploadStatus.Pending;\n  isSuccess = (status: FileUploadStatus) => status === FileUploadStatus.Success;\n  isError = (status: FileUploadStatus) => status === FileUploadStatus.Error;\n  inProgress = (status: FileUploadStatus) => status === FileUploadStatus.Progress;\n\n\n  loadImage() {\n    const dialogConfig = new MatDialogConfig();\n    dialogConfig.width = '460px';\n    dialogConfig.disableClose = true;\n    dialogConfig.autoFocus = true;\n\n    this.dialog.open(ShowIpfsImageComponent, dialogConfig);\n\n  }\n\n  onCreate(): void {\n    const { valid } = this.frmGroup;\n\n    if (valid) {\n      const { fileArg, ...model } = this.frmGroup.value;\n      this.store$.dispatch(PurchaseContractActions.createPurchaseContract({ payload: model }));\n    }\n\n  }\n\n  ngOnDestroy(): void {\n\n    this.store$.dispatch(IpfsImageActions.reset());\n  }\n\n}\n","\nimport { ChangeDetectionStrategy, Component, OnInit, AfterViewInit, ViewChild, ElementRef } from '@angular/core';\nimport { Store, select } from '@ngrx/store';\nimport { Observable, combineLatest, fromEvent } from 'rxjs';\nimport { debounceTime, distinctUntilChanged, map, startWith, delay } from 'rxjs/operators';\nimport { Router } from '@angular/router';\nimport * as fromStore from '../../store/reducers';\nimport { PurchaseWidgetModel } from '../../models';\n\n@Component({\n  selector: 'app-view-product-collection',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  templateUrl: './view-product-collection.component.html',\n\n})\nexport class ViewProductCollectionComponent implements OnInit, AfterViewInit {\n\n\n  @ViewChild('contractKey') contractKey: ElementRef;\n\n  filteredProducts$: Observable<PurchaseWidgetModel[]>;\n\n  constructor(\n    private store$: Store<fromStore.AppState>,\n    private router: Router\n\n  ) { }\n\n  /*based on https://alligator.io/angular/viewchild-access-component/\n      *Notice that we wait for the AfterViewInit lifecycle hook to access our variable,\n      * as this is when child components/DOM elements and directives become available\n      *\n      * */\n  ngAfterViewInit() {\n    const products$ = this.store$.pipe(select(fromStore.getAllProducts));\n\n    const filter$ = fromEvent(this.contractKey.nativeElement, 'keyup').pipe(\n      map(event => this.contractKey.nativeElement.value),\n      startWith(''),\n      debounceTime(150),\n      distinctUntilChanged());\n\n    this.filteredProducts$ = combineLatest([products$, filter$]).pipe(\n      map(([products, filterString]) => products.filter(product => product.productKey.indexOf(filterString) !== -1))\n    );\n\n    // based on https://blog.angular-university.io/angular-debugging/\n    setTimeout(() => {\n      this.contractKey.nativeElement.focus();\n    }, 150);\n\n  }\n\n  selectPurchaseContract(product: PurchaseWidgetModel) {\n    this.router.navigate(['market-place/products', product.productKey]);\n  }\n\n  ngOnInit() {\n\n  }\n\n\n}\n\n\n\n","\nimport { Component, OnInit, OnDestroy, ChangeDetectionStrategy, } from '@angular/core';\nimport { Store, select } from '@ngrx/store';\nimport { map, takeUntil, tap, filter, switchMap } from 'rxjs/operators';\nimport { Subject, Observable } from 'rxjs';\nimport * as fromStore from '../../store/reducers';\nimport * as fromRoot from '../../../core/store/reducers';\nimport { PurchaseContractActions, IpfsImageActions } from '../../store/actions';\nimport { PurchaseContractModel } from '../../models';\n\n@Component({\n  selector: 'app-view-purchase-contract',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  template: `\n\n      <app-purchase-contract-detail\n        *ngIf=\"{ purchaseContract: selectedPurchaseContract$|async,\n          image: image$|async,\n          account: account$|async } as values;\"\n        [contract]=\"values.purchaseContract\"\n        [image] = \"values.image\"\n        [account] = \"values.account\"\n        (remove)=\"removePurchaseContract($event)\"\n        (abortMe)=\"abortPurchaseContract()\"\n        (buy)=\"confirmBuy($event)\"\n        (delivery)=\"confirmDelivery()\"\n        (releaseEscrow)=\"withdrawBySeller()\"\n        (receiveCommission)=\"withdrawByOwner()\"\n        >\n      </app-purchase-contract-detail>\n    `,\n})\nexport class ViewPurchaseContractComponent implements OnInit, OnDestroy {\n\n  account$: Observable<string>;\n  selectedPurchaseContract$: Observable<PurchaseContractModel>;\n  image$: Observable<Blob>;\n\n  constructor(\n    private store$: Store<fromStore.AppState>,\n  ) { }\n\n  private unsubscribe$: Subject<void> = new Subject<void>();\n\n  ngOnInit() {\n\n    this.selectedPurchaseContract$ = this.store$.pipe(\n      select(fromStore.getSelectedProductWidget),\n      filter(product => !!product),\n      tap(product => this.store$.dispatch(PurchaseContractActions.loadPurchaseContract({ address: product.contractAddress }))),\n     /* Function that enables angular http client \n        \n          https://brianflove.com/2017/11/02/angular-http-client-blob/\n    */ \n    switchMap(() => this.store$.select(fromStore.getSelectedPurchaseContract)),\n      filter(contract => !!contract),\n    );\n\n\n    this.image$ = this.store$.pipe(\n      select(fromStore.getSelectedPurchaseContract),\n      filter(contract => !!contract),\n      tap(contract =>\n        this.store$.dispatch(IpfsImageActions.downloadImage({ ipfsHash: contract.ipfsHash }))\n      ),\n      //Observable Switch as  Described Earlier in the Code \n      switchMap(() => this.store$.select(fromStore.getImageBlob)),\n      filter(image => !!image)\n    );\n\n\n    this.account$ = this.store$.pipe(select(fromRoot.getAccount));\n\n  }\n\n  removePurchaseContract(key: string) {\n    this.store$.dispatch(PurchaseContractActions.removePurchaseContract({ key }));\n  }\n\n  abortPurchaseContract() {\n    this.store$.dispatch(PurchaseContractActions.abortSelectedPurchaseContract());\n  }\n\n  confirmBuy(eth: string) {\n    // console.log(`Buyer pays: ${eth}`);\n    this.store$.dispatch(PurchaseContractActions.confirmBuy({eth}));\n  }\n\n  confirmDelivery() {\n    this.store$.dispatch(PurchaseContractActions.confirmDelivery());\n  }\n\n  withdrawBySeller() {\n    this.store$.dispatch(PurchaseContractActions.releaseEscrow());\n  }\n\n  withdrawByOwner() {\n    this.store$.dispatch(PurchaseContractActions.withdrawByOwner());\n  }\n\n  ngOnDestroy() {\n    this.unsubscribe$.next();\n    this.unsubscribe$.complete();\n\n  }\n\n}\n\n","\nexport * from './products-loaded.guard';\n\n","\n\nimport { Injectable } from '@angular/core';\nimport { CanActivate } from '@angular/router';\nimport { Store, select } from '@ngrx/store';\nimport { Observable, of } from 'rxjs';\nimport { take, tap, filter, switchMap, catchError } from 'rxjs/operators';\nimport { MarketPlaceAnchorModule } from '../market-place-anchor.module';\nimport * as fromStore from '../store/reducers';\nimport { PurchaseContractActions } from '../store/actions';\n\n\n@Injectable({\n  providedIn: MarketPlaceAnchorModule\n})\nexport class ProductsLoadedGuard implements CanActivate {\n  constructor(private store: Store<fromStore.AppState>) { }\n\n  canActivate(): Observable<boolean> {\n    return this.waitForProductsToLoad().pipe(\n\n      switchMap(() => of(true)),\n      catchError(() => of(false))\n    );\n  }\n\n\n  waitForProductsToLoad(): Observable<boolean> {\n    return this.store.pipe(\n      select(fromStore.isProductsLoaded),\n      tap(loaded => {\n        if (!loaded) {\n          this.store.dispatch(PurchaseContractActions.loadProducts());\n\n        }\n      }),\n      // Notice that the filter() returns the observable sequence that contains elements\n      // from the input sequence that satisfy the condition.\n      // so in this case, if the loaded is false, the steam will not continue, but\n      // when the loaded is true, we grab this bool value. Which means we are waiting for the\n      // loaded value has become true and then we continue the stream and take this one value .\n      // after that the whole stream will be completed.\n      filter(loaded => loaded),\n      take(1)\n    );\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\n//I was trying to follow the idea to avoid the Circular Dependencies warning\n// https://medium.com/@tomastrajan/total-guide-to-angular-6-dependency-injection-providedin-vs-providers-85b7a347b59f\n\n@NgModule({\n  declarations: [],\n  imports: [\n    CommonModule\n  ]\n})\nexport class MarketPlaceAnchorModule { }\n","import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\n\nimport * as fromContainers from './containers';\nimport * as fromComponents from './components';\nimport * as guards from './guards';\n\n\n/*\n- The multiple routes work like an ‘&&’ condition in javascript, i.e., angular won’t execute the later guards, if the first one fails.\n- The prioritization works by giving the guard closest to the root of the application the highest priority.\nAs a result, if a child guard returns false but its parent hasn’t resolved yet,\nit’ll wait until the parent resolves. If the parent guard check fails,\nit’ll take priority over all the others.\n*/\n\n/*\nThe path-matching strategy, one of 'prefix' or 'full'. Default is 'prefix'.\n\nBy default, the router checks URL elements from the left to see if the URL matches a given path,\nand stops when there is a match. For example, '/team/11/user' matches 'team/:id'.\n\nThe path-match strategy 'full' matches against the entire URL.\nIt is important to do this when redirecting empty-path routes.\n Otherwise, because an empty path is a prefix of any URL,\n the router would apply the redirect even when navigating to the redirect destination,\n  creating an endless loop.\n*/\n\nconst routes: Routes = [\n  {\n    path: '',\n    redirectTo: 'products',\n    pathMatch: 'full',\n  },\n\n  {\n    path: 'products',\n    component: fromComponents.MarketPlaceHomeComponent,\n    children: [\n      {\n        path: '',\n        component: fromContainers.ViewProductCollectionComponent,\n        canActivate: [guards.ProductsLoadedGuard],\n        children: [\n          {\n            path: ':id',\n            component: fromContainers.ViewPurchaseContractComponent,\n          },\n          {\n            path: '',\n            component: fromComponents.ProductDetailHomeComponent\n          },\n\n        ]\n\n      },\n      {\n        path: 'make/new',\n        component: fromContainers.NewPurchaseContractComponent,\n        pathMatch: 'full',\n      },\n\n    ]\n  }\n\n];\n\n\n@NgModule({\n  imports: [\n    RouterModule.forChild(routes),\n  ],\n  exports: [RouterModule]\n})\nexport class MarketPlaceRoutingModule { }\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { ReactiveFormsModule } from '@angular/forms';\nimport { MaterialModule, FlexLayoutModule } from '../shared';\nimport { MarketPlaceRoutingModule } from './market-place-routing.module';\n\n\nimport { StoreModule } from '@ngrx/store';\nimport { EffectsModule } from '@ngrx/effects';\nimport { reducers } from './store/reducers';\nimport { IpfsUploadEffects } from './store/effects/ipfs-product-image.effects';\nimport { PurchaseContractEffects } from './store/effects/purchase-contract.effects';\n\nimport * as fromContainers from './containers';\nimport * as fromComponents from './components';\n\nimport { MarketPlaceAnchorModule } from './market-place-anchor.module';\n\n\nexport const CONTAINERS = [\n    fromContainers.NewPurchaseContractComponent,\n    fromContainers.ViewProductCollectionComponent,\n    fromContainers.ViewPurchaseContractComponent\n\n  ];\n\nexport const COMPONENTS = [\n    fromComponents.MarketPlaceHomeComponent,\n    fromComponents.ShowIpfsImageComponent,\n    fromComponents.PurchaseContractListComponent,\n    fromComponents.ProductDetailHomeComponent,\n    fromComponents.PurchaseContractDetailComponent\n  ];\n\n\n@NgModule({\n  declarations: [COMPONENTS, CONTAINERS],\n\n\n  /*based on https://alligator.io/angular/anatomy-angular-module/\n     * This is for components that can�t be found by the Angular compiler during compilation time\n     * because they are not referenced anywhere in component templates.\n\n      Components that should go into entryComponents are not that common.\n      A good example would be Angular Material dialogs, because they are created dynamically,\n      and the Angular compiler would not know about them otherwise.\n     * */\n  entryComponents: [\n    fromComponents.ShowIpfsImageComponent,\n  ],\n  imports: [\n    CommonModule,\n    MaterialModule,\n    FlexLayoutModule ,\n    ReactiveFormsModule,\n    MarketPlaceAnchorModule,\n    MarketPlaceRoutingModule,\n\n    StoreModule.forFeature('purchaseContract', reducers),\n    EffectsModule.forFeature([IpfsUploadEffects, PurchaseContractEffects])\n  ],\n})\nexport class MarketPlaceModule { }\n","\nexport * from './purchase-contract.model';\nexport * from './purchase-widget.model';\n","\n\nexport enum ContractState {\n  Created = 0,\n  Locked,\n  Canceled,\n  ItemReceived,\n  SellerPaid,\n  OwnerPaid,\n  Completed\n}\n\nexport interface PurchaseContractModel {\n    productKey: string;\n    contractAddress: string;\n    sellerAddress: string;\n    buyerAddress?: string;   // optional as item may not under contract yet by the buyer\n    ownerAddress: string;\n    price: string;  // $ETH\n    balance: string;  // $ETH\n    description: string;\n    ipfsHash: string;\n    state: ContractState;\n    commission?: number;\n}\n","\nimport { Injectable } from '@angular/core';\nimport { MarketPlaceAnchorModule } from '../market-place-anchor.module';\nimport { FleaMarketContractToken } from './tokens/flea-market-contract-token';\nimport { Observable, from, of, forkJoin } from 'rxjs';\nimport { map, tap, switchMap, mergeMap, exhaustMap } from 'rxjs/operators';\nimport { ethers, utils } from 'ethers';\nimport { PurchaseWidgetModel } from '../models';\n\n@Injectable({ providedIn: MarketPlaceAnchorModule })\nexport class FleaMarketContractService {\n  constructor(private contractToken: FleaMarketContractToken) {\n  }\n\n  public createPurchaseContract(product: any): Observable<string> {\n\n    const commission = Math.floor(parseFloat(product.commission) * 100);\n    const bytes32Key = utils.formatBytes32String(product.productKey);\n    const wei = utils.parseEther(product.etherValue);\n/*\n     based on https://docs.ethers.io/ethers.js/html/cookbook-contracts.html\n    Call the contract method, getting back the transaction tx\n  */\n    const token =\n      this.contractToken.createPurchaseContract(bytes32Key, product.description, product.ipfsHash, commission, {\n        value: wei\n      });\n    return from(token)\n      .pipe(\n        switchMap((tx: any) => {\n\n          console.log('Transaction', tx);\n          // Wait for transaction to be mined\n          // Returned a Promise which would resolve to the TransactionReceipt once it is mined.\n          return from(tx.wait()).pipe(\n            tap((txReceipt: any) => console.log('TransactionReceipt: ', txReceipt)),\n\n            // The receipt will have an \"events\" Array, which will have\n            // the emitted 'event LogCreatePurchaseContract(address sender, address contractAddress)'.\n            map(txReceipt => txReceipt.events.pop()),\n            map(txEvent => txEvent.args.contractAddress),\n            tap(address => console.log('address: ', address)));\n        }));\n\n  }\n\n  // The following function shows how to use a first observable in the project  \n  private widgetObservable = (id: number): Observable<PurchaseWidgetModel> =>\n    from(this.contractToken.getContractKeyAtIndex(id)).pipe(\n      switchMap(key => from(this.contractToken.getContractByKey(key)).pipe(\n        map(address => {\n\n          const widget: PurchaseWidgetModel = {\n            productKey: utils.parseBytes32String(key as ethers.utils.Arrayish),\n            contractAddress: address as string\n          };\n\n          return widget;\n\n        })\n      ))\n    )\n\n  // The following function is based on https://www.learnrxjs.io/operators/combination/forkjoin.html\n  public getPurchaseContractList(): Observable<PurchaseWidgetModel[]> {\n\n    return from(this.contractToken.getContractCount()).pipe(\n\n      map((bigNumber: ethers.utils.BigNumber) => bigNumber.toNumber()),\n      tap((contractCount: number) => console.log('contractCount: ', contractCount)),\n\n      switchMap((contractCount: number) => {\n\n        if (contractCount === 0) {\n          return of([]);\n        } else {\n          // we get array [0,1,....contractCount-1]\n          const countArr: number[] = Array.from(Array(contractCount)).map((e, i) => i);\n          const source = of(countArr);\n\n          return source.pipe(\n            mergeMap(ids => forkJoin(ids.map(this.widgetObservable)))\n\n          );\n\n        }\n      })\n    );\n  }\n\n  public getName(): Observable<string> {\n\n    return from(this.contractToken.contractName()).pipe(\n      map(name => name as string)\n    );\n\n  }\n\n  public removePurchaseContract(productKey: string): Observable<string> {\n\n    const bytes32Key = utils.formatBytes32String(productKey);\n\n    // The following function is based on https://docs.ethers.io/ethers.js/html/cookbook-contracts.html\n    // The function Calls the contract method, getting back the transaction tx\n    const token = this.contractToken.removeContractByKey(bytes32Key);\n    return from(token)\n      .pipe(\n        switchMap((tx: any) => {\n\n          console.log('removeContractByKey Transaction', tx);\n          // Wait for transaction to be mined\n          // Returned a Promise which would resolve to the TransactionReceipt once it is mined.\n          return from(tx.wait()).pipe(\n            tap((txReceipt: any) => console.log('TransactionReceipt: ', txReceipt)),\n\n            // The receipt will have an \"events\" Array, which will have\n            // the emitted event from the Contract. The \"LogRemovePurchaseContract(address sender, bytes32 key))\n            // call is the last event.\n            map(txReceipt => txReceipt.events.pop()),\n            tap(txEvent => console.log('txEvent: ', txEvent)),\n            map(txEvent => {\n              // retrieve the key parameter value from the event\n              const key = txEvent.args.key;\n              return utils.parseBytes32String(key as ethers.utils.Arrayish);\n            }),\n\n          );\n        }));\n\n  }\n\n\n}\n\n\n\n\n","\nimport { Injectable } from '@angular/core';\nimport { MarketPlaceAnchorModule } from '../market-place-anchor.module';\nimport { EthersWeb3Token } from './tokens/ethers-web3-token';\nimport { Observable, from, of, zip } from 'rxjs';\nimport { map, mapTo, tap, switchMap, catchError } from 'rxjs/operators';\nimport { ethers, Contract, utils } from 'ethers';\nimport { PurchaseContractModel, ContractState } from '../models';\n\n@Injectable({ providedIn: MarketPlaceAnchorModule })\nexport class PurchaseContractService {\n\n  private readonly abi = [\n    'function key() view returns(bytes32 key)',\n    'function description() view returns(string description)',\n    'function seller() view returns(address sellerAddress)',\n    'function buyer() view returns(address buyerAddress)',\n    'function owner() view returns(address ownerAddress)',\n    'function price()  view returns(uint weiPrice)',\n    'function balanceOf() view returns(uint weiBalance)',\n    'function ipfsImageHash() view returns(string ipfsHash)',\n    'function state() view returns(uint8 state)',\n    'function commissionRate() view returns (uint commission)',\n\n    'event LogCanceledBySeller(address indexed sender, uint256 amount, bytes32 key)',\n    'function abortBySeller() returns (bool result)',\n\n    'event LogPurchaseConfirmed(address indexed sender, uint256 amount, bytes32 key)',\n    'function buyerPurchase() payable returns (bool result)',\n\n    'event LogReceivedByBuyer(address indexed sender, uint256 amount, bytes32 key)',\n    'function buyerConfirmReceived() returns (bool result)',\n\n    'event LogWithdrawBySeller(address indexed sender, uint256 amount, bytes32 key)',\n    'function withdrawBySeller() returns (bool result)',\n\n    'event LogWithdrawByOwner(address indexed sender, uint256 amount, bytes32 key)',\n    'function withdrawByOwner() returns (bool result)',\n\n  ];\n\n  constructor(private provider: EthersWeb3Token) {\n  }\n\n  public loadPurchaseContract(contractAddress: string): Observable<PurchaseContractModel> {\n\n    // We connect to the Contract using a Provider, so we will only\n    // have read-only access to the Contract\n    const contract: Contract = new ethers.Contract(contractAddress, this.abi, this.provider.getSigner());\n\n    const crObservable: Observable<number | null> = from(contract.commissionRate()).pipe(\n      map((commission: ethers.utils.BigNumber) => commission.toNumber()),\n\n      // only account with deployer or seller can retrieve this value,\n      // otherwise the contract will throw error.\n      catchError((err: Error) => of(null))\n    );\n\n    // based on https://scotch.io/tutorials/rxjs-operators-for-dummies-forkjoin-zip-combinelatest-withlatestfrom\n    return zip(\n      from(contract.key()),\n      from(contract.seller()),\n      from(contract.buyer()),\n      from(contract.owner()),\n      from(contract.price()),\n      from(contract.balanceOf()),\n      from(contract.description()),\n      from(contract.ipfsImageHash()),\n      from(contract.state()),\n      from(crObservable),\n\n    )\n      .pipe(\n\n        map(([key, sellerAddress, buyerAddress, ownerAddress, weiPrice, weiBalance, description, ipfsHash, state, commission]) => {\n\n          console.log(`key: ${key}, weiPrice: ${weiPrice}, state: ${state}, commission: ${commission}`);\n          // key: 0x706967794d6f64656c3030303500000000000000000000000000000000000000, weiPrice: 500000000000000, state: 0\n          const product: PurchaseContractModel = {\n\n            productKey: utils.parseBytes32String(key as ethers.utils.Arrayish),\n            contractAddress,\n            sellerAddress: sellerAddress as string,\n            buyerAddress: (buyerAddress === ethers.constants.AddressZero) ? null : buyerAddress as string,\n            ownerAddress: ownerAddress as string,\n            price: utils.formatEther(weiPrice as ethers.utils.BigNumberish),  // $ETH\n            balance: utils.formatEther(weiBalance as ethers.utils.BigNumberish),  // $ETH\n            description: description as string,\n            ipfsHash: ipfsHash as string,\n            state: state as ContractState,\n            commission: commission ? commission as number : null\n          };\n\n          return product;\n\n        }),\n\n      );\n\n  }\n\n\n  public abortPurchaseContract(contractAddress: string): Observable<string> {\n\n    // We connect to the Contract using a Provider, so we will only\n    // have read-only access to the Contract\n    const contract: Contract = new ethers.Contract(contractAddress, this.abi, this.provider.getSigner());\n\n    // based on https://docs.ethers.io/ethers.js/html/cookbook-contracts.html\n    // Call the contract method, getting back the transaction tx\n    const token = contract.abortBySeller();\n    // 'from' operator can be used to convert a promise to an observable\n    return from(token)\n      .pipe(\n        switchMap((tx: any) => {\n\n          console.log('abortBySeller Tx:', tx);\n          // Wait for transaction to be mined\n          // Returned a Promise which would resolve to the TransactionReceipt once it is mined.\n          return from(tx.wait()).pipe(\n            tap((txReceipt: any) => console.log('txReceipt: ', txReceipt)),\n\n            // The receipt will have an \"events\" Array, which will have\n            // the emitted event from the Contract. The \"LogCanceledBySeller\"\n            // is the last event.\n            map(txReceipt => txReceipt.events.pop()),\n            tap(txEvent => console.log('event: ', txEvent.event)),\n            mapTo(contractAddress),\n\n          );\n        }));\n\n  }\n\n  public confirmPurchase(contractAddress: string, etherValue: string): Observable<string> {\n\n    // We connect to the Contract using a Provider, so we will only\n    // have read-only access to the Contract\n    const contract: Contract = new ethers.Contract(contractAddress, this.abi, this.provider.getSigner());\n\n    const wei = utils.parseEther(etherValue);\n    // based on https://docs.ethers.io/ethers.js/html/cookbook-contracts.html\n    // Call the contract method, getting back the transaction tx\n    const token = contract.buyerPurchase({\n      value: wei\n    });\n\n    return from(token)\n      .pipe(\n        switchMap((tx: any) => {\n\n          console.log('buyerConfirmPurchase Tx:', tx);\n          // Wait for transaction to be mined\n          // Returned a Promise which would resolve to the TransactionReceipt once it is mined.\n          return from(tx.wait()).pipe(\n            tap((txReceipt: any) => console.log('txReceipt: ', txReceipt)),\n\n            // The receipt will have an \"events\" Array, which will have\n            // the emitted event from the Contract. The \"LogPurchaseConfirmed\"\n            // call is the last event.\n            map(txReceipt => txReceipt.events.pop()),\n            tap(txEvent => console.log('event: ', txEvent.event)),\n            mapTo(contractAddress),\n\n          );\n        }));\n  }\n\n\n  public confirmDelivery(contractAddress: string): Observable<string> {\n\n    // We connect to the Contract using a Provider, so we will only\n    // have read-only access to the Contract\n    const contract: Contract = new ethers.Contract(contractAddress, this.abi, this.provider.getSigner());\n\n    // based on https://docs.ethers.io/ethers.js/html/cookbook-contracts.html\n    // Call the contract method, getting back the transaction tx\n    const token = contract.buyerConfirmReceived();\n    return from(token)\n      .pipe(\n        switchMap((tx: any) => {\n\n          console.log('buyerConfirmReceived Tx:', tx);\n          // Wait for transaction to be mined\n          // Returned a Promise which would resolve to the TransactionReceipt once it is mined.\n          return from(tx.wait()).pipe(\n            tap((txReceipt: any) => console.log('txReceipt: ', txReceipt)),\n\n            // The receipt will have an \"events\" Array, which will have\n            // the emitted event from the Contract. The \"LogReceivedByBuyer\"\n            // call is the last event.\n            map(txReceipt => txReceipt.events.pop()),\n            tap(txEvent => console.log('event: ', txEvent.event)),\n            mapTo(contractAddress),\n\n          );\n        }));\n\n  }\n\n  public withdrawBySeller(contractAddress: string): Observable<string> {\n\n    const contract: Contract = new ethers.Contract(contractAddress, this.abi, this.provider.getSigner());\n\n    // based on https://docs.ethers.io/ethers.js/html/cookbook-contracts.html\n    // Call the contract method, getting back the transaction tx\n    const token = contract.withdrawBySeller();\n    return from(token)\n      .pipe(\n        switchMap((tx: any) => {\n\n          console.log('withdrawBySeller Tx:', tx);\n          // Wait for transaction to be mined\n          // Returned a Promise which would resolve to the TransactionReceipt once it is mined.\n          return from(tx.wait()).pipe(\n            tap((txReceipt: any) => console.log('txReceipt: ', txReceipt)),\n\n            // The receipt will have an \"events\" Array, which will have\n            // the emitted event from the Contract. The \"LogWithdrawBySeller\"\n            //  is the last event.\n            map(txReceipt => txReceipt.events.pop()),\n            // tslint:disable-next-line:max-line-length\n            tap(txEvent => console.log(`event: ${txEvent.event}, sent by: ${txEvent.args.sender}, withdrawal amount: ${txEvent.args.amount}`)),\n            map(txEvent => ethers.utils.formatEther(txEvent.args.amount))\n\n          );\n        }));\n\n  }\n\n  public withdrawByOwner(contractAddress: string): Observable<string> {\n\n    const contract: Contract = new ethers.Contract(contractAddress, this.abi, this.provider.getSigner());\n\n    // based on https://docs.ethers.io/ethers.js/html/cookbook-contracts.html\n    // Call the contract method, getting back the transaction tx\n    const token = contract.withdrawByOwner();\n    return from(token)\n      .pipe(\n        switchMap((tx: any) => {\n\n          console.log('withdrawByOwner Tx:', tx);\n          // Wait for transaction to be mined\n          // Returned a Promise which would resolve to the TransactionReceipt once it is mined.\n          return from(tx.wait()).pipe(\n            tap((txReceipt: any) => console.log('txReceipt: ', txReceipt)),\n\n            // The receipt will have an \"events\" Array, which will have\n            // the emitted event from the Contract. The \"LogWithdrawBySeller\"\n            //  is the last event.\n            map(txReceipt => txReceipt.events.pop()),\n            // tslint:disable-next-line:max-line-length\n            tap(txEvent => console.log(`event: ${txEvent.event}, sent by: ${txEvent.args.sender}, withdrawal amount: ${txEvent.args.amount}`)),\n            map(txEvent => ethers.utils.formatEther(txEvent.args.amount))\n\n          );\n        }));\n\n  }\n\n\n}\n\n\n\n\n","\nimport { Injectable, Inject } from '@angular/core';\nimport { providers } from 'ethers';\nimport { EthereumProviderToken } from '../../../core/services/tokens';\nimport { MarketPlaceAnchorModule } from '../../market-place-anchor.module';\n\n\n@Injectable({ providedIn: MarketPlaceAnchorModule })\nexport class EthersWeb3Token extends providers.Web3Provider {\n  constructor(@Inject(EthereumProviderToken) web3Provider) {\n    super(web3Provider);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Contract } from 'ethers';\nimport { EthersWeb3Token } from './ethers-web3-token';\nimport { MarketPlaceAnchorModule } from '../../market-place-anchor.module';\nimport { environment } from 'src/environments/environment';\n\nconst FLEA_MARKET_CONTRACT_ADDRESS = environment.fleaMarketContractAddress;\nconst abi = [\n  'event LogCreatePurchaseContract(address sender, bytes32 key, address contractAddress)',\n  'event LogRemovePurchaseContract(address sender, bytes32 key)',\n  'function createPurchaseContract(bytes32 key, string description, string ipfsImageHash, uint256 commissionRate) payable returns(bool createResult)',\n  'function getContractCount() view returns(uint contractCount)',\n  'function getContractKeyAtIndex(uint index) view returns(bytes32 key)',\n  'function getContractByKey(bytes32 key) view returns(address contractAddress)',\n  'function contractName() view returns(string contractName)',\n  'function removeContractByKey(bytes32 key) returns(bool result)'\n];\n\n\n@Injectable({ providedIn: MarketPlaceAnchorModule })\nexport class FleaMarketContractToken extends Contract {\n  constructor(provider: EthersWeb3Token) {\n    super(FLEA_MARKET_CONTRACT_ADDRESS, abi, provider.getSigner());\n  }\n\n}\n","\nimport * as IpfsImageActions from './ipfs-product-image.actions';\nimport * as PurchaseContractActions from './purchase-contract.actions';\n\nexport { IpfsImageActions, PurchaseContractActions};\n","\nimport { createAction, props} from '@ngrx/store';\n\nexport const reset = createAction('[IPFS/Image] Reset');  // status Pending\nexport const uploadImage = createAction('[IPFS/Image] Upload', props<{file: File}>());  // status Progress\n\nexport const uploadImageSuccess = createAction('[IPFS/Image] Upload Success', props<{ ipfsHash: string }>()); // status Success\nexport const uploadImageFail = createAction('[IPFS/Image] Upload Fail'); // status Error\nexport const downloadImage =\ncreateAction('[IPFS/Image] Download Image', props<{ ipfsHash: string }>()); // request to download image from IPFS\n\nexport const downloadImageSuccess = createAction('[IPFS/Image] Download Image Success', props<{image: Blob}>());\n\nexport const downloadImageError = createAction('[IPFS/Image] Download Image Error');\n","\nimport { createAction, props} from '@ngrx/store';\nimport { PurchaseWidgetModel, PurchaseContractModel } from '../../models';\n\nexport const createPurchaseContract = createAction('[PurchaseContract/API] Create Purchase Contract', props<{ payload: any }>());\n\nexport const createPurchaseContractSuccess =\ncreateAction('[PurchaseContract/Command] Create Purchase Contract Success', props<{ product: PurchaseWidgetModel}>());\n\n\nexport const loadProducts = createAction('[Product/API] Load Products');\nexport const loadProductsSuccess = createAction('[Product/Command] Load Products Success', props<{ products: PurchaseWidgetModel[] }>());\n\nexport const loadPurchaseContract = createAction('[PurchaseContract/API] Load Purchase Contract', props<{ address: string }>());\nexport const loadPurchaseContractSuccess =\ncreateAction('[PurchaseContract/Command] Load Purchase Contract Success', props<{ contract: PurchaseContractModel }>());\n\nexport const removePurchaseContract = createAction('[PurchaseContract/API] Remove Purchase Contract', props<{ key: string }>());\nexport const removePurchaseContractSuccess =\ncreateAction('[PurchaseContract/Command] Remove Purchase Contract Success', props<{ key: string }>());\n\nexport const abortSelectedPurchaseContract = createAction('[PurchaseContract/API] Abort Purchase Contract');\nexport const abortSelectedPurchaseContractSuccess = createAction('[PurchaseContract/Command] Abort Purchase Contract Success');\n\nexport const confirmBuy = createAction('[PurchaseContract/API] Confirm Buy', props<{ eth: string }>());\nexport const confirmBuySuccess = createAction('[PurchaseContract/Command] Confirm Buy Success');\n\nexport const confirmDelivery = createAction('[PurchaseContract/API] Confirm Product Delivery');\nexport const confirmDeliverySuccess = createAction('[PurchaseContract/Command] Confirm Product Delivery Success');\n\nexport const releaseEscrow = createAction('[PurchaseContract/API] Withdraw Escrow By Seller');\n// tslint:disable-next-line:max-line-length\nexport const releaseEscrowSuccess = createAction('[PurchaseContract/Command] Withdraw Escrow By Seller Success', props<{ amount: string }>());\n\nexport const withdrawByOwner = createAction('[PurchaseContract/API] Withdraw By Owner');\nexport const withdrawByOwnerSuccess = createAction('[PurchaseContract/Command] Withdraw By Owner Success', props<{ amount: string }>());\n\n","\nimport { Injectable } from '@angular/core';\nimport { serializeError } from 'serialize-error';\nimport { HttpClient } from '@angular/common/http';\nimport { exhaustMap, map, tap, switchMap, catchError } from 'rxjs/operators';\nimport { of, empty } from 'rxjs';\nimport { Actions, ofType, createEffect } from '@ngrx/effects';\nimport { Store, select } from '@ngrx/store';\n\nimport { IpfsDaemonService } from '../../../core/services/ipfs-daemon.services';\nimport { IpfsImageActions } from '../actions';\nimport { ErrorActions } from '../../../core/store/actions';\n\n\n\n@Injectable()\nexport class IpfsUploadEffects {\n  constructor(private ipfsSrv: IpfsDaemonService, private actions$: Actions,\n    private httpClient: HttpClient\n  ) { }\n\n\n  uploadImage$ = createEffect(\n    () =>\n      this.actions$.pipe(\n        ofType(IpfsImageActions.uploadImage),\n        map(action => action.file),\n        exhaustMap((file) => {\n\n          return this.ipfsSrv.addFile(file).pipe(\n            tap(ipfsHash => console.log(`IPFS file hash: ${ipfsHash}`)),\n            map(ipfsHash => IpfsImageActions.uploadImageSuccess({ ipfsHash })),\n\n            catchError((err: Error) =>\n              of(this.handleError(err), IpfsImageActions.uploadImageFail())\n            )\n          );\n        })\n\n      ));\n\n  downloadImage$ = createEffect(\n    () =>\n      this.actions$.pipe(\n        ofType(IpfsImageActions.downloadImage),\n        map((action) => action.ipfsHash),\n        switchMap((ipfsHash: string) =>\n          this.ipfsSrv.getFile(ipfsHash).pipe(\n            map((image: Blob) => IpfsImageActions.downloadImageSuccess({ image })),\n            catchError((err: Error) =>\n              of(this.handleError(err), IpfsImageActions.downloadImageError())\n            )\n          )\n        )\n\n      )\n  );\n\n  // display default error image\n  downloadImageError$ = createEffect(\n    () =>\n      this.actions$.pipe(\n        ofType(IpfsImageActions.downloadImageError),\n\n        switchMap(() => this.httpClient.get(`./assets/img/error-human.png`, {\n          responseType: 'blob'\n        }).pipe(\n          map((image: Blob) => IpfsImageActions.downloadImageSuccess({ image })),\n          catchError((err: Error) => of(this.handleError(err)))\n        )\n        )\n\n      )\n  );\n\n  private handleError(error: Error) {\n    const friendlyErrorMessage = serializeError(error).message;\n    return ErrorActions.errorMessage({ errorMsg: friendlyErrorMessage });\n  }\n\n}\n","\nimport { Injectable } from '@angular/core';\nimport { MatDialogConfig, MatDialog } from '@angular/material/dialog';\nimport { serializeError } from 'serialize-error';\nimport {\n  map, mapTo, tap, filter, withLatestFrom,\n  switchMap, exhaustMap, catchError, concatMap, concatMapTo\n} from 'rxjs/operators';\n\nimport { of, concat } from 'rxjs';\nimport { Actions, ofType, createEffect } from '@ngrx/effects';\nimport { Router, ActivatedRouteSnapshot } from '@angular/router';\n\nimport { FleaMarketContractService } from '../../services/flea-market-contract-service';\nimport { PurchaseContractService } from '../../services/purchase-contract-service';\n\nimport * as fromStore from '../reducers';\nimport { Store, select } from '@ngrx/store';\nimport { PurchaseContractActions } from '../actions';\nimport { ErrorActions, SpinnerActions, SnackBarActions, Web3GatewayActions } from '../../../core/store/actions';\nimport { AppearanceColor, SnackBarInterface } from '../../../core/models';\nimport { ConfirmDialogComponent } from '../../../core/components/confirm-dialog/confirm-dialog.component';\n\n\n\n@Injectable()\nexport class PurchaseContractEffects {\n  constructor(\n    private store$: Store<fromStore.AppState>,\n    private fleaSrv: FleaMarketContractService,\n    private purchaseSrv: PurchaseContractService,\n    private actions$: Actions,\n    private router: Router,\n    private dialog: MatDialog\n  ) { }\n\n\n  createProduct$ = createEffect(\n    () => this.actions$.pipe(\n      ofType(PurchaseContractActions.createPurchaseContract),\n      map(action => action.payload),\n      exhaustMap((payload) => {\n\n        return this.fleaSrv.createPurchaseContract(payload).pipe(\n          tap(address => console.log('Contract address: ', address)),\n          switchMap((address: string) => {\n\n            return [\n              PurchaseContractActions.createPurchaseContractSuccess({\n                product: {\n                  productKey: payload.productKey,\n                  contractAddress: address\n                }\n              }),\n              // update ballance\n              Web3GatewayActions.getBalance()];\n          }),\n\n          catchError((err: Error) =>\n            of(this.handleError(err), SpinnerActions.hide(), Web3GatewayActions.getBalance())\n          )\n        );\n      })\n\n    ));\n\n  loadPurchaseContract$ = createEffect(\n    () => this.actions$.pipe(\n      ofType(PurchaseContractActions.loadPurchaseContract),\n      map(action => action.address),\n      switchMap(address => {\n\n        return this.purchaseSrv.loadPurchaseContract(address).pipe(\n          map(contract =>\n            PurchaseContractActions.loadPurchaseContractSuccess({ contract })),\n          catchError((err: Error) => of(this.handleError(err), SpinnerActions.hide()))\n        );\n      })\n\n    ));\n\n\n  loadProducts$ = createEffect(() =>\n    this.actions$.pipe(\n      ofType(PurchaseContractActions.loadProducts),\n      switchMap(() =>\n\n        this.fleaSrv.getPurchaseContractList().pipe(\n          tap(products => console.log('purchase contracts:', products)),\n          map(products => PurchaseContractActions.loadProductsSuccess({ products })),\n          catchError((err: Error) => of(this.handleError(err), SpinnerActions.hide()))\n        )\n      )\n    ));\n\n\n  removeProduct$ = createEffect(\n    () =>\n      this.actions$.pipe(\n        ofType(PurchaseContractActions.removePurchaseContract),\n        map(payload => payload.key),\n        switchMap(key => {\n\n          const dialogConfig = new MatDialogConfig();\n          dialogConfig.width = '420px';\n          dialogConfig.disableClose = true;\n          dialogConfig.autoFocus = true;\n          dialogConfig.data = {\n            title: 'Confirm Remove',\n            content: `Are you sure to remove contract ${key} from market?`,\n            output: key\n          };\n\n          const dialogRef = this.dialog.open(ConfirmDialogComponent, dialogConfig);\n          // Gets an observable that is notified when the dialog is finished closing.\n          return dialogRef.afterClosed();\n        }),\n        filter(result => !!result),\n        exhaustMap(result => concat(\n\n          of(SpinnerActions.show()),\n          this.fleaSrv.removePurchaseContract(result).pipe(\n            tap(productKey => console.log(`Contract has been removed: ${productKey}`)),\n            /*\n            Related to the operators mapTo and concatMapTo. These operators map to static values.\n            Sometimes you want to map to dynamic values,\n            such as using a value passed in via an action’s payload property.\n            For dynamic values, use the matching operators map or concatMap which expect a function rather than a static value.\n            */\n            concatMap(productKey =>\n              [PurchaseContractActions.removePurchaseContractSuccess({ key: productKey }),\n              Web3GatewayActions.getBalance()]\n            ),\n            catchError((err: Error) =>\n              of(this.handleError(err), SpinnerActions.hide(), Web3GatewayActions.getBalance())\n            )\n          ),\n          of(SpinnerActions.hide()),\n        ))\n\n      ));\n\n  abortContract$ = createEffect(\n    () =>\n      this.actions$.pipe(\n        ofType(PurchaseContractActions.abortSelectedPurchaseContract),\n        withLatestFrom(this.store$.pipe(select(fromStore.getSelectedPurchaseContract))),\n        switchMap(([action, contract]) => {\n\n          const dialogConfig = new MatDialogConfig();\n          dialogConfig.width = '420px';\n          dialogConfig.disableClose = true;\n          dialogConfig.autoFocus = true;\n          dialogConfig.data = {\n            title: 'Confirm Abort',\n            content: `Are you sure you want to deactivate contract: ${contract.productKey}?`,\n            output: contract.contractAddress\n          };\n\n          const dialogRef = this.dialog.open(ConfirmDialogComponent, dialogConfig);\n          // Gets an observable that is notified when the dialog is finished closing.\n          return dialogRef.afterClosed();\n        }),\n        filter(result => !!result),\n        exhaustMap(result => concat(\n\n          of(SpinnerActions.show()),\n          this.purchaseSrv.abortPurchaseContract(result).pipe(\n            tap(address => console.log(`Successfully canceled contract: ${address} `)),\n            concatMapTo(\n              [PurchaseContractActions.abortSelectedPurchaseContractSuccess(),\n              Web3GatewayActions.getBalance()]\n            ),\n            catchError((err: Error) =>\n              of(this.handleError(err), SpinnerActions.hide(), Web3GatewayActions.getBalance())\n            )\n          ),\n          of(SpinnerActions.hide()),\n        ))\n\n      ));\n\n  confirmBuy$ = createEffect(\n    () =>\n      this.actions$.pipe(\n        ofType(PurchaseContractActions.confirmBuy),\n        withLatestFrom(this.store$.pipe(select(fromStore.getSelectedPurchaseContract))),\n        switchMap(([payload, contract]) => {\n\n          const dialogConfig = new MatDialogConfig();\n          dialogConfig.width = '420px';\n          dialogConfig.disableClose = true;\n          dialogConfig.autoFocus = true;\n          dialogConfig.data = {\n            title: 'Confirm Purchase',\n            content: `Please confirm to deposit ${payload.eth} ETH into the contract: ${contract.productKey}`,\n            output: {\n              address: contract.contractAddress,\n              eth: payload.eth\n            }\n          };\n\n          const dialogRef = this.dialog.open(ConfirmDialogComponent, dialogConfig);\n          // Gets an observable that is notified when the dialog is finished closing.\n          return dialogRef.afterClosed();\n        }),\n        filter(result => !!result),\n        exhaustMap(result => concat(\n\n          of(SpinnerActions.show()),\n          this.purchaseSrv.confirmPurchase(result.address, result.eth).pipe(\n            tap(address => console.log(`Purchase confirmed successfully for the contract: ${address} `)),\n            concatMapTo(\n              [PurchaseContractActions.confirmBuySuccess(), Web3GatewayActions.getBalance()]\n            ),\n            catchError((err: Error) => of(this.handleError(err), Web3GatewayActions.getBalance()))\n          ),\n          of(SpinnerActions.hide())\n        ))\n\n      ));\n\n  confirmDelivery$ = createEffect(\n    () =>\n      this.actions$.pipe(\n        ofType(PurchaseContractActions.confirmDelivery),\n        withLatestFrom(this.store$.pipe(select(fromStore.getSelectedPurchaseContract))),\n        switchMap(([payload, contract]) => {\n\n          const dialogConfig = new MatDialogConfig();\n          dialogConfig.width = '420px';\n          dialogConfig.disableClose = true;\n          dialogConfig.autoFocus = true;\n          dialogConfig.data = {\n            title: 'Confirm Delivery',\n            content: `Are you sure you want to confirm that you received the purchase item ${contract.description}`,\n            output: contract.contractAddress\n          };\n\n          const dialogRef = this.dialog.open(ConfirmDialogComponent, dialogConfig);\n          // Gets an observable that is notified when the dialog is finished closing.\n          return dialogRef.afterClosed();\n        }),\n        filter(result => !!result),\n        exhaustMap(result => concat(\n\n          of(SpinnerActions.show()),\n          this.purchaseSrv.confirmDelivery(result).pipe(\n            tap(address => console.log(`Delivery confirmed successfully for the contract: ${address} `)),\n            concatMapTo(\n              [PurchaseContractActions.confirmDeliverySuccess(), Web3GatewayActions.getBalance()]\n            ),\n            catchError((err: Error) =>\n              of(this.handleError(err), Web3GatewayActions.getBalance())\n            )\n          ),\n          of(SpinnerActions.hide()),\n        ))\n\n      ));\n\n  withdrawBySeller$ = createEffect(() =>\n    this.actions$.pipe(\n      ofType(PurchaseContractActions.releaseEscrow),\n      withLatestFrom(this.store$.pipe(select(fromStore.getSelectedPurchaseContract))),\n      map(([payload, contract]) => contract.contractAddress),\n      exhaustMap((address) => {\n\n        return this.purchaseSrv.withdrawBySeller(address).pipe(\n          concatMap(eth =>\n            [PurchaseContractActions.releaseEscrowSuccess({ amount: eth }),\n            Web3GatewayActions.getBalance()]\n          ),\n          catchError((err: Error) =>\n            of(this.handleError(err), SpinnerActions.hide(), Web3GatewayActions.getBalance())\n          )\n        );\n      })\n\n    ));\n\n  withdrawByOwner$ = createEffect(() =>\n    this.actions$.pipe(\n      ofType(PurchaseContractActions.withdrawByOwner),\n      withLatestFrom(this.store$.pipe(select(fromStore.getSelectedPurchaseContract))),\n      map(([payload, contract]) => contract.contractAddress),\n      exhaustMap((address) => {\n\n        return this.purchaseSrv.withdrawByOwner(address).pipe(\n          concatMap(eth =>\n            [PurchaseContractActions.withdrawByOwnerSuccess({ amount: eth }),\n            Web3GatewayActions.getBalance()]\n          ),\n          catchError((err: Error) =>\n            of(this.handleError(err), SpinnerActions.hide(), Web3GatewayActions.getBalance())\n          )\n        );\n      })\n\n    ));\n\n  removeProductRedirect$ = createEffect(\n    () =>\n      this.actions$.pipe(\n        ofType(PurchaseContractActions.removePurchaseContractSuccess),\n        tap(_ => {\n          this.router.navigate(['/market-place']);\n        })\n      ),\n    { dispatch: false }\n  );\n\n  reload$ = createEffect(\n    () =>\n      this.actions$.pipe(\n        ofType(\n          PurchaseContractActions.abortSelectedPurchaseContractSuccess,\n          PurchaseContractActions.confirmBuySuccess,\n          PurchaseContractActions.confirmDeliverySuccess,\n          PurchaseContractActions.releaseEscrowSuccess,\n          PurchaseContractActions.withdrawByOwnerSuccess),\n        withLatestFrom(this.store$.pipe(select(fromStore.getSelectedPurchaseContract))),\n        tap(async ([action, contract]) => {\n\n          // here is the trick to make  this.selectedPurchaseContract$ emit\n          // on the same route\n          // we need to reload on the same route\n          // based on https://github.com/angular/angular/issues/13831\n          this.router.routeReuseStrategy.shouldReuseRoute = () => false;\n          this.router.navigate(['/market-place/products', contract.productKey]);\n\n        })\n      ),\n    { dispatch: false }\n  );\n\n  showSpinner$ = createEffect(() =>\n    this.actions$.pipe(\n      ofType(PurchaseContractActions.createPurchaseContract,\n        PurchaseContractActions.loadProducts,\n        PurchaseContractActions.loadPurchaseContract,\n        PurchaseContractActions.releaseEscrow,\n        PurchaseContractActions.withdrawByOwner\n      ),\n      // Related to the operators mapTo and concatMapTo. These operators map to static values.\n      mapTo(SpinnerActions.show())\n    )\n  );\n\n  hideSpinner$ = createEffect(() =>\n    this.actions$.pipe(\n      ofType(PurchaseContractActions.createPurchaseContractSuccess,\n        PurchaseContractActions.loadProductsSuccess,\n        PurchaseContractActions.loadPurchaseContractSuccess,\n        PurchaseContractActions.releaseEscrowSuccess,\n        PurchaseContractActions.withdrawByOwnerSuccess\n      ),\n      mapTo(SpinnerActions.hide())\n    )\n  );\n\n  showSnackbarOnCreateContract$ = createEffect(() =>\n    this.actions$.pipe(\n      ofType(PurchaseContractActions.createPurchaseContractSuccess),\n      map((payload) => {\n\n        const msg: SnackBarInterface = {\n          message: `New smart product contract has been created successfully: Address: ${payload.product.contractAddress}`,\n          color: AppearanceColor.Success\n        };\n\n        return SnackBarActions.open({ payload: msg });\n      })\n    )\n  );\n\n  showSnackbarOnReleaseEscrow$ = createEffect(() =>\n    this.actions$.pipe(\n      ofType(PurchaseContractActions.releaseEscrowSuccess),\n      map((payload) => {\n\n        const msg: SnackBarInterface = {\n          message: `Fund in amount: ${payload.amount} ETH has been successfully release back to Seller`,\n          color: AppearanceColor.Success\n        };\n\n        return SnackBarActions.open({ payload: msg });\n      })\n    )\n  );\n\n  showSnackbarOnReceiveCommission$ = createEffect(() =>\n    this.actions$.pipe(\n      ofType(PurchaseContractActions.withdrawByOwnerSuccess),\n      map((payload) => {\n\n        const msg: SnackBarInterface = {\n          message: `Commission in amount: ${payload.amount} ETH has been successfully transferred to Owner`,\n          color: AppearanceColor.Success\n        };\n\n        return SnackBarActions.open({ payload: msg });\n      })\n    )\n  );\n\n  showSnackbarOnSuccess$ = createEffect(() =>\n    this.actions$.pipe(\n      ofType(PurchaseContractActions.abortSelectedPurchaseContractSuccess,\n        PurchaseContractActions.confirmBuySuccess,\n        PurchaseContractActions.confirmDeliverySuccess\n      ),\n      withLatestFrom(this.store$.pipe(select(fromStore.getSelectedPurchaseContract))),\n      map(([action, contract]) => {\n\n        let msg = '';\n\n        if (action.type === '[PurchaseContract/Command] Abort Purchase Contract Success') {\n          msg = `The request made by the seller to abort the contract '${contract.description}' has been confirmed!`;\n        } else if (action.type === '[PurchaseContract/Command] Confirm Buy Success') {\n          msg = `Deposit fund made by the buyer for item '${contract.description}' has been confirmed!`;\n        } else if (action.type === '[PurchaseContract/Command] Confirm Product Delivery Success') {\n          msg = `Receiving item '${contract.description}' by the buyer has been confirmed!`;\n        }\n\n        return SnackBarActions.open({\n          payload: {\n            message: msg,\n            color: AppearanceColor.Success\n          }\n        });\n      })\n    )\n  );\n\n  private handleError(error: Error) {\n    const friendlyErrorMessage = serializeError(error).message;\n    return ErrorActions.errorMessage({ errorMsg: friendlyErrorMessage });\n  }\n}\n","\nimport {\n  createSelector,\n  createFeatureSelector,\n  Action,\n  combineReducers,\n} from '@ngrx/store';\n\nimport * as fromRoot from '../../../core/store/reducers';\nimport * as fromIpfs from './ipfs-product-image.reducer';\nimport * as fromProducts from './purchase-contract.reducer';\n\n\nexport interface PurchaseContractState {\n  ipfs: fromIpfs.State;\n  products: fromProducts.State;\n}\n\n\nexport interface AppState extends fromRoot.AppState {\n  purchaseContract: PurchaseContractState;\n}\n\nexport function reducers(state: PurchaseContractState | undefined, action: Action) {\n  return combineReducers({\n    ipfs: fromIpfs.reducer,\n    products: fromProducts.reducer\n  })(state, action);\n}\n\n\nexport const selectPurchaseContractState = createFeatureSelector<AppState, PurchaseContractState>(\n  'purchaseContract'\n);\n\nexport const selectIpfsState = createSelector(selectPurchaseContractState, state => state.ipfs);\n\nexport const getIpfsUploadStatus = createSelector(selectIpfsState, fromIpfs.getIpfsUploadStatus);\nexport const getIpfsHash = createSelector(selectIpfsState, fromIpfs.getIpfsHash);\nexport const getImageBlob = createSelector(selectIpfsState, fromIpfs.getImageBlob);\n\n// ********************************************************************************\nexport const getProductEntitiesState = createSelector(selectPurchaseContractState, state => state.products);\n\n\n/**\n * Adapters created with @ngrx/entity generate\n * commonly used selector functions including\n * getting all ids in the record set, a dictionary\n * of the records by id, an array of records and\n * the total number of records. This reduces boilerplate\n * in selecting records from the entity state.\n */\nexport const {\n  selectIds: getProductKeys,\n  selectEntities: getProductEntities,\n  selectAll: getAllProducts,\n  selectTotal: getTotalProducts,\n} = fromProducts.adapter.getSelectors(getProductEntitiesState);\n\n\nexport const isProductsLoaded = createSelector(getProductEntitiesState, state => state.loaded);\nexport const getSelectedPurchaseContract = createSelector(getProductEntitiesState, state => state.selectedPurchaseContract);\n\n\n// select product widget entity based on the route param id\nexport const getSelectedProductWidget = createSelector(\n  getProductEntities,\n  fromRoot.selectRouteParams,\n  (entities, params) => params && entities[params.id]\n);\n\n\n","\nimport { createReducer, on } from '@ngrx/store';\nimport * as IpfsUploadActions from '../actions/ipfs-product-image.actions';\n\nexport enum FileUploadStatus {\n  Pending = 'Pending',\n  Success = 'Success',\n  Error = 'Error',\n  Progress = 'Progress',\n}\n\nexport interface State {\n    status: FileUploadStatus;\n    ipfsHash: string | null;\n    imageBlob?: Blob;\n}\n\nconst initialState: State = {\n    status: FileUploadStatus.Pending,\n    ipfsHash: null,\n    imageBlob: null\n};\n\nexport const reducer = createReducer(\n  initialState,\n  on(IpfsUploadActions.reset, () => initialState),\n  on(IpfsUploadActions.uploadImage, state => ({\n    ...state,\n    status: FileUploadStatus.Progress,\n  })),\n  on(IpfsUploadActions.uploadImageSuccess, (state, { ipfsHash }) => ({\n    ...state,\n    status: FileUploadStatus.Success,\n    ipfsHash\n  })),\n  on(IpfsUploadActions.uploadImageFail, state => ({\n    ...state,\n    status: FileUploadStatus.Error,\n    ipfsHash: null\n  })),\n  on(IpfsUploadActions.downloadImageSuccess, (state, { image }) => ({\n    ...state,\n    imageBlob: image\n  })),\n\n);\n\nexport const getIpfsUploadStatus = (state: State) => state.status;\nexport const getIpfsHash = (state: State) => state.ipfsHash;\nexport const getImageBlob =  (state: State) => state.imageBlob;\n","\nimport { createEntityAdapter, EntityAdapter, EntityState } from '@ngrx/entity';\nimport { createReducer, on } from '@ngrx/store';\n\nimport { PurchaseWidgetModel, PurchaseContractModel } from '../../models';\nimport { PurchaseContractActions } from '../actions';\n\n\nexport interface State extends EntityState<PurchaseWidgetModel> {\n  loaded: boolean;\n  selectedPurchaseContract: PurchaseContractModel;\n}\n\nexport function sortByKey(a: PurchaseWidgetModel, b: PurchaseWidgetModel): number {\n  return a.productKey.localeCompare(b.productKey);\n}\n\n// based on https://next.ngrx.io/guide/entity/adapter\nexport const adapter: EntityAdapter<PurchaseWidgetModel> = createEntityAdapter<PurchaseWidgetModel>({\n  selectId: (product: PurchaseWidgetModel) => product.productKey,\n  sortComparer: sortByKey,\n});\n\n\nexport const initialState: State = adapter.getInitialState({\n  loaded: false,\n  selectedPurchaseContract: null\n});\n\nexport const reducer = createReducer(\n  initialState,\n  /**\n   * based on https://blog.angular-university.io/ngrx-entity/\n   * addAll: replaces the whole collection with a new one\n   *  If the collection is to be sorted, the adapter will\n   * sort each record upon entry into the sorted array.\n   */\n  on(\n    PurchaseContractActions.loadProductsSuccess,\n    (state, { products }) => adapter.setAll(products, {\n\n      ...state,\n      loaded: true,\n      selectedPurchaseContract: null\n    })\n  ),\n  on(\n    PurchaseContractActions.removePurchaseContractSuccess,\n    (state, { key }) => adapter.removeOne(key, {\n\n      ...state,\n      selectedPurchaseContract: null\n    })\n  ),\n  /**\n   * The addOne function provided by the created adapter\n   * adds one record to the entity dictionary\n   * and returns a new state including that records if it doesn't\n   * exist already. If the collection is to be sorted, the adapter will\n   * insert the new record into the sorted array.\n   */\n  on(PurchaseContractActions.createPurchaseContractSuccess, (state, { product }) => adapter.addOne(product, state)),\n  on(PurchaseContractActions.loadPurchaseContractSuccess, (state, { contract }) => ({\n    ...state,\n    selectedPurchaseContract: contract,\n\n  })),\n\n\n);\n\n"]}