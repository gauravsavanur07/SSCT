{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{XJJU:function(module,__webpack_exports__,__webpack_require__){\"use strict\";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,\"CONTAINERS\",(function(){return CONTAINERS})),__webpack_require__.d(__webpack_exports__,\"COMPONENTS\",(function(){return COMPONENTS})),__webpack_require__.d(__webpack_exports__,\"MarketPlaceModule\",(function(){return market_place_module_MarketPlaceModule}));var ipfs_product_image_actions_namespaceObject={};__webpack_require__.r(ipfs_product_image_actions_namespaceObject),__webpack_require__.d(ipfs_product_image_actions_namespaceObject,\"reset\",(function(){return ipfs_product_image_actions_reset})),__webpack_require__.d(ipfs_product_image_actions_namespaceObject,\"uploadImage\",(function(){return uploadImage})),__webpack_require__.d(ipfs_product_image_actions_namespaceObject,\"uploadImageSuccess\",(function(){return uploadImageSuccess})),__webpack_require__.d(ipfs_product_image_actions_namespaceObject,\"uploadImageFail\",(function(){return uploadImageFail})),__webpack_require__.d(ipfs_product_image_actions_namespaceObject,\"downloadImage\",(function(){return downloadImage})),__webpack_require__.d(ipfs_product_image_actions_namespaceObject,\"downloadImageSuccess\",(function(){return downloadImageSuccess})),__webpack_require__.d(ipfs_product_image_actions_namespaceObject,\"downloadImageError\",(function(){return downloadImageError}));var purchase_contract_actions_namespaceObject={};__webpack_require__.r(purchase_contract_actions_namespaceObject),__webpack_require__.d(purchase_contract_actions_namespaceObject,\"createPurchaseContract\",(function(){return createPurchaseContract})),__webpack_require__.d(purchase_contract_actions_namespaceObject,\"createPurchaseContractSuccess\",(function(){return createPurchaseContractSuccess})),__webpack_require__.d(purchase_contract_actions_namespaceObject,\"loadProducts\",(function(){return loadProducts})),__webpack_require__.d(purchase_contract_actions_namespaceObject,\"loadProductsSuccess\",(function(){return loadProductsSuccess})),__webpack_require__.d(purchase_contract_actions_namespaceObject,\"loadPurchaseContract\",(function(){return loadPurchaseContract})),__webpack_require__.d(purchase_contract_actions_namespaceObject,\"loadPurchaseContractSuccess\",(function(){return loadPurchaseContractSuccess})),__webpack_require__.d(purchase_contract_actions_namespaceObject,\"removePurchaseContract\",(function(){return removePurchaseContract})),__webpack_require__.d(purchase_contract_actions_namespaceObject,\"removePurchaseContractSuccess\",(function(){return removePurchaseContractSuccess})),__webpack_require__.d(purchase_contract_actions_namespaceObject,\"abortSelectedPurchaseContract\",(function(){return abortSelectedPurchaseContract})),__webpack_require__.d(purchase_contract_actions_namespaceObject,\"abortSelectedPurchaseContractSuccess\",(function(){return abortSelectedPurchaseContractSuccess})),__webpack_require__.d(purchase_contract_actions_namespaceObject,\"confirmBuy\",(function(){return confirmBuy})),__webpack_require__.d(purchase_contract_actions_namespaceObject,\"confirmBuySuccess\",(function(){return confirmBuySuccess})),__webpack_require__.d(purchase_contract_actions_namespaceObject,\"confirmDelivery\",(function(){return confirmDelivery})),__webpack_require__.d(purchase_contract_actions_namespaceObject,\"confirmDeliverySuccess\",(function(){return confirmDeliverySuccess})),__webpack_require__.d(purchase_contract_actions_namespaceObject,\"releaseEscrow\",(function(){return releaseEscrow})),__webpack_require__.d(purchase_contract_actions_namespaceObject,\"releaseEscrowSuccess\",(function(){return releaseEscrowSuccess})),__webpack_require__.d(purchase_contract_actions_namespaceObject,\"withdrawByOwner\",(function(){return withdrawByOwner})),__webpack_require__.d(purchase_contract_actions_namespaceObject,\"withdrawByOwnerSuccess\",(function(){return withdrawByOwnerSuccess}));var common=__webpack_require__(\"ofXK\"),fesm2015_forms=__webpack_require__(\"3Pt+\"),shared=__webpack_require__(\"M0ag\"),fesm2015_router=__webpack_require__(\"tyNb\"),tslib_es6=__webpack_require__(\"mrSG\"),fesm2015_dialog=__webpack_require__(\"0IaG\"),tap=__webpack_require__(\"vkgz\"),ethers_min=__webpack_require__(\"5+qj\"),store=__webpack_require__(\"kt0X\"),reducers=__webpack_require__(\"Jt/G\");const ipfs_product_image_actions_reset=Object(store.o)(\"[IPFS/Image] Reset\"),uploadImage=Object(store.o)(\"[IPFS/Image] Upload\",Object(store.t)()),uploadImageSuccess=Object(store.o)(\"[IPFS/Image] Upload Success\",Object(store.t)()),uploadImageFail=Object(store.o)(\"[IPFS/Image] Upload Fail\"),downloadImage=Object(store.o)(\"[IPFS/Image] Download Image\",Object(store.t)()),downloadImageSuccess=Object(store.o)(\"[IPFS/Image] Download Image Success\",Object(store.t)()),downloadImageError=Object(store.o)(\"[IPFS/Image] Download Image Error\");var FileUploadStatus=function(FileUploadStatus){return FileUploadStatus.Pending=\"Pending\",FileUploadStatus.Success=\"Success\",FileUploadStatus.Error=\"Error\",FileUploadStatus.Progress=\"Progress\",FileUploadStatus}({});const initialState={status:FileUploadStatus.Pending,ipfsHash:null,imageBlob:null},reducer=Object(store.q)(initialState,Object(store.s)(ipfs_product_image_actions_reset,()=>initialState),Object(store.s)(uploadImage,state=>Object.assign(Object.assign({},state),{status:FileUploadStatus.Progress})),Object(store.s)(uploadImageSuccess,(state,{ipfsHash:ipfsHash})=>Object.assign(Object.assign({},state),{status:FileUploadStatus.Success,ipfsHash:ipfsHash})),Object(store.s)(uploadImageFail,state=>Object.assign(Object.assign({},state),{status:FileUploadStatus.Error,ipfsHash:null})),Object(store.s)(downloadImageSuccess,(state,{image:image})=>Object.assign(Object.assign({},state),{imageBlob:image})));var core=__webpack_require__(\"fXoL\");const DidMutate=function(){var DidMutate={EntitiesOnly:0,Both:1,None:2};return DidMutate[DidMutate.EntitiesOnly]=\"EntitiesOnly\",DidMutate[DidMutate.Both]=\"Both\",DidMutate[DidMutate.None]=\"None\",DidMutate}();function createStateOperator(mutator){return function(arg,state){const clonedEntityState={ids:[...state.ids],entities:Object.assign({},state.entities)},didMutate=mutator(arg,clonedEntityState);return didMutate===DidMutate.Both?Object.assign({},state,clonedEntityState):didMutate===DidMutate.EntitiesOnly?Object.assign(Object.assign({},state),{entities:clonedEntityState.entities}):state}}function selectIdValue(entity,selectId){const key=selectId(entity);return Object(core.W)()&&void 0===key&&console.warn(\"@ngrx/entity: The entity passed to the `selectId` implementation returned undefined.\",\"You should probably provide your own `selectId` implementation.\",\"The entity that was passed:\",entity,\"The `selectId` implementation:\",selectId.toString()),key}function createUnsortedStateAdapter(selectId){function addOneMutably(entity,state){const key=selectIdValue(entity,selectId);return key in state.entities?DidMutate.None:(state.ids.push(key),state.entities[key]=entity,DidMutate.Both)}function addManyMutably(entities,state){let didMutate=!1;for(const entity of entities)didMutate=addOneMutably(entity,state)!==DidMutate.None||didMutate;return didMutate?DidMutate.Both:DidMutate.None}function setAllMutably(entities,state){return state.ids=[],state.entities={},addManyMutably(entities,state),DidMutate.Both}function removeManyMutably(keysOrPredicate,state){const didMutate=(keysOrPredicate instanceof Array?keysOrPredicate:state.ids.filter(key=>keysOrPredicate(state.entities[key]))).filter(key=>key in state.entities).map(key=>delete state.entities[key]).length>0;return didMutate&&(state.ids=state.ids.filter(id=>id in state.entities)),didMutate?DidMutate.Both:DidMutate.None}function updateManyMutably(updates,state){const newKeys={};return(updates=updates.filter(update=>update.id in state.entities)).length>0?updates.filter(update=>function(keys,update,state){const updated=Object.assign({},state.entities[update.id],update.changes),newKey=selectIdValue(updated,selectId),hasNewKey=newKey!==update.id;return hasNewKey&&(keys[update.id]=newKey,delete state.entities[update.id]),state.entities[newKey]=updated,hasNewKey}(newKeys,update,state)).length>0?(state.ids=state.ids.map(id=>newKeys[id]||id),DidMutate.Both):DidMutate.EntitiesOnly:DidMutate.None}function upsertManyMutably(entities,state){const added=[],updated=[];for(const entity of entities){const id=selectIdValue(entity,selectId);id in state.entities?updated.push({id:id,changes:entity}):added.push(entity)}const didMutateByUpdated=updateManyMutably(updated,state),didMutateByAdded=addManyMutably(added,state);switch(!0){case didMutateByAdded===DidMutate.None&&didMutateByUpdated===DidMutate.None:return DidMutate.None;case didMutateByAdded===DidMutate.Both||didMutateByUpdated===DidMutate.Both:return DidMutate.Both;default:return DidMutate.EntitiesOnly}}return{removeAll:function(state){return Object.assign({},state,{ids:[],entities:{}})},addOne:createStateOperator(addOneMutably),addMany:createStateOperator(addManyMutably),addAll:createStateOperator(setAllMutably),setAll:createStateOperator(setAllMutably),setOne:createStateOperator((function(entity,state){const key=selectIdValue(entity,selectId);return key in state.entities?(state.entities[key]=entity,DidMutate.EntitiesOnly):(state.ids.push(key),state.entities[key]=entity,DidMutate.Both)})),updateOne:createStateOperator((function(update,state){return updateManyMutably([update],state)})),updateMany:createStateOperator(updateManyMutably),upsertOne:createStateOperator((function(entity,state){return upsertManyMutably([entity],state)})),upsertMany:createStateOperator(upsertManyMutably),removeOne:createStateOperator((function(key,state){return removeManyMutably([key],state)})),removeMany:createStateOperator(removeManyMutably),map:createStateOperator((function(map,state){return updateManyMutably(state.ids.reduce((changes,id)=>{const change=map(state.entities[id]);return change!==state.entities[id]&&changes.push({id:id,changes:change}),changes},[]).filter(({id:id})=>id in state.entities),state)}))}}const createPurchaseContract=Object(store.o)(\"[PurchaseContract/API] Create Purchase Contract\",Object(store.t)()),createPurchaseContractSuccess=Object(store.o)(\"[PurchaseContract/Command] Create Purchase Contract Success\",Object(store.t)()),loadProducts=Object(store.o)(\"[Product/API] Load Products\"),loadProductsSuccess=Object(store.o)(\"[Product/Command] Load Products Success\",Object(store.t)()),loadPurchaseContract=Object(store.o)(\"[PurchaseContract/API] Load Purchase Contract\",Object(store.t)()),loadPurchaseContractSuccess=Object(store.o)(\"[PurchaseContract/Command] Load Purchase Contract Success\",Object(store.t)()),removePurchaseContract=Object(store.o)(\"[PurchaseContract/API] Remove Purchase Contract\",Object(store.t)()),removePurchaseContractSuccess=Object(store.o)(\"[PurchaseContract/Command] Remove Purchase Contract Success\",Object(store.t)()),abortSelectedPurchaseContract=Object(store.o)(\"[PurchaseContract/API] Abort Purchase Contract\"),abortSelectedPurchaseContractSuccess=Object(store.o)(\"[PurchaseContract/Command] Abort Purchase Contract Success\"),confirmBuy=Object(store.o)(\"[PurchaseContract/API] Confirm Buy\",Object(store.t)()),confirmBuySuccess=Object(store.o)(\"[PurchaseContract/Command] Confirm Buy Success\"),confirmDelivery=Object(store.o)(\"[PurchaseContract/API] Confirm Product Delivery\"),confirmDeliverySuccess=Object(store.o)(\"[PurchaseContract/Command] Confirm Product Delivery Success\"),releaseEscrow=Object(store.o)(\"[PurchaseContract/API] Withdraw Escrow By Seller\"),releaseEscrowSuccess=Object(store.o)(\"[PurchaseContract/Command] Withdraw Escrow By Seller Success\",Object(store.t)()),withdrawByOwner=Object(store.o)(\"[PurchaseContract/API] Withdraw By Owner\"),withdrawByOwnerSuccess=Object(store.o)(\"[PurchaseContract/Command] Withdraw By Owner Success\",Object(store.t)()),adapter=function(options={}){const{selectId:selectId,sortComparer:sortComparer}=Object.assign({sortComparer:!1,selectId:instance=>instance.id},options),stateFactory={getInitialState:function(additionalState={}){return Object.assign({ids:[],entities:{}},additionalState)}},selectorsFactory={getSelectors:function(selectState){const selectIds=state=>state.ids,selectEntities=state=>state.entities,selectAll=Object(store.r)(selectIds,selectEntities,(ids,entities)=>ids.map(id=>entities[id])),selectTotal=Object(store.r)(selectIds,ids=>ids.length);return selectState?{selectIds:Object(store.r)(selectState,selectIds),selectEntities:Object(store.r)(selectState,selectEntities),selectAll:Object(store.r)(selectState,selectAll),selectTotal:Object(store.r)(selectState,selectTotal)}:{selectIds:selectIds,selectEntities:selectEntities,selectAll:selectAll,selectTotal:selectTotal}}},stateAdapter=sortComparer?function(selectId,sort){const{removeOne:removeOne,removeMany:removeMany,removeAll:removeAll}=createUnsortedStateAdapter(selectId);function addOneMutably(entity,state){return addManyMutably([entity],state)}function addManyMutably(newModels,state){const models=newModels.filter(model=>!(selectIdValue(model,selectId)in state.entities));return 0===models.length?DidMutate.None:(merge(models,state),DidMutate.Both)}function setAllMutably(models,state){return state.entities={},state.ids=[],addManyMutably(models,state),DidMutate.Both}function updateManyMutably(updates,state){const models=[],didMutateIds=updates.filter(update=>function(models,update,state){if(!(update.id in state.entities))return!1;const updated=Object.assign({},state.entities[update.id],update.changes),newKey=selectIdValue(updated,selectId);return delete state.entities[update.id],models.push(updated),newKey!==update.id}(models,update,state)).length>0;if(0===models.length)return DidMutate.None;{const originalIds=state.ids,updatedIndexes=[];return state.ids=state.ids.filter((id,index)=>id in state.entities||(updatedIndexes.push(index),!1)),merge(models,state),!didMutateIds&&updatedIndexes.every(i=>state.ids[i]===originalIds[i])?DidMutate.EntitiesOnly:DidMutate.Both}}function upsertManyMutably(entities,state){const added=[],updated=[];for(const entity of entities){const id=selectIdValue(entity,selectId);id in state.entities?updated.push({id:id,changes:entity}):added.push(entity)}const didMutateByUpdated=updateManyMutably(updated,state),didMutateByAdded=addManyMutably(added,state);switch(!0){case didMutateByAdded===DidMutate.None&&didMutateByUpdated===DidMutate.None:return DidMutate.None;case didMutateByAdded===DidMutate.Both||didMutateByUpdated===DidMutate.Both:return DidMutate.Both;default:return DidMutate.EntitiesOnly}}function merge(models,state){models.sort(sort);const ids=[];let i=0,j=0;for(;i<models.length&&j<state.ids.length;){const model=models[i],modelId=selectIdValue(model,selectId),entityId=state.ids[j];sort(model,state.entities[entityId])<=0?(ids.push(modelId),i++):(ids.push(entityId),j++)}state.ids=ids.concat(i<models.length?models.slice(i).map(selectId):state.ids.slice(j)),models.forEach((model,i)=>{state.entities[selectId(model)]=model})}return{removeOne:removeOne,removeMany:removeMany,removeAll:removeAll,addOne:createStateOperator(addOneMutably),updateOne:createStateOperator((function(update,state){return updateManyMutably([update],state)})),upsertOne:createStateOperator((function(entity,state){return upsertManyMutably([entity],state)})),addAll:createStateOperator(setAllMutably),setAll:createStateOperator(setAllMutably),setOne:createStateOperator((function(entity,state){const id=selectIdValue(entity,selectId);return id in state.entities?(state.ids=state.ids.filter(val=>val!==id),merge([entity],state),DidMutate.Both):addOneMutably(entity,state)})),addMany:createStateOperator(addManyMutably),updateMany:createStateOperator(updateManyMutably),upsertMany:createStateOperator(upsertManyMutably),map:createStateOperator((function(updatesOrMap,state){return updateManyMutably(state.ids.reduce((changes,id)=>{const change=updatesOrMap(state.entities[id]);return change!==state.entities[id]&&changes.push({id:id,changes:change}),changes},[]),state)}))}}(selectId,sortComparer):createUnsortedStateAdapter(selectId);return Object.assign(Object.assign(Object.assign({selectId:selectId,sortComparer:sortComparer},stateFactory),selectorsFactory),stateAdapter)}({selectId:product=>product.productKey,sortComparer:function(a,b){return a.productKey.localeCompare(b.productKey)}}),purchase_contract_reducer_initialState=adapter.getInitialState({loaded:!1,selectedPurchaseContract:null}),purchase_contract_reducer_reducer=Object(store.q)(purchase_contract_reducer_initialState,Object(store.s)(purchase_contract_actions_namespaceObject.loadProductsSuccess,(state,{products:products})=>adapter.setAll(products,Object.assign(Object.assign({},state),{loaded:!0,selectedPurchaseContract:null}))),Object(store.s)(purchase_contract_actions_namespaceObject.removePurchaseContractSuccess,(state,{key:key})=>adapter.removeOne(key,Object.assign(Object.assign({},state),{selectedPurchaseContract:null}))),Object(store.s)(purchase_contract_actions_namespaceObject.createPurchaseContractSuccess,(state,{product:product})=>adapter.addOne(product,state)),Object(store.s)(purchase_contract_actions_namespaceObject.loadPurchaseContractSuccess,(state,{contract:contract})=>Object.assign(Object.assign({},state),{selectedPurchaseContract:contract})));function reducers_reducers(state,action){return Object(store.m)({ipfs:reducer,products:purchase_contract_reducer_reducer})(state,action)}const selectPurchaseContractState=Object(store.p)(\"purchaseContract\"),selectIpfsState=Object(store.r)(selectPurchaseContractState,state=>state.ipfs),reducers_getIpfsUploadStatus=Object(store.r)(selectIpfsState,state=>state.status),reducers_getIpfsHash=Object(store.r)(selectIpfsState,state=>state.ipfsHash),reducers_getImageBlob=Object(store.r)(selectIpfsState,state=>state.imageBlob),getProductEntitiesState=Object(store.r)(selectPurchaseContractState,state=>state.products),{selectEntities:getProductEntities,selectAll:getAllProducts}=adapter.getSelectors(getProductEntitiesState),isProductsLoaded=Object(store.r)(getProductEntitiesState,state=>state.loaded),getSelectedPurchaseContract=Object(store.r)(getProductEntitiesState,state=>state.selectedPurchaseContract),getSelectedProductWidget=Object(store.r)(getProductEntities,reducers.j,(entities,params)=>params&&entities[params.id]);var tokens=__webpack_require__(\"659L\"),withLatestFrom=__webpack_require__(\"zp1y\"),map=__webpack_require__(\"lJxs\"),filter=__webpack_require__(\"pLZG\"),take=__webpack_require__(\"IzEk\"),fesm2015_button=__webpack_require__(\"bTqV\"),progress_spinner=__webpack_require__(\"Xa2L\");const _c0=[\"ipfsImage\"];function ShowIpfsImageComponent_div_2_Template(rf,ctx){1&rf&&core.Pb(0,\"div\")}function ShowIpfsImageComponent_ng_template_7_Template(rf,ctx){1&rf&&core.Pb(0,\"mat-progress-spinner\",7)}let show_ipfs_image_component_ShowIpfsImageComponent=(()=>{class ShowIpfsImageComponent{constructor(store$,dialogRef,windowRef){this.store$=store$,this.dialogRef=dialogRef,this.windowRef=windowRef}ngOnInit(){this.image$=this.checkStore().pipe(Object(tap.a)(blob=>this.imageRef.nativeElement.src=this.windowRef.window.URL.createObjectURL(blob)))}checkStore(){return this.store$.pipe(Object(store.u)(reducers_getImageBlob),Object(withLatestFrom.a)(this.store$.pipe(Object(store.u)(reducers_getIpfsHash))),Object(tap.a)(([image,ipfsHash])=>{image||this.store$.dispatch(downloadImage({ipfsHash:ipfsHash}))}),Object(map.a)(([image,ipfsHash])=>image),Object(filter.a)(image=>!!image),Object(take.a)(1))}}return ShowIpfsImageComponent.ɵfac=function(t){return new(t||ShowIpfsImageComponent)(core.Ob(store.h),core.Ob(fesm2015_dialog.h),core.Ob(tokens.c))},ShowIpfsImageComponent.ɵcmp=core.Ib({type:ShowIpfsImageComponent,selectors:[[\"app-show-ipfs-image\"]],viewQuery:function(rf,ctx){var _t;1&rf&&core.yc(_c0,!0),2&rf&&core.rc(_t=core.dc())&&(ctx.imageRef=_t.first)},decls:12,vars:5,consts:[[\"mat-dialog-title\",\"\"],[4,\"ngIf\",\"ngIfElse\"],[1,\"text-center\"],[\"height\",\"300px\",\"width\",\"300px\"],[\"ipfsImage\",\"\"],[\"loading\",\"\"],[\"mat-stroked-button\",\"\",\"color\",\"warn\",\"cdkFocusInitial\",\"\",3,\"mat-dialog-close\"],[\"color\",\"warn\",\"mode\",\"indeterminate\",\"value\",\"50\",\"diameter\",\"100\",\"strokeWidth\",\"10\"]],template:function(rf,ctx){if(1&rf&&(core.Ub(0,\"h2\",0),core.Cc(1,\"IPFS Product Image\"),core.Tb(),core.Ac(2,ShowIpfsImageComponent_div_2_Template,1,0,\"div\",1),core.hc(3,\"async\"),core.Ub(4,\"mat-dialog-content\",2),core.Pb(5,\"img\",3,4),core.Ac(7,ShowIpfsImageComponent_ng_template_7_Template,1,0,\"ng-template\",null,5,core.Bc),core.Tb(),core.Ub(9,\"mat-dialog-actions\"),core.Ub(10,\"button\",6),core.Cc(11,\"OK\"),core.Tb(),core.Tb()),2&rf){const _r2=core.sc(8);core.Cb(2),core.lc(\"ngIf\",core.ic(3,3,ctx.image$))(\"ngIfElse\",_r2),core.Cb(8),core.lc(\"mat-dialog-close\",!0)}},directives:[fesm2015_dialog.i,common.k,fesm2015_dialog.f,fesm2015_dialog.c,fesm2015_button.b,fesm2015_dialog.d,progress_spinner.a],pipes:[common.b],styles:[\"\"],changeDetection:0}),ShowIpfsImageComponent})();var chips=__webpack_require__(\"A5z7\"),flex=__webpack_require__(\"XiUz\"),card=__webpack_require__(\"Wp6s\"),form_field=__webpack_require__(\"kmnG\"),input=__webpack_require__(\"qFsG\"),fesm2015_select=__webpack_require__(\"d3UM\"),icon=__webpack_require__(\"NFeN\"),fesm2015_core=__webpack_require__(\"FKr1\"),tooltip=__webpack_require__(\"Qu3c\");const new_purchase_contract_component_c0=[\"file\"];function NewPurchaseContractComponent_mat_error_15_Template(rf,ctx){1&rf&&(core.Ub(0,\"mat-error\"),core.Cc(1,\"Value is required\"),core.Tb())}function NewPurchaseContractComponent_mat_error_16_Template(rf,ctx){1&rf&&(core.Ub(0,\"mat-error\"),core.Cc(1,\" Invalid product key string. Must be less than 32 bytes\"),core.Tb())}function NewPurchaseContractComponent_mat_error_20_Template(rf,ctx){1&rf&&(core.Ub(0,\"mat-error\"),core.Cc(1,\"Value is required\"),core.Tb())}function NewPurchaseContractComponent_mat_error_26_Template(rf,ctx){1&rf&&(core.Ub(0,\"mat-error\"),core.Cc(1,\"Value is required\"),core.Tb())}function NewPurchaseContractComponent_mat_error_27_Template(rf,ctx){1&rf&&(core.Ub(0,\"mat-error\"),core.Cc(1,\"Invalid ether value format. Has to be (#.###)\"),core.Tb())}function NewPurchaseContractComponent_mat_option_30_Template(rf,ctx){if(1&rf&&(core.Ub(0,\"mat-option\",23),core.Cc(1),core.Tb()),2&rf){const item_r10=ctx.$implicit;core.lc(\"value\",item_r10),core.Cb(1),core.Ec(\" \",item_r10,\" \")}}function NewPurchaseContractComponent_mat_error_32_Template(rf,ctx){1&rf&&(core.Ub(0,\"mat-error\"),core.Cc(1,\"Value is required\"),core.Tb())}function NewPurchaseContractComponent_button_40_Template(rf,ctx){if(1&rf){const _r12=core.Vb();core.Ub(0,\"button\",24),core.cc(\"click\",(function(){return core.uc(_r12),core.gc().uploadFile()})),core.Cc(1,\" Upload To IPFS \"),core.Ub(2,\"mat-icon\"),core.Cc(3,\"offline_bolt\"),core.Tb(),core.Tb()}if(2&rf){const ctx_r8=core.gc();core.lc(\"disabled\",ctx_r8.formControl(\"fileArg\").invalid)}}function NewPurchaseContractComponent_mat_card_content_41_ng_container_10_Template(rf,ctx){1&rf&&core.Qb(0)}function NewPurchaseContractComponent_mat_card_content_41_ng_template_11_mat_error_1_Template(rf,ctx){1&rf&&(core.Ub(0,\"mat-error\",34),core.Cc(1,\"You must choose a file\"),core.Tb())}function NewPurchaseContractComponent_mat_card_content_41_ng_template_11_mat_error_2_Template(rf,ctx){1&rf&&(core.Ub(0,\"mat-error\",34),core.Cc(1,\"Invalid file image extension\"),core.Tb())}function NewPurchaseContractComponent_mat_card_content_41_ng_template_11_Template(rf,ctx){if(1&rf&&(core.Ub(0,\"div\",25),core.Ac(1,NewPurchaseContractComponent_mat_card_content_41_ng_template_11_mat_error_1_Template,2,0,\"mat-error\",33),core.Ac(2,NewPurchaseContractComponent_mat_card_content_41_ng_template_11_mat_error_2_Template,2,0,\"mat-error\",33),core.Tb()),2&rf){const ctx_r15=core.gc(2);core.Cb(1),core.lc(\"ngIf\",ctx_r15.requiredFile(\"fileArg\")),core.Cb(1),core.lc(\"ngIf\",ctx_r15.invalidPatternFile(\"fileArg\"))}}function NewPurchaseContractComponent_mat_card_content_41_ng_template_13_Template(rf,ctx){if(1&rf&&(core.Ub(0,\"div\",25),core.Pb(1,\"img\",35),core.Ub(2,\"p\"),core.Cc(3),core.Tb(),core.Tb()),2&rf){const ctx_r17=core.gc(2);core.Cb(1),core.lc(\"src\",ctx_r17.fileContent,core.vc),core.Cb(2),core.Ec(\" \",ctx_r17.fileBlob.name,\" \")}}function NewPurchaseContractComponent_mat_card_content_41_div_16_Template(rf,ctx){if(1&rf){const _r24=core.Vb();core.Ub(0,\"div\",36),core.Ub(1,\"button\",37),core.cc(\"click\",(function(){return core.uc(_r24),core.gc(2).loadImage()})),core.Cc(2),core.Ub(3,\"mat-icon\"),core.Cc(4,\"visibility\"),core.Tb(),core.Tb(),core.Tb()}if(2&rf){const ipfsHash_r22=ctx.ngIf;core.Cb(2),core.Ec(\" \",ipfsHash_r22,\" \")}}function NewPurchaseContractComponent_mat_card_content_41_div_19_div_1_Template(rf,ctx){1&rf&&(core.Ub(0,\"div\"),core.Pb(1,\"mat-progress-spinner\",40),core.Tb())}function NewPurchaseContractComponent_mat_card_content_41_div_19_ng_template_2_mat_chip_0_Template(rf,ctx){if(1&rf&&(core.Ub(0,\"mat-chip\"),core.Cc(1),core.Tb()),2&rf){const status_r25=core.gc(2).ngIf;core.Cb(1),core.Dc(status_r25)}}function NewPurchaseContractComponent_mat_card_content_41_div_19_ng_template_2_mat_chip_1_Template(rf,ctx){if(1&rf&&(core.Ub(0,\"mat-chip\",43),core.Cc(1),core.Tb()),2&rf){const status_r25=core.gc(2).ngIf;core.Cb(1),core.Ec(\" \",status_r25,\" \")}}function NewPurchaseContractComponent_mat_card_content_41_div_19_ng_template_2_mat_chip_2_Template(rf,ctx){if(1&rf&&(core.Ub(0,\"mat-chip\",44),core.Cc(1),core.Tb()),2&rf){const status_r25=core.gc(2).ngIf;core.Cb(1),core.Ec(\" \",status_r25,\" \")}}function NewPurchaseContractComponent_mat_card_content_41_div_19_ng_template_2_Template(rf,ctx){if(1&rf&&(core.Ac(0,NewPurchaseContractComponent_mat_card_content_41_div_19_ng_template_2_mat_chip_0_Template,2,1,\"mat-chip\",9),core.Ac(1,NewPurchaseContractComponent_mat_card_content_41_div_19_ng_template_2_mat_chip_1_Template,2,1,\"mat-chip\",41),core.Ac(2,NewPurchaseContractComponent_mat_card_content_41_div_19_ng_template_2_mat_chip_2_Template,2,1,\"mat-chip\",42)),2&rf){const status_r25=core.gc().ngIf,ctx_r28=core.gc(2);core.lc(\"ngIf\",ctx_r28.isPending(status_r25)),core.Cb(1),core.lc(\"ngIf\",ctx_r28.isSuccess(status_r25)),core.Cb(1),core.lc(\"ngIf\",ctx_r28.isError(status_r25))}}function NewPurchaseContractComponent_mat_card_content_41_div_19_Template(rf,ctx){if(1&rf&&(core.Ub(0,\"div\"),core.Ac(1,NewPurchaseContractComponent_mat_card_content_41_div_19_div_1_Template,2,0,\"div\",38),core.Ac(2,NewPurchaseContractComponent_mat_card_content_41_div_19_ng_template_2_Template,3,3,\"ng-template\",null,39,core.Bc),core.Tb()),2&rf){const status_r25=ctx.ngIf,_r27=core.sc(3),ctx_r19=core.gc(2);core.Cb(1),core.lc(\"ngIf\",ctx_r19.inProgress(status_r25))(\"ngIfElse\",_r27)}}function NewPurchaseContractComponent_mat_card_content_41_Template(rf,ctx){if(1&rf&&(core.Ub(0,\"mat-card-content\"),core.Ub(1,\"div\",6),core.Ub(2,\"div\",25),core.Cc(3,\"Image\"),core.Tb(),core.Ub(4,\"div\",26),core.Cc(5,\"IPFS Hash\"),core.Tb(),core.Ub(6,\"div\",27),core.Cc(7,\"Upload Status\"),core.Tb(),core.Tb(),core.Pb(8,\"p\"),core.Ub(9,\"div\",6),core.Ac(10,NewPurchaseContractComponent_mat_card_content_41_ng_container_10_Template,1,0,\"ng-container\",28),core.Ac(11,NewPurchaseContractComponent_mat_card_content_41_ng_template_11_Template,3,2,\"ng-template\",null,29,core.Bc),core.Ac(13,NewPurchaseContractComponent_mat_card_content_41_ng_template_13_Template,4,2,\"ng-template\",null,30,core.Bc),core.Ub(15,\"div\",31),core.Ac(16,NewPurchaseContractComponent_mat_card_content_41_div_16_Template,5,1,\"div\",32),core.hc(17,\"async\"),core.Tb(),core.Ub(18,\"div\",27),core.Ac(19,NewPurchaseContractComponent_mat_card_content_41_div_19_Template,4,2,\"div\",9),core.hc(20,\"async\"),core.Tb(),core.Tb(),core.Tb()),2&rf){const _r14=core.sc(12),_r16=core.sc(14),ctx_r9=core.gc();core.Cb(10),core.lc(\"ngIf\",ctx_r9.formControl(\"fileArg\").invalid)(\"ngIfThen\",_r14)(\"ngIfElse\",_r16),core.Cb(6),core.lc(\"ngIf\",core.ic(17,5,ctx_r9.ipfsHash$)),core.Cb(3),core.lc(\"ngIf\",core.ic(20,7,ctx_r9.uploadStatus$))}}function bites32StringValidator(control){let pathTest=!1;try{ethers_min.utils.formatBytes32String(control.value),pathTest=!0}catch(error){}return pathTest?null:{forbiddenKey:{value:control.value}}}let new_purchase_contract_component_NewPurchaseContractComponent=(()=>{class NewPurchaseContractComponent{constructor(store$,formBuilder,dialog){this.store$=store$,this.formBuilder=formBuilder,this.dialog=dialog,this.IMAGE_PATTERN=/^.+\\.(png|jpg|jpeg|gif|png)$/,this.commissions=[\"1.0\",\"2.0\",\"3.0\",\"4.0\",\"5.0\"],this.frmGroup=this.formBuilder.group({productKey:[\"\",[fesm2015_forms.p.required,bites32StringValidator]],description:[\"\",fesm2015_forms.p.required],etherValue:[\"\",[fesm2015_forms.p.required,fesm2015_forms.p.pattern(/^\\d+(\\.\\d{1,3})?$/)]],commission:[\"\",fesm2015_forms.p.required],fileArg:[\"\",[fesm2015_forms.p.required,fesm2015_forms.p.pattern(this.IMAGE_PATTERN)]],ipfsHash:[\"\",fesm2015_forms.p.required]}),this.formControl=name=>this.frmGroup.get(\"\"+name),this.required=name=>this.formControl(name).hasError(\"required\")&&this.formControl(name).touched,this.invalidPattern=name=>this.formControl(name).hasError(\"pattern\")&&this.formControl(name).dirty,this.invalid32BytesKey=name=>this.formControl(name).hasError(\"forbiddenKey\")&&this.formControl(name).dirty,this.requiredFile=name=>this.formControl(name).hasError(\"required\"),this.invalidPatternFile=name=>this.formControl(name).hasError(\"pattern\"),this.isPending=status=>status===FileUploadStatus.Pending,this.isSuccess=status=>status===FileUploadStatus.Success,this.isError=status=>status===FileUploadStatus.Error,this.inProgress=status=>status===FileUploadStatus.Progress}ngOnInit(){this.uploadStatus$=this.store$.pipe(Object(store.u)(reducers_getIpfsUploadStatus)),this.ipfsHash$=this.store$.pipe(Object(store.u)(reducers_getIpfsHash),Object(tap.a)(value=>this.frmGroup.get(\"ipfsHash\").patchValue(value)))}selectFile(){this.fileControl.nativeElement.click()}onFileChange(event){if(event.target.files&&event.target.files.length){this.fileBlob=event.target.files[0],this.frmGroup.get(\"fileArg\").patchValue(this.fileBlob.name);const reader=new FileReader;reader.readAsDataURL(this.fileBlob),reader.onload=_=>{this.fileContent=reader.result,this.store$.dispatch(ipfs_product_image_actions_namespaceObject.reset())}}}uploadFile(){this.store$.dispatch(ipfs_product_image_actions_namespaceObject.uploadImage({file:this.fileBlob}))}loadImage(){const dialogConfig=new fesm2015_dialog.e;dialogConfig.width=\"460px\",dialogConfig.disableClose=!0,dialogConfig.autoFocus=!0,this.dialog.open(show_ipfs_image_component_ShowIpfsImageComponent,dialogConfig)}onCreate(){const{valid:valid}=this.frmGroup;if(valid){const _a=this.frmGroup.value,model=Object(tslib_es6.c)(_a,[\"fileArg\"]);this.store$.dispatch(purchase_contract_actions_namespaceObject.createPurchaseContract({payload:model}))}}ngOnDestroy(){this.store$.dispatch(ipfs_product_image_actions_namespaceObject.reset())}}return NewPurchaseContractComponent.ɵfac=function(t){return new(t||NewPurchaseContractComponent)(core.Ob(store.h),core.Ob(fesm2015_forms.c),core.Ob(fesm2015_dialog.b))},NewPurchaseContractComponent.ɵcmp=core.Ib({type:NewPurchaseContractComponent,selectors:[[\"app-new-purchase-contract\"]],viewQuery:function(rf,ctx){var _t;1&rf&&core.Gc(new_purchase_contract_component_c0,!0),2&rf&&core.rc(_t=core.dc())&&(ctx.fileControl=_t.first)},decls:45,vars:15,consts:[[\"fxLayout\",\"row\",\"fxLayoutAlign\",\"center start\"],[\"fxFlex\",\"60\"],[\"novalidate\",\"\",3,\"formGroup\"],[\"fxLayout\",\"row\",\"fxLayoutGap\",\"6px\"],[1,\"red-color\"],[1,\"mat-caption\",\"text-muted\"],[\"fxLayout\",\"row\",\"fxLayoutAlign\",\"start center\"],[\"fxFlex\",\"\",3,\"color\"],[\"matInput\",\"\",\"placeholder\",\"Unique Product Key *\",\"formControlName\",\"productKey\"],[4,\"ngIf\"],[\"matInput\",\"\",\"placeholder\",\"Description *\",\"formControlName\",\"description\"],[\"fxFlex\",\"45\",3,\"color\"],[\"matInput\",\"\",\"placeholder\",\"Value in ether. Has to include 2x price *\",\"formControlName\",\"etherValue\"],[\"matSuffix\",\"\"],[\"fxFlex\",\"45\",\"fxFlexOffset\",\"40px\",3,\"color\"],[\"placeholder\",\"Quantity *\",\"formControlName\",\"commission\"],[3,\"value\",4,\"ngFor\",\"ngForOf\"],[\"type\",\"file\",2,\"display\",\"none\",3,\"change\"],[\"file\",\"\"],[\"mat-raised-button\",\"\",\"color\",\"primary\",3,\"click\"],[\"mat-raised-button\",\"\",\"color\",\"accent\",3,\"disabled\",\"click\",4,\"ngIf\"],[\"fxLayout\",\"row\",\"fxLayoutAlign\",\"end center\"],[\"mat-flat-button\",\"\",\"color\",\"warn\",1,\"margin-right--10\",3,\"disabled\",\"click\"],[3,\"value\"],[\"mat-raised-button\",\"\",\"color\",\"accent\",3,\"disabled\",\"click\"],[\"fxFlex\",\"25\",1,\"text-center\"],[\"fxFlex\",\"\",1,\"text-center\"],[\"fxFlex\",\"15\",1,\"text-center\"],[4,\"ngIf\",\"ngIfThen\",\"ngIfElse\"],[\"showError\",\"\"],[\"showImage\",\"\"],[\"fxFlex\",\"\"],[\"class\",\"text-center\",4,\"ngIf\"],[\"mat-line\",\"\",4,\"ngIf\"],[\"mat-line\",\"\"],[\"height\",\"200\",\"width\",\"200\",3,\"src\"],[1,\"text-center\"],[\"mat-stroked-button\",\"\",\"color\",\"warn\",\"matTooltip\",\"Click to show image from IPFS\",3,\"click\"],[4,\"ngIf\",\"ngIfElse\"],[\"idle\",\"\"],[\"color\",\"warn\",\"mode\",\"indeterminate\",\"value\",\"50\",\"diameter\",\"50\",\"strokeWidth\",\"5\"],[\"selected\",\"true\",\"color\",\"accent\",4,\"ngIf\"],[\"selected\",\"true\",\"color\",\"warn\",4,\"ngIf\"],[\"selected\",\"true\",\"color\",\"accent\"],[\"selected\",\"true\",\"color\",\"warn\"]],template:function(rf,ctx){1&rf&&(core.Pb(0,\"mat-chip-list\"),core.Ub(1,\"div\",0),core.Ub(2,\"mat-card\",1),core.Ub(3,\"mat-card-subtitle\"),core.Cc(4,\" Add Inventory \"),core.Tb(),core.Ub(5,\"form\",2),core.Ub(6,\"mat-card-content\"),core.Ub(7,\"div\",3),core.Ub(8,\"span\",4),core.Cc(9,\"*\"),core.Tb(),core.Ub(10,\"div\",5),core.Cc(11,\"required fields\"),core.Tb(),core.Tb(),core.Ub(12,\"div\",6),core.Ub(13,\"mat-form-field\",7),core.Pb(14,\"input\",8),core.Ac(15,NewPurchaseContractComponent_mat_error_15_Template,2,0,\"mat-error\",9),core.Ac(16,NewPurchaseContractComponent_mat_error_16_Template,2,0,\"mat-error\",9),core.Tb(),core.Tb(),core.Ub(17,\"div\",6),core.Ub(18,\"mat-form-field\",7),core.Pb(19,\"input\",10),core.Ac(20,NewPurchaseContractComponent_mat_error_20_Template,2,0,\"mat-error\",9),core.Tb(),core.Tb(),core.Ub(21,\"div\",6),core.Ub(22,\"mat-form-field\",11),core.Pb(23,\"input\",12),core.Ub(24,\"span\",13),core.Cc(25,\"$ETH\"),core.Tb(),core.Ac(26,NewPurchaseContractComponent_mat_error_26_Template,2,0,\"mat-error\",9),core.Ac(27,NewPurchaseContractComponent_mat_error_27_Template,2,0,\"mat-error\",9),core.Tb(),core.Ub(28,\"mat-form-field\",14),core.Ub(29,\"mat-select\",15),core.Ac(30,NewPurchaseContractComponent_mat_option_30_Template,2,2,\"mat-option\",16),core.Tb(),core.Pb(31,\"span\",13),core.Ac(32,NewPurchaseContractComponent_mat_error_32_Template,2,0,\"mat-error\",9),core.Tb(),core.Tb(),core.Tb(),core.Ub(33,\"input\",17,18),core.cc(\"change\",(function($event){return ctx.onFileChange($event)})),core.Tb(),core.Ub(35,\"mat-card-actions\"),core.Ub(36,\"button\",19),core.cc(\"click\",(function(){return ctx.selectFile()})),core.Cc(37,\" Product Image \"),core.Ub(38,\"mat-icon\"),core.Cc(39,\"category\"),core.Tb(),core.Tb(),core.Ac(40,NewPurchaseContractComponent_button_40_Template,4,1,\"button\",20),core.Tb(),core.Ac(41,NewPurchaseContractComponent_mat_card_content_41_Template,21,9,\"mat-card-content\",9),core.Ub(42,\"mat-card-actions\",21),core.Ub(43,\"button\",22),core.cc(\"click\",(function(){return ctx.onCreate()})),core.Cc(44,\"Add Product\"),core.Tb(),core.Tb(),core.Tb(),core.Tb(),core.Tb()),2&rf&&(core.Cb(5),core.lc(\"formGroup\",ctx.frmGroup),core.Cb(8),core.lc(\"color\",\"accent\"),core.Cb(2),core.lc(\"ngIf\",ctx.required(\"productKey\")),core.Cb(1),core.lc(\"ngIf\",ctx.invalid32BytesKey(\"productKey\")),core.Cb(2),core.lc(\"color\",\"accent\"),core.Cb(2),core.lc(\"ngIf\",ctx.required(\"description\")),core.Cb(2),core.lc(\"color\",\"accent\"),core.Cb(4),core.lc(\"ngIf\",ctx.required(\"etherValue\")),core.Cb(1),core.lc(\"ngIf\",ctx.invalidPattern(\"etherValue\")),core.Cb(1),core.lc(\"color\",\"accent\"),core.Cb(2),core.lc(\"ngForOf\",ctx.commissions),core.Cb(2),core.lc(\"ngIf\",ctx.required(\"description\")),core.Cb(8),core.lc(\"ngIf\",ctx.fileBlob),core.Cb(1),core.lc(\"ngIf\",ctx.fileBlob),core.Cb(2),core.lc(\"disabled\",ctx.frmGroup.pristine||ctx.frmGroup.invalid))},directives:[chips.b,flex.d,flex.c,card.a,flex.a,card.f,fesm2015_forms.q,fesm2015_forms.l,fesm2015_forms.g,card.c,flex.e,form_field.c,input.b,fesm2015_forms.b,fesm2015_forms.k,fesm2015_forms.f,common.k,form_field.h,flex.b,fesm2015_select.a,common.j,card.b,fesm2015_button.b,icon.a,form_field.b,fesm2015_core.n,fesm2015_core.j,tooltip.a,progress_spinner.a,chips.a],pipes:[common.b],styles:[\".spiner-section-200[_ngcontent-%COMP%]{width:200px}.margin-right--10[_ngcontent-%COMP%]{margin-right:10px!important}\"]}),NewPurchaseContractComponent})();var fromEvent=__webpack_require__(\"xgIS\"),combineLatest=__webpack_require__(\"itXk\"),startWith=__webpack_require__(\"JX91\"),debounceTime=__webpack_require__(\"Kj3r\"),distinctUntilChanged=__webpack_require__(\"/uUt\"),list=__webpack_require__(\"MutI\"),divider=__webpack_require__(\"f0Cb\");function PurchaseContractListComponent_mat_list_item_1_Template(rf,ctx){if(1&rf){const _r3=core.Vb();core.Ub(0,\"mat-list-item\",1),core.cc(\"click\",(function(){core.uc(_r3);const product_r1=ctx.$implicit;return core.gc().selectMe.emit(product_r1)})),core.Pb(1,\"img\",2),core.Ub(2,\"h3\",3),core.Cc(3),core.Tb(),core.Pb(4,\"mat-divider\"),core.Tb()}if(2&rf){const product_r1=ctx.$implicit;core.Cb(3),core.Dc(product_r1.productKey)}}let purchase_contract_list_component_PurchaseContractListComponent=(()=>{class PurchaseContractListComponent{constructor(){this.selectMe=new core.o}}return PurchaseContractListComponent.ɵfac=function(t){return new(t||PurchaseContractListComponent)},PurchaseContractListComponent.ɵcmp=core.Ib({type:PurchaseContractListComponent,selectors:[[\"app-purchase-contract-list\"]],inputs:{products:\"products\"},outputs:{selectMe:\"selectMe\"},decls:2,vars:1,consts:[[3,\"click\",4,\"ngFor\",\"ngForOf\"],[3,\"click\"],[\"matListAvatar\",\"\",\"src\",\"../../../../assets/img/purchase-contract.png\"],[\"mat-line\",\"\",1,\"mat-h3\"]],template:function(rf,ctx){1&rf&&(core.Ub(0,\"mat-list\"),core.Ac(1,PurchaseContractListComponent_mat_list_item_1_Template,5,1,\"mat-list-item\",0),core.Tb()),2&rf&&(core.Cb(1),core.lc(\"ngForOf\",ctx.products))},directives:[list.a,common.j,list.c,list.b,fesm2015_core.j,divider.a],styles:[\"mat-list[_ngcontent-%COMP%] {\\n      position: relative;\\n      max-height: 420px;\\n      overflow: auto;\\n      }\",\"mat-list-item[_ngcontent-%COMP%] {\\n      cursor: pointer;\\n      }\\n\\n    mat-list-item[_ngcontent-%COMP%]:hover {\\n      box-shadow: 3px 3px 12px -2px rgba(0, 0, 0, 0.5);\\n    }\"]}),PurchaseContractListComponent})();const view_product_collection_component_c0=[\"contractKey\"];function ViewProductCollectionComponent_p_15_Template(rf,ctx){1&rf&&(core.Ub(0,\"p\"),core.Cc(1,\" No Products to Show \"),core.Tb())}let view_product_collection_component_ViewProductCollectionComponent=(()=>{class ViewProductCollectionComponent{constructor(store$,router){this.store$=store$,this.router=router}ngAfterViewInit(){const products$=this.store$.pipe(Object(store.u)(getAllProducts)),filter$=Object(fromEvent.a)(this.contractKey.nativeElement,\"keyup\").pipe(Object(map.a)(event=>this.contractKey.nativeElement.value),Object(startWith.a)(\"\"),Object(debounceTime.a)(150),Object(distinctUntilChanged.a)());this.filteredProducts$=Object(combineLatest.a)([products$,filter$]).pipe(Object(map.a)(([products,filterString])=>products.filter(product=>-1!==product.productKey.indexOf(filterString)))),setTimeout(()=>{this.contractKey.nativeElement.focus()},150)}selectPurchaseContract(product){this.router.navigate([\"market-place/products\",product.productKey])}ngOnInit(){}}return ViewProductCollectionComponent.ɵfac=function(t){return new(t||ViewProductCollectionComponent)(core.Ob(store.h),core.Ob(fesm2015_router.e))},ViewProductCollectionComponent.ɵcmp=core.Ib({type:ViewProductCollectionComponent,selectors:[[\"app-view-product-collection\"]],viewQuery:function(rf,ctx){var _t;1&rf&&core.Gc(view_product_collection_component_c0,!0),2&rf&&core.rc(_t=core.dc())&&(ctx.contractKey=_t.first)},decls:21,vars:6,consts:[[\"fxLayout\",\"row\",\"fxLayoutAlign\",\"center stretch\",\"fxLayoutGap\",\"16px\"],[\"fxFlex\",\"50\"],[\"fxLayout\",\"row\",\"fxLayoutAlign\",\"space-between center\"],[\"color\",\"accent\",\"fxFlex\",\"40\"],[\"matInput\",\"\",\"placeholder\",\"Search for contact by key\"],[\"contractKey\",\"\"],[\"mat-mini-fab\",\"\",\"color\",\"warn\",\"routerLink\",\"./make/new\",\"matTooltip\",\"create new contract\",\"matTooltipPosition\",\"left\",2,\"margin-right\",\"20px\"],[3,\"products\",\"selectMe\"],[4,\"ngIf\"]],template:function(rf,ctx){if(1&rf&&(core.Ub(0,\"div\",0),core.Ub(1,\"mat-card\",1),core.Ub(2,\"mat-card-subtitle\"),core.Cc(3,\"Inventory List\"),core.Tb(),core.Ub(4,\"mat-card-content\",2),core.Ub(5,\"mat-form-field\",3),core.Pb(6,\"input\",4,5),core.Tb(),core.Ub(8,\"div\"),core.Ub(9,\"a\",6),core.Ub(10,\"mat-icon\"),core.Cc(11,\"Add\"),core.Tb(),core.Tb(),core.Tb(),core.Tb(),core.Ub(12,\"mat-card-content\"),core.Ub(13,\"app-purchase-contract-list\",7),core.cc(\"selectMe\",(function($event){return ctx.selectPurchaseContract($event)})),core.hc(14,\"async\"),core.Tb(),core.Ac(15,ViewProductCollectionComponent_p_15_Template,2,0,\"p\",8),core.hc(16,\"async\"),core.Tb(),core.Tb(),core.Ub(17,\"mat-card\",1),core.Ub(18,\"mat-card-subtitle\"),core.Cc(19,\"Product Details\"),core.Tb(),core.Pb(20,\"router-outlet\"),core.Tb(),core.Tb()),2&rf){var tmp_1_0;const currVal_1=0===(null==(tmp_1_0=core.ic(16,4,ctx.filteredProducts$))?null:tmp_1_0.length);core.Cb(13),core.lc(\"products\",core.ic(14,2,ctx.filteredProducts$)),core.Cb(2),core.lc(\"ngIf\",currVal_1)}},directives:[flex.d,flex.c,flex.e,card.a,flex.a,card.f,card.c,form_field.c,input.b,fesm2015_button.a,fesm2015_router.h,tooltip.a,icon.a,purchase_contract_list_component_PurchaseContractListComponent,common.k,fesm2015_router.j],pipes:[common.b],encapsulation:2,changeDetection:0}),ViewProductCollectionComponent})();var switchMap=__webpack_require__(\"eIep\"),Subject=__webpack_require__(\"XNiG\"),ContractState=function(ContractState){return ContractState[ContractState.Created=0]=\"Created\",ContractState[ContractState.Locked=1]=\"Locked\",ContractState[ContractState.Canceled=2]=\"Canceled\",ContractState[ContractState.ItemReceived=3]=\"ItemReceived\",ContractState[ContractState.SellerPaid=4]=\"SellerPaid\",ContractState[ContractState.OwnerPaid=5]=\"OwnerPaid\",ContractState[ContractState.Completed=6]=\"Completed\",ContractState}({});const purchase_contract_detail_component_c0=[\"ipfsImage\"];function PurchaseContractDetailComponent_ng_container_0_Template(rf,ctx){1&rf&&core.Qb(0)}function PurchaseContractDetailComponent_ng_template_1_mat_list_item_40_Template(rf,ctx){1&rf&&(core.Ub(0,\"mat-list-item\"),core.Ub(1,\"h3\",10),core.Cc(2,\"Supplier Address\"),core.Tb(),core.Ub(3,\"span\"),core.Cc(4,\"Buyer Contract Present in Smart Contract\"),core.Tb(),core.Tb())}function PurchaseContractDetailComponent_ng_template_1_mat_list_item_41_Template(rf,ctx){if(1&rf&&(core.Ub(0,\"mat-list-item\"),core.Ub(1,\"h3\",10),core.Cc(2,\"Quantity\"),core.Tb(),core.Ub(3,\"span\"),core.Cc(4),core.Tb(),core.Tb()),2&rf){const ctx_r6=core.gc(2);core.Cb(4),core.Dc(ctx_r6.contract.commission/100)}}function PurchaseContractDetailComponent_ng_template_1_mat_form_field_50_mat_error_4_Template(rf,ctx){if(1&rf&&(core.Ub(0,\"mat-error\"),core.Cc(1),core.Tb()),2&rf){const ctx_r12=core.gc(3);core.Cb(1),core.Dc(ctx_r12.validatorError)}}function PurchaseContractDetailComponent_ng_template_1_mat_form_field_50_Template(rf,ctx){if(1&rf&&(core.Ub(0,\"mat-form-field\",21),core.Ub(1,\"mat-label\"),core.Cc(2,\"Value in ETH. (2X price)\"),core.Tb(),core.Pb(3,\"input\",22),core.Ac(4,PurchaseContractDetailComponent_ng_template_1_mat_form_field_50_mat_error_4_Template,2,1,\"mat-error\",11),core.Ub(5,\"mat-icon\",23),core.Cc(6,\"sentiment_very_satisfied\"),core.Tb(),core.Ub(7,\"mat-hint\"),core.Cc(8,\"Producer Confirm Purchase\"),core.Tb(),core.Tb()),2&rf){const ctx_r8=core.gc(2);core.Cb(3),core.lc(\"formControl\",ctx_r8.buyerConfirmPrice),core.Cb(1),core.lc(\"ngIf\",ctx_r8.buyerConfirmPrice.invalid&&ctx_r8.buyerConfirmPrice.touched)}}function PurchaseContractDetailComponent_ng_template_1_button_51_Template(rf,ctx){if(1&rf){const _r14=core.Vb();core.Ub(0,\"button\",24),core.cc(\"click\",(function(){core.uc(_r14);const ctx_r13=core.gc(2);return ctx_r13.buy.emit(ctx_r13.buyerConfirmPrice.value)})),core.Cc(1,\" Producer Execute Purchase\"),core.Tb()}if(2&rf){const ctx_r9=core.gc(2);core.lc(\"disabled\",!(ctx_r9.buyerConfirmPrice.valid&&ctx_r9.buyerConfirmPrice.dirty))}}function PurchaseContractDetailComponent_ng_template_1_button_52_Template(rf,ctx){if(1&rf){const _r16=core.Vb();core.Ub(0,\"button\",25),core.cc(\"click\",(function(){return core.uc(_r16),core.gc(2).delivery.emit()})),core.Cc(1,\" Supplier Confirm Delivery\"),core.Tb()}}function PurchaseContractDetailComponent_ng_template_1_button_53_Template(rf,ctx){if(1&rf){const _r18=core.Vb();core.Ub(0,\"button\",26),core.cc(\"click\",(function(){return core.uc(_r18),core.gc(2).releaseEscrow.emit()})),core.Cc(1,\" Supplier Receive Escrow \"),core.Ub(2,\"mat-icon\"),core.Cc(3,\"local_bar\"),core.Tb(),core.Tb()}}function PurchaseContractDetailComponent_ng_template_1_Template(rf,ctx){if(1&rf){const _r20=core.Vb();core.Ub(0,\"mat-card-content\"),core.Ub(1,\"section\",3),core.Ub(2,\"h3\",4),core.Cc(3,\"Contract Status:\"),core.Tb(),core.Ub(4,\"mat-chip\",5),core.Cc(5),core.Tb(),core.Ub(6,\"span\",6),core.Ub(7,\"button\",7),core.cc(\"click\",(function(){return core.uc(_r20),core.gc().abortMe.emit()})),core.Ub(8,\"mat-icon\"),core.Cc(9,\"flash_on\"),core.Tb(),core.Tb(),core.Ub(10,\"button\",8),core.cc(\"click\",(function(){core.uc(_r20);const ctx_r21=core.gc();return ctx_r21.remove.emit(ctx_r21.contract.productKey)})),core.Ub(11,\"mat-icon\"),core.Cc(12,\"delete_forever\"),core.Tb(),core.Tb(),core.Tb(),core.Tb(),core.Ub(13,\"section\"),core.Ub(14,\"mat-list\",9),core.Ub(15,\"mat-list-item\"),core.Ub(16,\"h3\",10),core.Cc(17,\"Product Key:\"),core.Tb(),core.Ub(18,\"span\"),core.Cc(19),core.Tb(),core.Tb(),core.Ub(20,\"mat-list-item\"),core.Ub(21,\"h3\",10),core.Cc(22,\"Product Description\"),core.Tb(),core.Ub(23,\"span\"),core.Cc(24),core.Tb(),core.Tb(),core.Ub(25,\"mat-list-item\"),core.Ub(26,\"h3\",10),core.Cc(27,\"Price\"),core.Tb(),core.Ub(28,\"span\"),core.Cc(29),core.Tb(),core.Tb(),core.Ub(30,\"mat-list-item\"),core.Ub(31,\"h3\",10),core.Cc(32,\"Balance\"),core.Tb(),core.Ub(33,\"span\"),core.Cc(34),core.Tb(),core.Tb(),core.Ub(35,\"mat-list-item\"),core.Ub(36,\"h3\",10),core.Cc(37,\"Producer Address\"),core.Tb(),core.Ub(38,\"span\"),core.Cc(39,\"Seller Contract Present in Smart Contract\"),core.Tb(),core.Tb(),core.Ac(40,PurchaseContractDetailComponent_ng_template_1_mat_list_item_40_Template,5,0,\"mat-list-item\",11),core.Ac(41,PurchaseContractDetailComponent_ng_template_1_mat_list_item_41_Template,5,1,\"mat-list-item\",11),core.Tb(),core.Tb(),core.Pb(42,\"mat-divider\"),core.Ub(43,\"section\",12),core.Ub(44,\"h3\",13),core.Cc(45,\"Product Image\"),core.Tb(),core.Pb(46,\"img\",14,15),core.Tb(),core.Pb(48,\"mat-divider\"),core.Ub(49,\"section\",16),core.Ac(50,PurchaseContractDetailComponent_ng_template_1_mat_form_field_50_Template,9,2,\"mat-form-field\",17),core.Ac(51,PurchaseContractDetailComponent_ng_template_1_button_51_Template,2,1,\"button\",18),core.Ac(52,PurchaseContractDetailComponent_ng_template_1_button_52_Template,2,0,\"button\",19),core.Ac(53,PurchaseContractDetailComponent_ng_template_1_button_53_Template,4,0,\"button\",20),core.Tb(),core.Pb(54,\"mat-card-footer\"),core.Tb()}if(2&rf){const ctx_r2=core.gc();core.Cb(4),core.lc(\"selected\",!0)(\"color\",ctx_r2.statusColors[ctx_r2.contract.state].color),core.Cb(1),core.Dc(ctx_r2.enumToString(ctx_r2.statusColors[ctx_r2.contract.state].state)),core.Cb(2),core.lc(\"disabled\",!ctx_r2.canAbort),core.Cb(3),core.lc(\"disabled\",!ctx_r2.removeFromListing),core.Cb(9),core.Dc(ctx_r2.contract.productKey),core.Cb(5),core.Dc(ctx_r2.contract.description),core.Cb(5),core.Ec(\"\",ctx_r2.contract.price,\" ETH\"),core.Cb(5),core.Ec(\"\",ctx_r2.contract.balance,\" ETH\"),core.Cb(6),core.lc(\"ngIf\",ctx_r2.contract.buyerAddress),core.Cb(1),core.lc(\"ngIf\",ctx_r2.showCommission),core.Cb(9),core.lc(\"ngIf\",ctx_r2.canBuy),core.Cb(1),core.lc(\"ngIf\",ctx_r2.canBuy),core.Cb(1),core.lc(\"ngIf\",ctx_r2.canDelivery),core.Cb(1),core.lc(\"ngIf\",ctx_r2.canReleaseEscrow)}}function PurchaseContractDetailComponent_ng_template_3_Template(rf,ctx){1&rf&&core.Cc(0,\" ...Please wait for the contract to load.\\n\")}let purchase_contract_detail_component_PurchaseContractDetailComponent=(()=>{class PurchaseContractDetailComponent{constructor(windowRef){this.windowRef=windowRef,this.remove=new core.o,this.abortMe=new core.o,this.buy=new core.o,this.delivery=new core.o,this.releaseEscrow=new core.o,this.receiveCommission=new core.o,this.statusColors=[{state:ContractState.Created,color:\"accent\"},{state:ContractState.Locked,color:\"primary\"},{state:ContractState.Canceled,color:void 0},{state:ContractState.ItemReceived,color:\"accent\"},{state:ContractState.SellerPaid,color:\"primary\"},{state:ContractState.OwnerPaid,color:\"primary\"},{state:ContractState.Completed,color:\"warn\"}],this.buyerConfirmPrice=new fesm2015_forms.d(\"\",[fesm2015_forms.p.required,,fesm2015_forms.p.pattern(/^\\d+(\\.\\d{1,4})?$/)]),this.enumToString=state=>ContractState[state]}ngOnChanges(changes){this.imageRef&&(this.imageRef.nativeElement.src=this.windowRef.window.URL.createObjectURL(this.image)),this.buyerConfirmPrice.reset()}get validatorError(){return this.buyerConfirmPrice.hasError(\"required\")?\"You must enter a value\":this.buyerConfirmPrice.hasError(\"pattern\")?\"Not a valid format\":\"\"}get removeFromListing(){return this.contract.state===ContractState.Canceled&&this.contract.ownerAddress===this.account}get canAbort(){return this.contract.state===ContractState.Created&&this.contract.sellerAddress===this.account}get canBuy(){return this.contract.state===ContractState.Created&&!this.contract.buyerAddress&&this.contract.sellerAddress!==this.account}get canDelivery(){return this.contract.state===ContractState.Locked&&this.contract.buyerAddress===this.account}get showCommission(){return this.contract.ownerAddress===this.account||this.contract.sellerAddress===this.account}get canReleaseEscrow(){return(this.contract.state===ContractState.ItemReceived||this.contract.state===ContractState.OwnerPaid)&&this.contract.sellerAddress===this.account}get canReceiveCommission(){return(this.contract.state===ContractState.ItemReceived||this.contract.state===ContractState.SellerPaid)&&this.contract.ownerAddress===this.account}}return PurchaseContractDetailComponent.ɵfac=function(t){return new(t||PurchaseContractDetailComponent)(core.Ob(tokens.c))},PurchaseContractDetailComponent.ɵcmp=core.Ib({type:PurchaseContractDetailComponent,selectors:[[\"app-purchase-contract-detail\"]],viewQuery:function(rf,ctx){var _t;1&rf&&core.Gc(purchase_contract_detail_component_c0,!0),2&rf&&core.rc(_t=core.dc())&&(ctx.imageRef=_t.first)},inputs:{contract:\"contract\",image:\"image\",account:\"account\"},outputs:{remove:\"remove\",abortMe:\"abortMe\",buy:\"buy\",delivery:\"delivery\",releaseEscrow:\"releaseEscrow\",receiveCommission:\"receiveCommission\"},features:[core.Ab],decls:5,vars:3,consts:[[4,\"ngIf\",\"ngIfThen\",\"ngIfElse\"],[\"selectedTmpl\",\"\"],[\"noSelectedTmpl\",\"\"],[\"fxLayout\",\"row\",\"fxLayoutAlign\",\"start center\"],[\"fxFlex\",\"38\",\"fxFlexOffset\",\"2\",1,\"mat-h3\"],[\"fxFlex\",\"\",3,\"selected\",\"color\"],[\"fxFlex\",\"20\",\"fxFlexOffset\",\"23\"],[\"mat-icon-button\",\"\",\"color\",\"warn\",\"matTooltip\",\"Abort contract by seller\",\"matTooltipPosition\",\"above\",3,\"disabled\",\"click\"],[\"mat-icon-button\",\"\",\"color\",\"warn\",\"matTooltip\",\"Remove contract by owner\",\"matTooltipPosition\",\"above\",3,\"disabled\",\"click\"],[\"dense\",\"\"],[1,\"mat-h3\"],[4,\"ngIf\"],[\"fxLayout\",\"row\",\"fxLayoutAlign\",\"start center\",2,\"padding\",\"15px 0px\"],[\"fxFlex\",\"36\",\"fxFlexOffset\",\"2\",1,\"mat-h3\"],[\"height\",\"120px\",\"width\",\"120px\",\"alt\",\"img\"],[\"ipfsImage\",\"\"],[\"fxLayout\",\"row wrap\",\"fxLayoutAlign\",\"space-between center\",2,\"margin-top\",\"10px\"],[\"appearance\",\"outline\",4,\"ngIf\"],[\"mat-raised-button\",\"\",\"color\",\"warn\",3,\"disabled\",\"click\",4,\"ngIf\"],[\"mat-raised-button\",\"\",\"color\",\"accent\",3,\"click\",4,\"ngIf\"],[\"mat-raised-button\",\"\",\"color\",\"primary\",\"matTooltip\",\"Seller click to receive escrow\",\"matTooltipPosition\",\"above\",3,\"click\",4,\"ngIf\"],[\"appearance\",\"outline\"],[\"matInput\",\"\",\"required\",\"\",3,\"formControl\"],[\"matSuffix\",\"\"],[\"mat-raised-button\",\"\",\"color\",\"warn\",3,\"disabled\",\"click\"],[\"mat-raised-button\",\"\",\"color\",\"accent\",3,\"click\"],[\"mat-raised-button\",\"\",\"color\",\"primary\",\"matTooltip\",\"Seller click to receive escrow\",\"matTooltipPosition\",\"above\",3,\"click\"]],template:function(rf,ctx){if(1&rf&&(core.Ac(0,PurchaseContractDetailComponent_ng_container_0_Template,1,0,\"ng-container\",0),core.Ac(1,PurchaseContractDetailComponent_ng_template_1_Template,55,15,\"ng-template\",null,1,core.Bc),core.Ac(3,PurchaseContractDetailComponent_ng_template_3_Template,1,0,\"ng-template\",null,2,core.Bc)),2&rf){const _r1=core.sc(2),_r3=core.sc(4);core.lc(\"ngIf\",ctx.contract)(\"ngIfThen\",_r1)(\"ngIfElse\",_r3)}},directives:[common.k,card.c,flex.d,flex.c,flex.a,flex.b,chips.a,fesm2015_button.b,tooltip.a,icon.a,list.a,list.c,divider.a,card.d,form_field.c,form_field.g,input.b,fesm2015_forms.b,fesm2015_forms.o,fesm2015_forms.k,fesm2015_forms.e,form_field.h,form_field.f,form_field.b],styles:[\"mat-list-item[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%] {\\n        width: 240px;\\n      }\"],changeDetection:0}),PurchaseContractDetailComponent})();function ViewPurchaseContractComponent_app_purchase_contract_detail_0_Template(rf,ctx){if(1&rf){const _r3=core.Vb();core.Ub(0,\"app-purchase-contract-detail\",1),core.cc(\"remove\",(function($event){return core.uc(_r3),core.gc().removePurchaseContract($event)}))(\"abortMe\",(function(){return core.uc(_r3),core.gc().abortPurchaseContract()}))(\"buy\",(function($event){return core.uc(_r3),core.gc().confirmBuy($event)}))(\"delivery\",(function(){return core.uc(_r3),core.gc().confirmDelivery()}))(\"releaseEscrow\",(function(){return core.uc(_r3),core.gc().withdrawBySeller()}))(\"receiveCommission\",(function(){return core.uc(_r3),core.gc().withdrawByOwner()})),core.Tb()}if(2&rf){const values_r1=ctx.ngIf;core.lc(\"contract\",values_r1.purchaseContract)(\"image\",values_r1.image)(\"account\",values_r1.account)}}const view_purchase_contract_component_c0=function(a0,a1,a2){return{purchaseContract:a0,image:a1,account:a2}};let view_purchase_contract_component_ViewPurchaseContractComponent=(()=>{class ViewPurchaseContractComponent{constructor(store$){this.store$=store$,this.unsubscribe$=new Subject.a}ngOnInit(){this.selectedPurchaseContract$=this.store$.pipe(Object(store.u)(getSelectedProductWidget),Object(filter.a)(product=>!!product),Object(tap.a)(product=>this.store$.dispatch(purchase_contract_actions_namespaceObject.loadPurchaseContract({address:product.contractAddress}))),Object(switchMap.a)(()=>this.store$.select(getSelectedPurchaseContract)),Object(filter.a)(contract=>!!contract)),this.image$=this.store$.pipe(Object(store.u)(getSelectedPurchaseContract),Object(filter.a)(contract=>!!contract),Object(tap.a)(contract=>this.store$.dispatch(ipfs_product_image_actions_namespaceObject.downloadImage({ipfsHash:contract.ipfsHash}))),Object(switchMap.a)(()=>this.store$.select(reducers_getImageBlob)),Object(filter.a)(image=>!!image)),this.account$=this.store$.pipe(Object(store.u)(reducers.b))}removePurchaseContract(key){this.store$.dispatch(purchase_contract_actions_namespaceObject.removePurchaseContract({key:key}))}abortPurchaseContract(){this.store$.dispatch(purchase_contract_actions_namespaceObject.abortSelectedPurchaseContract())}confirmBuy(eth){this.store$.dispatch(purchase_contract_actions_namespaceObject.confirmBuy({eth:eth}))}confirmDelivery(){this.store$.dispatch(purchase_contract_actions_namespaceObject.confirmDelivery())}withdrawBySeller(){this.store$.dispatch(purchase_contract_actions_namespaceObject.releaseEscrow())}withdrawByOwner(){this.store$.dispatch(purchase_contract_actions_namespaceObject.withdrawByOwner())}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}}return ViewPurchaseContractComponent.ɵfac=function(t){return new(t||ViewPurchaseContractComponent)(core.Ob(store.h))},ViewPurchaseContractComponent.ɵcmp=core.Ib({type:ViewPurchaseContractComponent,selectors:[[\"app-view-purchase-contract\"]],decls:4,vars:11,consts:[[3,\"contract\",\"image\",\"account\",\"remove\",\"abortMe\",\"buy\",\"delivery\",\"releaseEscrow\",\"receiveCommission\",4,\"ngIf\"],[3,\"contract\",\"image\",\"account\",\"remove\",\"abortMe\",\"buy\",\"delivery\",\"releaseEscrow\",\"receiveCommission\"]],template:function(rf,ctx){1&rf&&(core.Ac(0,ViewPurchaseContractComponent_app_purchase_contract_detail_0_Template,1,3,\"app-purchase-contract-detail\",0),core.hc(1,\"async\"),core.hc(2,\"async\"),core.hc(3,\"async\")),2&rf&&core.lc(\"ngIf\",core.qc(7,view_purchase_contract_component_c0,core.ic(1,1,ctx.selectedPurchaseContract$),core.ic(2,3,ctx.image$),core.ic(3,5,ctx.account$)))},directives:[common.k,purchase_contract_detail_component_PurchaseContractDetailComponent],pipes:[common.b],encapsulation:2,changeDetection:0}),ViewPurchaseContractComponent})(),market_place_anchor_module_MarketPlaceAnchorModule=(()=>{class MarketPlaceAnchorModule{}return MarketPlaceAnchorModule.ɵmod=core.Mb({type:MarketPlaceAnchorModule}),MarketPlaceAnchorModule.ɵinj=core.Lb({factory:function(t){return new(t||MarketPlaceAnchorModule)},imports:[[common.c]]}),MarketPlaceAnchorModule})();var from=__webpack_require__(\"Cfvw\"),of=__webpack_require__(\"LRne\"),forkJoin=__webpack_require__(\"cp0P\"),mergeMap=__webpack_require__(\"5+tZ\"),environment=__webpack_require__(\"AytR\");let ethers_web3_token_EthersWeb3Token=(()=>{class EthersWeb3Token extends ethers_min.providers.Web3Provider{constructor(web3Provider){super(web3Provider)}}return EthersWeb3Token.ɵfac=function(t){return new(t||EthersWeb3Token)(core.Yb(tokens.a))},EthersWeb3Token.ɵprov=core.Kb({token:EthersWeb3Token,factory:EthersWeb3Token.ɵfac,providedIn:market_place_anchor_module_MarketPlaceAnchorModule}),EthersWeb3Token})();const Inventory=environment.a.fleaMarketContractAddress,abi=[\"event LogCreatePurchaseContract(address sender, bytes32 key, address contractAddress)\",\"event LogRemovePurchaseContract(address sender, bytes32 key)\",\"function createPurchaseContract(bytes32 key, string description, string ipfsImageHash, uint256 commissionRate) payable returns(bool createResult)\",\"function getContractCount() view returns(uint contractCount)\",\"function getContractKeyAtIndex(uint index) view returns(bytes32 key)\",\"function getContractByKey(bytes32 key) view returns(address contractAddress)\",\"function contractName() view returns(string contractName)\",\"function removeContractByKey(bytes32 key) returns(bool result)\"];let flea_market_contract_token_FleaMarketContractToken=(()=>{class FleaMarketContractToken extends ethers_min.Contract{constructor(provider){super(Inventory,abi,provider.getSigner())}}return FleaMarketContractToken.ɵfac=function(t){return new(t||FleaMarketContractToken)(core.Yb(ethers_web3_token_EthersWeb3Token))},FleaMarketContractToken.ɵprov=core.Kb({token:FleaMarketContractToken,factory:FleaMarketContractToken.ɵfac,providedIn:market_place_anchor_module_MarketPlaceAnchorModule}),FleaMarketContractToken})(),flea_market_contract_service_FleaMarketContractService=(()=>{class FleaMarketContractService{constructor(contractToken){this.contractToken=contractToken,this.widgetObservable=id=>Object(from.a)(this.contractToken.getContractKeyAtIndex(id)).pipe(Object(switchMap.a)(key=>Object(from.a)(this.contractToken.getContractByKey(key)).pipe(Object(map.a)(address=>({productKey:ethers_min.utils.parseBytes32String(key),contractAddress:address})))))}createPurchaseContract(product){const commission=Math.floor(100*parseFloat(product.commission)),bytes32Key=ethers_min.utils.formatBytes32String(product.productKey),wei=ethers_min.utils.parseEther(product.etherValue),token=this.contractToken.createPurchaseContract(bytes32Key,product.description,product.ipfsHash,commission,{value:wei});return Object(from.a)(token).pipe(Object(switchMap.a)(tx=>(console.log(\"Transaction\",tx),Object(from.a)(tx.wait()).pipe(Object(tap.a)(txReceipt=>console.log(\"TransactionReceipt: \",txReceipt)),Object(map.a)(txReceipt=>txReceipt.events.pop()),Object(map.a)(txEvent=>txEvent.args.contractAddress),Object(tap.a)(address=>console.log(\"address: \",address))))))}getPurchaseContractList(){return Object(from.a)(this.contractToken.getContractCount()).pipe(Object(map.a)(bigNumber=>bigNumber.toNumber()),Object(tap.a)(contractCount=>console.log(\"contractCount: \",contractCount)),Object(switchMap.a)(contractCount=>{if(0===contractCount)return Object(of.a)([]);{const countArr=Array.from(Array(contractCount)).map((e,i)=>i);return Object(of.a)(countArr).pipe(Object(mergeMap.a)(ids=>Object(forkJoin.a)(ids.map(this.widgetObservable))))}}))}getName(){return Object(from.a)(this.contractToken.contractName()).pipe(Object(map.a)(name=>name))}removePurchaseContract(productKey){const bytes32Key=ethers_min.utils.formatBytes32String(productKey),token=this.contractToken.removeContractByKey(bytes32Key);return Object(from.a)(token).pipe(Object(switchMap.a)(tx=>(console.log(\"removeContractByKey Transaction\",tx),Object(from.a)(tx.wait()).pipe(Object(tap.a)(txReceipt=>console.log(\"TransactionReceipt: \",txReceipt)),Object(map.a)(txReceipt=>txReceipt.events.pop()),Object(tap.a)(txEvent=>console.log(\"txEvent: \",txEvent)),Object(map.a)(txEvent=>ethers_min.utils.parseBytes32String(txEvent.args.key))))))}}return FleaMarketContractService.ɵfac=function(t){return new(t||FleaMarketContractService)(core.Yb(flea_market_contract_token_FleaMarketContractToken))},FleaMarketContractService.ɵprov=core.Kb({token:FleaMarketContractService,factory:FleaMarketContractService.ɵfac,providedIn:market_place_anchor_module_MarketPlaceAnchorModule}),FleaMarketContractService})(),market_place_home_component_MarketPlaceHomeComponent=(()=>{class MarketPlaceHomeComponent{constructor(fleaSrv){this.fleaSrv=fleaSrv}ngOnInit(){this.name$=this.fleaSrv.getName()}}return MarketPlaceHomeComponent.ɵfac=function(t){return new(t||MarketPlaceHomeComponent)(core.Ob(flea_market_contract_service_FleaMarketContractService))},MarketPlaceHomeComponent.ɵcmp=core.Ib({type:MarketPlaceHomeComponent,selectors:[[\"app-marketplace-home\"]],decls:3,vars:0,consts:[[1,\"mat-headline\",\"text-center\"]],template:function(rf,ctx){1&rf&&(core.Ub(0,\"h1\",0),core.Cc(1,\"Inventory Management System\"),core.Tb(),core.Pb(2,\"router-outlet\"))},directives:[fesm2015_router.j],encapsulation:2,changeDetection:0}),MarketPlaceHomeComponent})(),product_detail_home_component_ProductDetailHomeComponent=(()=>{class ProductDetailHomeComponent{}return ProductDetailHomeComponent.ɵfac=function(t){return new(t||ProductDetailHomeComponent)},ProductDetailHomeComponent.ɵcmp=core.Ib({type:ProductDetailHomeComponent,selectors:[[\"app-product-detail-home\"]],decls:2,vars:0,consts:[[1,\"mat-subheading-2\"]],template:function(rf,ctx){1&rf&&(core.Ub(0,\"h3\",0),core.Cc(1,\" To load a purchase contract details please select the corresponding item from the left panel\"),core.Tb())},encapsulation:2,changeDetection:0}),ProductDetailHomeComponent})();var catchError=__webpack_require__(\"JIr8\");const routes=[{path:\"\",redirectTo:\"products\",pathMatch:\"full\"},{path:\"products\",component:market_place_home_component_MarketPlaceHomeComponent,children:[{path:\"\",component:view_product_collection_component_ViewProductCollectionComponent,canActivate:[(()=>{class ProductsLoadedGuard{constructor(store){this.store=store}canActivate(){return this.waitForProductsToLoad().pipe(Object(switchMap.a)(()=>Object(of.a)(!0)),Object(catchError.a)(()=>Object(of.a)(!1)))}waitForProductsToLoad(){return this.store.pipe(Object(store.u)(isProductsLoaded),Object(tap.a)(loaded=>{loaded||this.store.dispatch(purchase_contract_actions_namespaceObject.loadProducts())}),Object(filter.a)(loaded=>loaded),Object(take.a)(1))}}return ProductsLoadedGuard.ɵfac=function(t){return new(t||ProductsLoadedGuard)(core.Yb(store.h))},ProductsLoadedGuard.ɵprov=core.Kb({token:ProductsLoadedGuard,factory:ProductsLoadedGuard.ɵfac,providedIn:market_place_anchor_module_MarketPlaceAnchorModule}),ProductsLoadedGuard})()],children:[{path:\":id\",component:view_purchase_contract_component_ViewPurchaseContractComponent},{path:\"\",component:product_detail_home_component_ProductDetailHomeComponent}]},{path:\"make/new\",component:new_purchase_contract_component_NewPurchaseContractComponent,pathMatch:\"full\"}]}];let market_place_routing_module_MarketPlaceRoutingModule=(()=>{class MarketPlaceRoutingModule{}return MarketPlaceRoutingModule.ɵmod=core.Mb({type:MarketPlaceRoutingModule}),MarketPlaceRoutingModule.ɵinj=core.Lb({factory:function(t){return new(t||MarketPlaceRoutingModule)},imports:[[fesm2015_router.i.forChild(routes)],fesm2015_router.i]}),MarketPlaceRoutingModule})();var effects=__webpack_require__(\"snw9\"),serialize_error=__webpack_require__(\"jJ/W\"),exhaustMap=__webpack_require__(\"XqQ8\"),actions=__webpack_require__(\"CO7z\"),ipfs_daemon_services=__webpack_require__(\"JQUw\"),http=__webpack_require__(\"tk/3\");let ipfs_product_image_effects_IpfsUploadEffects=(()=>{class IpfsUploadEffects{constructor(ipfsSrv,actions$,httpClient){this.ipfsSrv=ipfsSrv,this.actions$=actions$,this.httpClient=httpClient,this.uploadImage$=Object(effects.d)(()=>this.actions$.pipe(Object(effects.e)(ipfs_product_image_actions_namespaceObject.uploadImage),Object(map.a)(action=>action.file),Object(exhaustMap.a)(file=>this.ipfsSrv.addFile(file).pipe(Object(tap.a)(ipfsHash=>console.log(\"IPFS file hash: \"+ipfsHash)),Object(map.a)(ipfsHash=>ipfs_product_image_actions_namespaceObject.uploadImageSuccess({ipfsHash:ipfsHash})),Object(catchError.a)(err=>Object(of.a)(this.handleError(err),ipfs_product_image_actions_namespaceObject.uploadImageFail())))))),this.downloadImage$=Object(effects.d)(()=>this.actions$.pipe(Object(effects.e)(ipfs_product_image_actions_namespaceObject.downloadImage),Object(map.a)(action=>action.ipfsHash),Object(switchMap.a)(ipfsHash=>this.ipfsSrv.getFile(ipfsHash).pipe(Object(map.a)(image=>ipfs_product_image_actions_namespaceObject.downloadImageSuccess({image:image})),Object(catchError.a)(err=>Object(of.a)(this.handleError(err),ipfs_product_image_actions_namespaceObject.downloadImageError())))))),this.downloadImageError$=Object(effects.d)(()=>this.actions$.pipe(Object(effects.e)(ipfs_product_image_actions_namespaceObject.downloadImageError),Object(switchMap.a)(()=>this.httpClient.get(\"./assets/img/error-human.png\",{responseType:\"blob\"}).pipe(Object(map.a)(image=>ipfs_product_image_actions_namespaceObject.downloadImageSuccess({image:image})),Object(catchError.a)(err=>Object(of.a)(this.handleError(err)))))))}handleError(error){const friendlyErrorMessage=Object(serialize_error.serializeError)(error).message;return actions.a.errorMessage({errorMsg:friendlyErrorMessage})}}return IpfsUploadEffects.ɵfac=function(t){return new(t||IpfsUploadEffects)(core.Yb(ipfs_daemon_services.a),core.Yb(effects.a),core.Yb(http.b))},IpfsUploadEffects.ɵprov=core.Kb({token:IpfsUploadEffects,factory:IpfsUploadEffects.ɵfac}),IpfsUploadEffects})();var concatMap=__webpack_require__(\"bOdf\");function concatMapTo(innerObservable,resultSelector){return Object(concatMap.a)(()=>innerObservable,resultSelector)}var Subscriber=__webpack_require__(\"7o/Q\");function mapTo(value){return source=>source.lift(new MapToOperator(value))}class MapToOperator{constructor(value){this.value=value}call(subscriber,source){return source.subscribe(new mapTo_MapToSubscriber(subscriber,this.value))}}class mapTo_MapToSubscriber extends Subscriber.a{constructor(destination,value){super(destination),this.value=value}_next(x){this.destination.next(this.value)}}var concat=__webpack_require__(\"GyhO\"),models=__webpack_require__(\"sKXY\"),confirm_dialog_component=__webpack_require__(\"Zc21\"),fromArray=__webpack_require__(\"yCtX\"),isArray=__webpack_require__(\"DH7j\"),iterator=__webpack_require__(\"Lhse\"),innerSubscribe=__webpack_require__(\"zx2A\");class ZipOperator{constructor(resultSelector){this.resultSelector=resultSelector}call(subscriber,source){return source.subscribe(new zip_ZipSubscriber(subscriber,this.resultSelector))}}class zip_ZipSubscriber extends Subscriber.a{constructor(destination,resultSelector,values=Object.create(null)){super(destination),this.resultSelector=resultSelector,this.iterators=[],this.active=0,this.resultSelector=\"function\"==typeof resultSelector?resultSelector:void 0}_next(value){const iterators=this.iterators;Object(isArray.a)(value)?iterators.push(new zip_StaticArrayIterator(value)):iterators.push(\"function\"==typeof value[iterator.a]?new StaticIterator(value[iterator.a]()):new zip_ZipBufferIterator(this.destination,this,value))}_complete(){const iterators=this.iterators,len=iterators.length;if(this.unsubscribe(),0!==len){this.active=len;for(let i=0;i<len;i++){let iterator=iterators[i];iterator.stillUnsubscribed?this.destination.add(iterator.subscribe()):this.active--}}else this.destination.complete()}notifyInactive(){this.active--,0===this.active&&this.destination.complete()}checkIterators(){const iterators=this.iterators,len=iterators.length,destination=this.destination;for(let i=0;i<len;i++){let iterator=iterators[i];if(\"function\"==typeof iterator.hasValue&&!iterator.hasValue())return}let shouldComplete=!1;const args=[];for(let i=0;i<len;i++){let iterator=iterators[i],result=iterator.next();if(iterator.hasCompleted()&&(shouldComplete=!0),result.done)return void destination.complete();args.push(result.value)}this.resultSelector?this._tryresultSelector(args):destination.next(args),shouldComplete&&destination.complete()}_tryresultSelector(args){let result;try{result=this.resultSelector.apply(this,args)}catch(err){return void this.destination.error(err)}this.destination.next(result)}}class StaticIterator{constructor(iterator){this.iterator=iterator,this.nextResult=iterator.next()}hasValue(){return!0}next(){const result=this.nextResult;return this.nextResult=this.iterator.next(),result}hasCompleted(){const nextResult=this.nextResult;return Boolean(nextResult&&nextResult.done)}}class zip_StaticArrayIterator{constructor(array){this.array=array,this.index=0,this.length=0,this.length=array.length}[iterator.a](){return this}next(value){const i=this.index++;return i<this.length?{value:this.array[i],done:!1}:{value:null,done:!0}}hasValue(){return this.array.length>this.index}hasCompleted(){return this.array.length===this.index}}class zip_ZipBufferIterator extends innerSubscribe.b{constructor(destination,parent,observable){super(destination),this.parent=parent,this.observable=observable,this.stillUnsubscribed=!0,this.buffer=[],this.isComplete=!1}[iterator.a](){return this}next(){const buffer=this.buffer;return 0===buffer.length&&this.isComplete?{value:null,done:!0}:{value:buffer.shift(),done:!1}}hasValue(){return this.buffer.length>0}hasCompleted(){return 0===this.buffer.length&&this.isComplete}notifyComplete(){this.buffer.length>0?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()}notifyNext(innerValue){this.buffer.push(innerValue),this.parent.checkIterators()}subscribe(){return Object(innerSubscribe.c)(this.observable,new innerSubscribe.a(this))}}let purchase_contract_service_PurchaseContractService=(()=>{class PurchaseContractService{constructor(provider){this.provider=provider,this.abi=[\"function key() view returns(bytes32 key)\",\"function description() view returns(string description)\",\"function seller() view returns(address sellerAddress)\",\"function buyer() view returns(address buyerAddress)\",\"function owner() view returns(address ownerAddress)\",\"function price()  view returns(uint weiPrice)\",\"function balanceOf() view returns(uint weiBalance)\",\"function ipfsImageHash() view returns(string ipfsHash)\",\"function state() view returns(uint8 state)\",\"function commissionRate() view returns (uint commission)\",\"event LogCanceledBySeller(address indexed sender, uint256 amount, bytes32 key)\",\"function abortBySeller() returns (bool result)\",\"event LogPurchaseConfirmed(address indexed sender, uint256 amount, bytes32 key)\",\"function buyerPurchase() payable returns (bool result)\",\"event LogReceivedByBuyer(address indexed sender, uint256 amount, bytes32 key)\",\"function buyerConfirmReceived() returns (bool result)\",\"event LogWithdrawBySeller(address indexed sender, uint256 amount, bytes32 key)\",\"function withdrawBySeller() returns (bool result)\",\"event LogWithdrawByOwner(address indexed sender, uint256 amount, bytes32 key)\",\"function withdrawByOwner() returns (bool result)\"]}loadPurchaseContract(contractAddress){const contract=new ethers_min.ethers.Contract(contractAddress,this.abi,this.provider.getSigner()),crObservable=Object(from.a)(contract.commissionRate()).pipe(Object(map.a)(commission=>commission.toNumber()),Object(catchError.a)(err=>Object(of.a)(null)));return function(...observables){const resultSelector=observables[observables.length-1];return\"function\"==typeof resultSelector&&observables.pop(),Object(fromArray.a)(observables,void 0).lift(new ZipOperator(resultSelector))}(Object(from.a)(contract.key()),Object(from.a)(contract.seller()),Object(from.a)(contract.buyer()),Object(from.a)(contract.owner()),Object(from.a)(contract.price()),Object(from.a)(contract.balanceOf()),Object(from.a)(contract.description()),Object(from.a)(contract.ipfsImageHash()),Object(from.a)(contract.state()),Object(from.a)(crObservable)).pipe(Object(map.a)(([key,sellerAddress,buyerAddress,ownerAddress,weiPrice,weiBalance,description,ipfsHash,state,commission])=>(console.log(`key: ${key}, weiPrice: ${weiPrice}, state: ${state}, commission: ${commission}`),{productKey:ethers_min.utils.parseBytes32String(key),contractAddress:contractAddress,sellerAddress:sellerAddress,buyerAddress:buyerAddress===ethers_min.ethers.constants.AddressZero?null:buyerAddress,ownerAddress:ownerAddress,price:ethers_min.utils.formatEther(weiPrice),balance:ethers_min.utils.formatEther(weiBalance),description:description,ipfsHash:ipfsHash,state:state,commission:commission||null})))}abortPurchaseContract(contractAddress){const token=new ethers_min.ethers.Contract(contractAddress,this.abi,this.provider.getSigner()).abortBySeller();return Object(from.a)(token).pipe(Object(switchMap.a)(tx=>(console.log(\"abortBySeller Tx:\",tx),Object(from.a)(tx.wait()).pipe(Object(tap.a)(txReceipt=>console.log(\"txReceipt: \",txReceipt)),Object(map.a)(txReceipt=>txReceipt.events.pop()),Object(tap.a)(txEvent=>console.log(\"event: \",txEvent.event)),mapTo(contractAddress)))))}confirmPurchase(contractAddress,etherValue){const contract=new ethers_min.ethers.Contract(contractAddress,this.abi,this.provider.getSigner()),wei=ethers_min.utils.parseEther(etherValue),token=contract.buyerPurchase({value:wei});return Object(from.a)(token).pipe(Object(switchMap.a)(tx=>(console.log(\"buyerConfirmPurchase Tx:\",tx),Object(from.a)(tx.wait()).pipe(Object(tap.a)(txReceipt=>console.log(\"txReceipt: \",txReceipt)),Object(map.a)(txReceipt=>txReceipt.events.pop()),Object(tap.a)(txEvent=>console.log(\"event: \",txEvent.event)),mapTo(contractAddress)))))}confirmDelivery(contractAddress){const token=new ethers_min.ethers.Contract(contractAddress,this.abi,this.provider.getSigner()).buyerConfirmReceived();return Object(from.a)(token).pipe(Object(switchMap.a)(tx=>(console.log(\"buyerConfirmReceived Tx:\",tx),Object(from.a)(tx.wait()).pipe(Object(tap.a)(txReceipt=>console.log(\"txReceipt: \",txReceipt)),Object(map.a)(txReceipt=>txReceipt.events.pop()),Object(tap.a)(txEvent=>console.log(\"event: \",txEvent.event)),mapTo(contractAddress)))))}withdrawBySeller(contractAddress){const token=new ethers_min.ethers.Contract(contractAddress,this.abi,this.provider.getSigner()).withdrawBySeller();return Object(from.a)(token).pipe(Object(switchMap.a)(tx=>(console.log(\"withdrawBySeller Tx:\",tx),Object(from.a)(tx.wait()).pipe(Object(tap.a)(txReceipt=>console.log(\"txReceipt: \",txReceipt)),Object(map.a)(txReceipt=>txReceipt.events.pop()),Object(tap.a)(txEvent=>console.log(`event: ${txEvent.event}, sent by: ${txEvent.args.sender}, withdrawal amount: ${txEvent.args.amount}`)),Object(map.a)(txEvent=>ethers_min.ethers.utils.formatEther(txEvent.args.amount))))))}withdrawByOwner(contractAddress){const token=new ethers_min.ethers.Contract(contractAddress,this.abi,this.provider.getSigner()).withdrawByOwner();return Object(from.a)(token).pipe(Object(switchMap.a)(tx=>(console.log(\"withdrawByOwner Tx:\",tx),Object(from.a)(tx.wait()).pipe(Object(tap.a)(txReceipt=>console.log(\"txReceipt: \",txReceipt)),Object(map.a)(txReceipt=>txReceipt.events.pop()),Object(tap.a)(txEvent=>console.log(`event: ${txEvent.event}, sent by: ${txEvent.args.sender}, withdrawal amount: ${txEvent.args.amount}`)),Object(map.a)(txEvent=>ethers_min.ethers.utils.formatEther(txEvent.args.amount))))))}}return PurchaseContractService.ɵfac=function(t){return new(t||PurchaseContractService)(core.Yb(ethers_web3_token_EthersWeb3Token))},PurchaseContractService.ɵprov=core.Kb({token:PurchaseContractService,factory:PurchaseContractService.ɵfac,providedIn:market_place_anchor_module_MarketPlaceAnchorModule}),PurchaseContractService})(),purchase_contract_effects_PurchaseContractEffects=(()=>{class PurchaseContractEffects{constructor(store$,fleaSrv,purchaseSrv,actions$,router,dialog){this.store$=store$,this.fleaSrv=fleaSrv,this.purchaseSrv=purchaseSrv,this.actions$=actions$,this.router=router,this.dialog=dialog,this.createProduct$=Object(effects.d)(()=>this.actions$.pipe(Object(effects.e)(purchase_contract_actions_namespaceObject.createPurchaseContract),Object(map.a)(action=>action.payload),Object(exhaustMap.a)(payload=>this.fleaSrv.createPurchaseContract(payload).pipe(Object(tap.a)(address=>console.log(\"Contract address: \",address)),Object(switchMap.a)(address=>[purchase_contract_actions_namespaceObject.createPurchaseContractSuccess({product:{productKey:payload.productKey,contractAddress:address}}),actions.e.getBalance()]),Object(catchError.a)(err=>Object(of.a)(this.handleError(err),actions.d.hide(),actions.e.getBalance())))))),this.loadPurchaseContract$=Object(effects.d)(()=>this.actions$.pipe(Object(effects.e)(purchase_contract_actions_namespaceObject.loadPurchaseContract),Object(map.a)(action=>action.address),Object(switchMap.a)(address=>this.purchaseSrv.loadPurchaseContract(address).pipe(Object(map.a)(contract=>purchase_contract_actions_namespaceObject.loadPurchaseContractSuccess({contract:contract})),Object(catchError.a)(err=>Object(of.a)(this.handleError(err),actions.d.hide())))))),this.loadProducts$=Object(effects.d)(()=>this.actions$.pipe(Object(effects.e)(purchase_contract_actions_namespaceObject.loadProducts),Object(switchMap.a)(()=>this.fleaSrv.getPurchaseContractList().pipe(Object(tap.a)(products=>console.log(\"purchase contracts:\",products)),Object(map.a)(products=>purchase_contract_actions_namespaceObject.loadProductsSuccess({products:products})),Object(catchError.a)(err=>Object(of.a)(this.handleError(err),actions.d.hide())))))),this.removeProduct$=Object(effects.d)(()=>this.actions$.pipe(Object(effects.e)(purchase_contract_actions_namespaceObject.removePurchaseContract),Object(map.a)(payload=>payload.key),Object(switchMap.a)(key=>{const dialogConfig=new fesm2015_dialog.e;return dialogConfig.width=\"420px\",dialogConfig.disableClose=!0,dialogConfig.autoFocus=!0,dialogConfig.data={title:\"Confirm Remove\",content:`Are you sure to remove contract ${key} from market?`,output:key},this.dialog.open(confirm_dialog_component.a,dialogConfig).afterClosed()}),Object(filter.a)(result=>!!result),Object(exhaustMap.a)(result=>Object(concat.a)(Object(of.a)(actions.d.show()),this.fleaSrv.removePurchaseContract(result).pipe(Object(tap.a)(productKey=>console.log(\"Contract has been removed: \"+productKey)),Object(concatMap.a)(productKey=>[purchase_contract_actions_namespaceObject.removePurchaseContractSuccess({key:productKey}),actions.e.getBalance()]),Object(catchError.a)(err=>Object(of.a)(this.handleError(err),actions.d.hide(),actions.e.getBalance()))),Object(of.a)(actions.d.hide()))))),this.abortContract$=Object(effects.d)(()=>this.actions$.pipe(Object(effects.e)(purchase_contract_actions_namespaceObject.abortSelectedPurchaseContract),Object(withLatestFrom.a)(this.store$.pipe(Object(store.u)(getSelectedPurchaseContract))),Object(switchMap.a)(([action,contract])=>{const dialogConfig=new fesm2015_dialog.e;return dialogConfig.width=\"420px\",dialogConfig.disableClose=!0,dialogConfig.autoFocus=!0,dialogConfig.data={title:\"Confirm Abort\",content:`Are you sure you want to deactivate contract: ${contract.productKey}?`,output:contract.contractAddress},this.dialog.open(confirm_dialog_component.a,dialogConfig).afterClosed()}),Object(filter.a)(result=>!!result),Object(exhaustMap.a)(result=>Object(concat.a)(Object(of.a)(actions.d.show()),this.purchaseSrv.abortPurchaseContract(result).pipe(Object(tap.a)(address=>console.log(`Successfully canceled contract: ${address} `)),concatMapTo([purchase_contract_actions_namespaceObject.abortSelectedPurchaseContractSuccess(),actions.e.getBalance()]),Object(catchError.a)(err=>Object(of.a)(this.handleError(err),actions.d.hide(),actions.e.getBalance()))),Object(of.a)(actions.d.hide()))))),this.confirmBuy$=Object(effects.d)(()=>this.actions$.pipe(Object(effects.e)(purchase_contract_actions_namespaceObject.confirmBuy),Object(withLatestFrom.a)(this.store$.pipe(Object(store.u)(getSelectedPurchaseContract))),Object(switchMap.a)(([payload,contract])=>{const dialogConfig=new fesm2015_dialog.e;return dialogConfig.width=\"420px\",dialogConfig.disableClose=!0,dialogConfig.autoFocus=!0,dialogConfig.data={title:\"Confirm Purchase\",content:`Please confirm to deposit ${payload.eth} ETH into the contract: ${contract.productKey}`,output:{address:contract.contractAddress,eth:payload.eth}},this.dialog.open(confirm_dialog_component.a,dialogConfig).afterClosed()}),Object(filter.a)(result=>!!result),Object(exhaustMap.a)(result=>Object(concat.a)(Object(of.a)(actions.d.show()),this.purchaseSrv.confirmPurchase(result.address,result.eth).pipe(Object(tap.a)(address=>console.log(`Purchase confirmed successfully for the contract: ${address} `)),concatMapTo([purchase_contract_actions_namespaceObject.confirmBuySuccess(),actions.e.getBalance()]),Object(catchError.a)(err=>Object(of.a)(this.handleError(err),actions.e.getBalance()))),Object(of.a)(actions.d.hide()))))),this.confirmDelivery$=Object(effects.d)(()=>this.actions$.pipe(Object(effects.e)(purchase_contract_actions_namespaceObject.confirmDelivery),Object(withLatestFrom.a)(this.store$.pipe(Object(store.u)(getSelectedPurchaseContract))),Object(switchMap.a)(([payload,contract])=>{const dialogConfig=new fesm2015_dialog.e;return dialogConfig.width=\"420px\",dialogConfig.disableClose=!0,dialogConfig.autoFocus=!0,dialogConfig.data={title:\"Confirm Delivery\",content:\"Are you sure you want to confirm that you received the purchase item \"+contract.description,output:contract.contractAddress},this.dialog.open(confirm_dialog_component.a,dialogConfig).afterClosed()}),Object(filter.a)(result=>!!result),Object(exhaustMap.a)(result=>Object(concat.a)(Object(of.a)(actions.d.show()),this.purchaseSrv.confirmDelivery(result).pipe(Object(tap.a)(address=>console.log(`Delivery confirmed successfully for the contract: ${address} `)),concatMapTo([purchase_contract_actions_namespaceObject.confirmDeliverySuccess(),actions.e.getBalance()]),Object(catchError.a)(err=>Object(of.a)(this.handleError(err),actions.e.getBalance()))),Object(of.a)(actions.d.hide()))))),this.withdrawBySeller$=Object(effects.d)(()=>this.actions$.pipe(Object(effects.e)(purchase_contract_actions_namespaceObject.releaseEscrow),Object(withLatestFrom.a)(this.store$.pipe(Object(store.u)(getSelectedPurchaseContract))),Object(map.a)(([payload,contract])=>contract.contractAddress),Object(exhaustMap.a)(address=>this.purchaseSrv.withdrawBySeller(address).pipe(Object(concatMap.a)(eth=>[purchase_contract_actions_namespaceObject.releaseEscrowSuccess({amount:eth}),actions.e.getBalance()]),Object(catchError.a)(err=>Object(of.a)(this.handleError(err),actions.d.hide(),actions.e.getBalance())))))),this.withdrawByOwner$=Object(effects.d)(()=>this.actions$.pipe(Object(effects.e)(purchase_contract_actions_namespaceObject.withdrawByOwner),Object(withLatestFrom.a)(this.store$.pipe(Object(store.u)(getSelectedPurchaseContract))),Object(map.a)(([payload,contract])=>contract.contractAddress),Object(exhaustMap.a)(address=>this.purchaseSrv.withdrawByOwner(address).pipe(Object(concatMap.a)(eth=>[purchase_contract_actions_namespaceObject.withdrawByOwnerSuccess({amount:eth}),actions.e.getBalance()]),Object(catchError.a)(err=>Object(of.a)(this.handleError(err),actions.d.hide(),actions.e.getBalance())))))),this.removeProductRedirect$=Object(effects.d)(()=>this.actions$.pipe(Object(effects.e)(purchase_contract_actions_namespaceObject.removePurchaseContractSuccess),Object(tap.a)(_=>{this.router.navigate([\"/market-place\"])})),{dispatch:!1}),this.reload$=Object(effects.d)(()=>this.actions$.pipe(Object(effects.e)(purchase_contract_actions_namespaceObject.abortSelectedPurchaseContractSuccess,purchase_contract_actions_namespaceObject.confirmBuySuccess,purchase_contract_actions_namespaceObject.confirmDeliverySuccess,purchase_contract_actions_namespaceObject.releaseEscrowSuccess,purchase_contract_actions_namespaceObject.withdrawByOwnerSuccess),Object(withLatestFrom.a)(this.store$.pipe(Object(store.u)(getSelectedPurchaseContract))),Object(tap.a)(([action,contract])=>Object(tslib_es6.b)(this,void 0,void 0,(function*(){this.router.routeReuseStrategy.shouldReuseRoute=()=>!1,this.router.navigate([\"/market-place/products\",contract.productKey])})))),{dispatch:!1}),this.showSpinner$=Object(effects.d)(()=>this.actions$.pipe(Object(effects.e)(purchase_contract_actions_namespaceObject.createPurchaseContract,purchase_contract_actions_namespaceObject.loadProducts,purchase_contract_actions_namespaceObject.loadPurchaseContract,purchase_contract_actions_namespaceObject.releaseEscrow,purchase_contract_actions_namespaceObject.withdrawByOwner),mapTo(actions.d.show()))),this.hideSpinner$=Object(effects.d)(()=>this.actions$.pipe(Object(effects.e)(purchase_contract_actions_namespaceObject.createPurchaseContractSuccess,purchase_contract_actions_namespaceObject.loadProductsSuccess,purchase_contract_actions_namespaceObject.loadPurchaseContractSuccess,purchase_contract_actions_namespaceObject.releaseEscrowSuccess,purchase_contract_actions_namespaceObject.withdrawByOwnerSuccess),mapTo(actions.d.hide()))),this.showSnackbarOnCreateContract$=Object(effects.d)(()=>this.actions$.pipe(Object(effects.e)(purchase_contract_actions_namespaceObject.createPurchaseContractSuccess),Object(map.a)(payload=>actions.c.open({payload:{message:\"New smart product contract has been created successfully: Address: \"+payload.product.contractAddress,color:models.a.Success}})))),this.showSnackbarOnReleaseEscrow$=Object(effects.d)(()=>this.actions$.pipe(Object(effects.e)(purchase_contract_actions_namespaceObject.releaseEscrowSuccess),Object(map.a)(payload=>actions.c.open({payload:{message:`Fund in amount: ${payload.amount} ETH has been successfully release back to Seller`,color:models.a.Success}})))),this.showSnackbarOnReceiveCommission$=Object(effects.d)(()=>this.actions$.pipe(Object(effects.e)(purchase_contract_actions_namespaceObject.withdrawByOwnerSuccess),Object(map.a)(payload=>actions.c.open({payload:{message:`Commission in amount: ${payload.amount} ETH has been successfully transferred to Owner`,color:models.a.Success}})))),this.showSnackbarOnSuccess$=Object(effects.d)(()=>this.actions$.pipe(Object(effects.e)(purchase_contract_actions_namespaceObject.abortSelectedPurchaseContractSuccess,purchase_contract_actions_namespaceObject.confirmBuySuccess,purchase_contract_actions_namespaceObject.confirmDeliverySuccess),Object(withLatestFrom.a)(this.store$.pipe(Object(store.u)(getSelectedPurchaseContract))),Object(map.a)(([action,contract])=>{let msg=\"\";return\"[PurchaseContract/Command] Abort Purchase Contract Success\"===action.type?msg=`The request made by the seller to abort the contract '${contract.description}' has been confirmed!`:\"[PurchaseContract/Command] Confirm Buy Success\"===action.type?msg=`Deposit fund made by the buyer for item '${contract.description}' has been confirmed!`:\"[PurchaseContract/Command] Confirm Product Delivery Success\"===action.type&&(msg=`Receiving item '${contract.description}' by the buyer has been confirmed!`),actions.c.open({payload:{message:msg,color:models.a.Success}})})))}handleError(error){const friendlyErrorMessage=Object(serialize_error.serializeError)(error).message;return actions.a.errorMessage({errorMsg:friendlyErrorMessage})}}return PurchaseContractEffects.ɵfac=function(t){return new(t||PurchaseContractEffects)(core.Yb(store.h),core.Yb(flea_market_contract_service_FleaMarketContractService),core.Yb(purchase_contract_service_PurchaseContractService),core.Yb(effects.a),core.Yb(fesm2015_router.e),core.Yb(fesm2015_dialog.b))},PurchaseContractEffects.ɵprov=core.Kb({token:PurchaseContractEffects,factory:PurchaseContractEffects.ɵfac}),PurchaseContractEffects})();const CONTAINERS=[new_purchase_contract_component_NewPurchaseContractComponent,view_product_collection_component_ViewProductCollectionComponent,view_purchase_contract_component_ViewPurchaseContractComponent],COMPONENTS=[market_place_home_component_MarketPlaceHomeComponent,show_ipfs_image_component_ShowIpfsImageComponent,purchase_contract_list_component_PurchaseContractListComponent,product_detail_home_component_ProductDetailHomeComponent,purchase_contract_detail_component_PurchaseContractDetailComponent];let market_place_module_MarketPlaceModule=(()=>{class MarketPlaceModule{}return MarketPlaceModule.ɵmod=core.Mb({type:MarketPlaceModule}),MarketPlaceModule.ɵinj=core.Lb({factory:function(t){return new(t||MarketPlaceModule)},imports:[[common.c,shared.c,shared.b,fesm2015_forms.n,market_place_anchor_module_MarketPlaceAnchorModule,market_place_routing_module_MarketPlaceRoutingModule,store.j.forFeature(\"purchaseContract\",reducers_reducers),effects.b.forFeature([ipfs_product_image_effects_IpfsUploadEffects,purchase_contract_effects_PurchaseContractEffects])]]}),MarketPlaceModule})()}}]);","extractedComments":[]}